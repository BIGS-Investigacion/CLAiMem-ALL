===================================
Processing PAM50 (5 subtypes)
===================================
Filtering correct predictions for label basal (0)...
Loaded CSV with 1522 entries
Task type: PAM50
Directory prediction label: 0 (basal)
Created label mapping for 1522 slide IDs
Found 1720 images in data/histomorfologico/tcga/pam50/label_basal_pred_0

============================================================
RESULTS:
============================================================
Correct predictions: 1720
Incorrect predictions: 0
Not found in CSV: 0
Total processed: 1720
Accuracy: 100.00%

Saved list of 1720 correct predictions to correct_predictions_pam50_label_0.txt

Filtering correct predictions for label her2 (1)...
Loaded CSV with 1522 entries
Task type: PAM50
Directory prediction label: 1 (her2)
Created label mapping for 1522 slide IDs
Found 392 images in data/histomorfologico/tcga/pam50/label_her2_pred_1

============================================================
RESULTS:
============================================================
Correct predictions: 392
Incorrect predictions: 0
Not found in CSV: 0
Total processed: 392
Accuracy: 100.00%

Saved list of 392 correct predictions to correct_predictions_pam50_label_1.txt

Filtering correct predictions for label luma (2)...
Loaded CSV with 1522 entries
Task type: PAM50
Directory prediction label: 2 (luma)
Created label mapping for 1522 slide IDs
Found 5688 images in data/histomorfologico/tcga/pam50/label_luma_pred_2

============================================================
RESULTS:
============================================================
Correct predictions: 5688
Incorrect predictions: 0
Not found in CSV: 0
Total processed: 5688
Accuracy: 100.00%

Saved list of 5688 correct predictions to correct_predictions_pam50_label_2.txt

Filtering correct predictions for label lumb (3)...
Loaded CSV with 1522 entries
Task type: PAM50
Directory prediction label: 3 (lumb)
Created label mapping for 1522 slide IDs
Found 1864 images in data/histomorfologico/tcga/pam50/label_lumb_pred_3

============================================================
RESULTS:
============================================================
Correct predictions: 1864
Incorrect predictions: 0
Not found in CSV: 0
Total processed: 1864
Accuracy: 100.00%

Saved list of 1864 correct predictions to correct_predictions_pam50_label_3.txt

Filtering correct predictions for label normal (4)...
Loaded CSV with 1522 entries
Task type: PAM50
Directory prediction label: 4 (normal)
Created label mapping for 1522 slide IDs
Found 192 images in data/histomorfologico/tcga/pam50/label_normal_pred_4

============================================================
RESULTS:
============================================================
Correct predictions: 192
Incorrect predictions: 0
Not found in CSV: 0
Total processed: 192
Accuracy: 100.00%

Saved list of 192 correct predictions to correct_predictions_pam50_label_4.txt

================================

Selecting representatives for label 0 (basal)...
Loaded 1720 images from correct_predictions_pam50_label_0.txt
Loading Virchow v2 model...
Computing embeddings for 1720 images...
  0%|          | 0/215 [00:00<?, ?it/s]  0%|          | 1/215 [00:00<03:15,  1.09it/s]  1%|          | 2/215 [00:01<02:01,  1.75it/s]  1%|▏         | 3/215 [00:01<01:36,  2.21it/s]  2%|▏         | 4/215 [00:01<01:32,  2.27it/s]  2%|▏         | 5/215 [00:02<01:30,  2.31it/s]  3%|▎         | 6/215 [00:02<01:29,  2.34it/s]  3%|▎         | 7/215 [00:03<01:34,  2.19it/s]  4%|▎         | 8/215 [00:03<01:42,  2.01it/s]  4%|▍         | 9/215 [00:04<01:46,  1.93it/s]  5%|▍         | 10/215 [00:05<01:48,  1.88it/s]  5%|▌         | 11/215 [00:05<01:50,  1.85it/s]  6%|▌         | 12/215 [00:06<01:52,  1.80it/s]  6%|▌         | 13/215 [00:06<01:57,  1.72it/s]  7%|▋         | 14/215 [00:07<02:00,  1.67it/s]  7%|▋         | 15/215 [00:08<02:01,  1.65it/s]  7%|▋         | 16/215 [00:08<02:01,  1.63it/s]  8%|▊         | 17/215 [00:09<02:03,  1.61it/s]  8%|▊         | 18/215 [00:10<02:03,  1.60it/s]  9%|▉         | 19/215 [00:10<02:03,  1.58it/s]  9%|▉         | 20/215 [00:11<02:01,  1.60it/s] 10%|▉         | 21/215 [00:11<02:01,  1.59it/s] 10%|█         | 22/215 [00:12<01:58,  1.62it/s] 11%|█         | 23/215 [00:13<01:58,  1.62it/s] 11%|█         | 24/215 [00:13<01:58,  1.61it/s] 12%|█▏        | 25/215 [00:14<01:55,  1.64it/s] 12%|█▏        | 26/215 [00:14<01:57,  1.61it/s] 13%|█▎        | 27/215 [00:15<01:57,  1.60it/s] 13%|█▎        | 28/215 [00:16<01:58,  1.58it/s] 13%|█▎        | 29/215 [00:16<01:59,  1.56it/s] 14%|█▍        | 30/215 [00:17<01:58,  1.56it/s] 14%|█▍        | 31/215 [00:18<01:58,  1.55it/s] 15%|█▍        | 32/215 [00:18<01:57,  1.55it/s] 15%|█▌        | 33/215 [00:19<01:57,  1.55it/s] 16%|█▌        | 34/215 [00:20<01:57,  1.54it/s] 16%|█▋        | 35/215 [00:20<01:55,  1.55it/s] 17%|█▋        | 36/215 [00:21<01:55,  1.55it/s] 17%|█▋        | 37/215 [00:22<01:55,  1.54it/s] 18%|█▊        | 38/215 [00:22<01:54,  1.54it/s] 18%|█▊        | 39/215 [00:23<01:53,  1.54it/s] 19%|█▊        | 40/215 [00:24<01:53,  1.54it/s] 19%|█▉        | 41/215 [00:24<01:52,  1.54it/s] 20%|█▉        | 42/215 [00:25<01:52,  1.54it/s] 20%|██        | 43/215 [00:25<01:52,  1.53it/s] 20%|██        | 44/215 [00:26<01:52,  1.52it/s] 21%|██        | 45/215 [00:27<01:51,  1.52it/s] 21%|██▏       | 46/215 [00:27<01:50,  1.53it/s] 22%|██▏       | 47/215 [00:28<01:49,  1.53it/s] 22%|██▏       | 48/215 [00:29<01:49,  1.53it/s] 23%|██▎       | 49/215 [00:29<01:48,  1.53it/s] 23%|██▎       | 50/215 [00:30<01:48,  1.52it/s] 24%|██▎       | 51/215 [00:31<01:47,  1.53it/s] 24%|██▍       | 52/215 [00:31<01:46,  1.53it/s] 25%|██▍       | 53/215 [00:32<01:45,  1.53it/s] 25%|██▌       | 54/215 [00:33<01:44,  1.53it/s] 26%|██▌       | 55/215 [00:33<01:44,  1.53it/s] 26%|██▌       | 56/215 [00:34<01:44,  1.53it/s] 27%|██▋       | 57/215 [00:35<01:44,  1.52it/s] 27%|██▋       | 58/215 [00:35<01:43,  1.52it/s] 27%|██▋       | 59/215 [00:36<01:42,  1.52it/s] 28%|██▊       | 60/215 [00:37<01:41,  1.53it/s] 28%|██▊       | 61/215 [00:37<01:40,  1.53it/s] 29%|██▉       | 62/215 [00:38<01:40,  1.53it/s] 29%|██▉       | 63/215 [00:39<01:40,  1.52it/s] 30%|██▉       | 64/215 [00:39<01:40,  1.51it/s] 30%|███       | 65/215 [00:40<01:40,  1.50it/s] 31%|███       | 66/215 [00:41<01:40,  1.49it/s] 31%|███       | 67/215 [00:41<01:39,  1.49it/s] 32%|███▏      | 68/215 [00:42<01:37,  1.50it/s] 32%|███▏      | 69/215 [00:43<01:36,  1.51it/s] 33%|███▎      | 70/215 [00:43<01:35,  1.51it/s] 33%|███▎      | 71/215 [00:44<01:35,  1.51it/s] 33%|███▎      | 72/215 [00:45<01:35,  1.50it/s] 34%|███▍      | 73/215 [00:45<01:34,  1.50it/s] 34%|███▍      | 74/215 [00:46<01:34,  1.50it/s] 35%|███▍      | 75/215 [00:47<01:33,  1.49it/s] 35%|███▌      | 76/215 [00:47<01:35,  1.46it/s] 36%|███▌      | 77/215 [00:48<01:37,  1.42it/s] 36%|███▋      | 78/215 [00:49<01:36,  1.43it/s] 37%|███▋      | 79/215 [00:49<01:34,  1.44it/s] 37%|███▋      | 80/215 [00:50<01:33,  1.45it/s] 38%|███▊      | 81/215 [00:51<01:31,  1.46it/s] 38%|███▊      | 82/215 [00:51<01:29,  1.49it/s] 39%|███▊      | 83/215 [00:52<01:28,  1.50it/s] 39%|███▉      | 84/215 [00:53<01:26,  1.51it/s] 40%|███▉      | 85/215 [00:53<01:25,  1.52it/s] 40%|████      | 86/215 [00:54<01:24,  1.53it/s] 40%|████      | 87/215 [00:55<01:23,  1.54it/s] 41%|████      | 88/215 [00:55<01:22,  1.54it/s] 41%|████▏     | 89/215 [00:56<01:21,  1.54it/s] 42%|████▏     | 90/215 [00:57<01:21,  1.54it/s] 42%|████▏     | 91/215 [00:57<01:20,  1.54it/s] 43%|████▎     | 92/215 [00:58<01:19,  1.54it/s] 43%|████▎     | 93/215 [00:59<01:18,  1.55it/s] 44%|████▎     | 94/215 [00:59<01:18,  1.55it/s] 44%|████▍     | 95/215 [01:00<01:17,  1.54it/s] 45%|████▍     | 96/215 [01:01<01:17,  1.54it/s] 45%|████▌     | 97/215 [01:01<01:16,  1.54it/s] 46%|████▌     | 98/215 [01:02<01:15,  1.54it/s] 46%|████▌     | 99/215 [01:02<01:15,  1.53it/s] 47%|████▋     | 100/215 [01:03<01:14,  1.54it/s] 47%|████▋     | 101/215 [01:04<01:13,  1.54it/s] 47%|████▋     | 102/215 [01:04<01:13,  1.55it/s] 48%|████▊     | 103/215 [01:05<01:12,  1.55it/s] 48%|████▊     | 104/215 [01:06<01:11,  1.55it/s] 49%|████▉     | 105/215 [01:06<01:11,  1.54it/s] 49%|████▉     | 106/215 [01:07<01:10,  1.54it/s] 50%|████▉     | 107/215 [01:08<01:10,  1.54it/s] 50%|█████     | 108/215 [01:08<01:09,  1.54it/s] 51%|█████     | 109/215 [01:09<01:08,  1.54it/s] 51%|█████     | 110/215 [01:10<01:08,  1.53it/s] 52%|█████▏    | 111/215 [01:10<01:07,  1.53it/s] 52%|█████▏    | 112/215 [01:11<01:07,  1.53it/s] 53%|█████▎    | 113/215 [01:12<01:06,  1.53it/s] 53%|█████▎    | 114/215 [01:12<01:06,  1.53it/s] 53%|█████▎    | 115/215 [01:13<01:05,  1.53it/s] 54%|█████▍    | 116/215 [01:14<01:04,  1.54it/s] 54%|█████▍    | 117/215 [01:14<01:03,  1.54it/s] 55%|█████▍    | 118/215 [01:15<01:03,  1.54it/s] 55%|█████▌    | 119/215 [01:15<01:02,  1.54it/s] 56%|█████▌    | 120/215 [01:16<01:01,  1.54it/s] 56%|█████▋    | 121/215 [01:17<01:00,  1.54it/s] 57%|█████▋    | 122/215 [01:17<01:00,  1.54it/s] 57%|█████▋    | 123/215 [01:18<00:59,  1.55it/s] 58%|█████▊    | 124/215 [01:19<00:58,  1.55it/s] 58%|█████▊    | 125/215 [01:19<00:58,  1.54it/s] 59%|█████▊    | 126/215 [01:20<00:57,  1.54it/s] 59%|█████▉    | 127/215 [01:21<00:57,  1.54it/s] 60%|█████▉    | 128/215 [01:21<00:56,  1.53it/s] 60%|██████    | 129/215 [01:22<00:56,  1.53it/s] 60%|██████    | 130/215 [01:23<00:55,  1.53it/s] 61%|██████    | 131/215 [01:23<00:54,  1.53it/s] 61%|██████▏   | 132/215 [01:24<00:54,  1.53it/s] 62%|██████▏   | 133/215 [01:25<00:53,  1.53it/s] 62%|██████▏   | 134/215 [01:25<00:52,  1.53it/s] 63%|██████▎   | 135/215 [01:26<00:51,  1.54it/s] 63%|██████▎   | 136/215 [01:27<00:51,  1.54it/s] 64%|██████▎   | 137/215 [01:27<00:50,  1.54it/s] 64%|██████▍   | 138/215 [01:28<00:50,  1.54it/s] 65%|██████▍   | 139/215 [01:28<00:49,  1.54it/s] 65%|██████▌   | 140/215 [01:29<00:48,  1.54it/s] 66%|██████▌   | 141/215 [01:30<00:47,  1.54it/s] 66%|██████▌   | 142/215 [01:30<00:47,  1.55it/s] 67%|██████▋   | 143/215 [01:31<00:46,  1.54it/s] 67%|██████▋   | 144/215 [01:32<00:46,  1.54it/s] 67%|██████▋   | 145/215 [01:32<00:45,  1.54it/s] 68%|██████▊   | 146/215 [01:33<00:44,  1.54it/s] 68%|██████▊   | 147/215 [01:34<00:44,  1.54it/s] 69%|██████▉   | 148/215 [01:34<00:43,  1.55it/s] 69%|██████▉   | 149/215 [01:35<00:42,  1.55it/s] 70%|██████▉   | 150/215 [01:36<00:41,  1.55it/s] 70%|███████   | 151/215 [01:36<00:41,  1.55it/s] 71%|███████   | 152/215 [01:37<00:40,  1.55it/s] 71%|███████   | 153/215 [01:38<00:40,  1.54it/s] 72%|███████▏  | 154/215 [01:38<00:39,  1.55it/s] 72%|███████▏  | 155/215 [01:39<00:38,  1.55it/s] 73%|███████▎  | 156/215 [01:39<00:37,  1.55it/s] 73%|███████▎  | 157/215 [01:40<00:37,  1.55it/s] 73%|███████▎  | 158/215 [01:41<00:36,  1.55it/s] 74%|███████▍  | 159/215 [01:41<00:36,  1.55it/s] 74%|███████▍  | 160/215 [01:42<00:35,  1.54it/s] 75%|███████▍  | 161/215 [01:43<00:35,  1.54it/s] 75%|███████▌  | 162/215 [01:43<00:34,  1.54it/s] 76%|███████▌  | 163/215 [01:44<00:33,  1.54it/s] 76%|███████▋  | 164/215 [01:45<00:33,  1.53it/s] 77%|███████▋  | 165/215 [01:45<00:32,  1.53it/s] 77%|███████▋  | 166/215 [01:46<00:31,  1.54it/s] 78%|███████▊  | 167/215 [01:47<00:31,  1.55it/s] 78%|███████▊  | 168/215 [01:47<00:30,  1.55it/s] 79%|███████▊  | 169/215 [01:48<00:29,  1.55it/s] 79%|███████▉  | 170/215 [01:49<00:29,  1.54it/s] 80%|███████▉  | 171/215 [01:49<00:28,  1.54it/s] 80%|████████  | 172/215 [01:50<00:27,  1.55it/s] 80%|████████  | 173/215 [01:50<00:27,  1.55it/s] 81%|████████  | 174/215 [01:51<00:26,  1.55it/s] 81%|████████▏ | 175/215 [01:52<00:25,  1.55it/s] 82%|████████▏ | 176/215 [01:52<00:25,  1.56it/s] 82%|████████▏ | 177/215 [01:53<00:24,  1.55it/s] 83%|████████▎ | 178/215 [01:54<00:24,  1.54it/s] 83%|████████▎ | 179/215 [01:54<00:23,  1.54it/s] 84%|████████▎ | 180/215 [01:55<00:22,  1.54it/s] 84%|████████▍ | 181/215 [01:56<00:22,  1.54it/s] 85%|████████▍ | 182/215 [01:56<00:21,  1.54it/s] 85%|████████▌ | 183/215 [01:57<00:20,  1.54it/s] 86%|████████▌ | 184/215 [01:58<00:20,  1.53it/s] 86%|████████▌ | 185/215 [01:58<00:19,  1.53it/s] 87%|████████▋ | 186/215 [01:59<00:18,  1.53it/s] 87%|████████▋ | 187/215 [02:00<00:18,  1.53it/s] 87%|████████▋ | 188/215 [02:00<00:17,  1.53it/s] 88%|████████▊ | 189/215 [02:01<00:16,  1.54it/s] 88%|████████▊ | 190/215 [02:02<00:16,  1.54it/s] 89%|████████▉ | 191/215 [02:02<00:15,  1.55it/s] 89%|████████▉ | 192/215 [02:03<00:14,  1.55it/s] 90%|████████▉ | 193/215 [02:03<00:14,  1.55it/s] 90%|█████████ | 194/215 [02:04<00:13,  1.54it/s] 91%|█████████ | 195/215 [02:05<00:12,  1.54it/s] 91%|█████████ | 196/215 [02:05<00:12,  1.54it/s] 92%|█████████▏| 197/215 [02:06<00:11,  1.55it/s] 92%|█████████▏| 198/215 [02:07<00:10,  1.56it/s] 93%|█████████▎| 199/215 [02:07<00:10,  1.56it/s] 93%|█████████▎| 200/215 [02:08<00:09,  1.56it/s] 93%|█████████▎| 201/215 [02:09<00:09,  1.55it/s] 94%|█████████▍| 202/215 [02:09<00:08,  1.56it/s] 94%|█████████▍| 203/215 [02:10<00:07,  1.55it/s] 95%|█████████▍| 204/215 [02:11<00:07,  1.55it/s] 95%|█████████▌| 205/215 [02:11<00:06,  1.55it/s] 96%|█████████▌| 206/215 [02:12<00:05,  1.56it/s] 96%|█████████▋| 207/215 [02:12<00:05,  1.56it/s] 97%|█████████▋| 208/215 [02:13<00:04,  1.56it/s] 97%|█████████▋| 209/215 [02:14<00:03,  1.56it/s] 98%|█████████▊| 210/215 [02:14<00:03,  1.55it/s] 98%|█████████▊| 211/215 [02:15<00:02,  1.55it/s] 99%|█████████▊| 212/215 [02:16<00:01,  1.55it/s] 99%|█████████▉| 213/215 [02:16<00:01,  1.55it/s]100%|█████████▉| 214/215 [02:17<00:00,  1.54it/s]100%|██████████| 215/215 [02:18<00:00,  1.54it/s]100%|██████████| 215/215 [02:18<00:00,  1.56it/s]
Computed embeddings shape: torch.Size([1720, 2560])

============================================================
Selected 25 representative images:
============================================================
 1. 1_TCGA-AO-A124-01A-01-BSA.0770840e-d781-45f2-bbc8-034f0e4138a5_x_22320_y_12064_a_99.970.png (distance: 16.8906)
 2. 3_TCGA-B6-A0RE-01A-01-BS1.b3d8a60d-a66a-4cf3-8616-edc125bf48f1_x_69751_y_13186_a_99.875.png (distance: 17.1875)
 3. 1_TCGA-BH-A18T-01A-01-TSA.089d9985-6794-4237-a7c7-75c1fb3c1755_x_10384_y_24864_a_99.968.png (distance: 17.2188)
 4. 4_TCGA-B6-A0RE-01A-01-BS1.b3d8a60d-a66a-4cf3-8616-edc125bf48f1_x_68727_y_15234_a_99.834.png (distance: 17.3750)
 5. 1_TCGA-A2-A04P-01A-03-BSC.31dbf72c-2aef-4b1d-a773-3656f550acc3_x_59168_y_7264_a_99.718.png (distance: 17.3750)
 6. 2_TCGA-BH-A0E6-01A-01-TSA.54e2d7c5-0b53-4221-a8fe-af32465030ec_x_70183_y_19504_a_99.943.png (distance: 17.5625)
 7. 6_TCGA-EW-A1PH-01A-01-TS1.2f389a6d-0faa-49c5-bb7d-ff0eaf2adb69_x_31424_y_4432_a_99.241.png (distance: 17.5938)
 8. 2_TCGA-C8-A134-01A-01-TSA.76591f60-9e71-495f-beca-e4b91ef3dd68_x_66291_y_5826_a_99.834.png (distance: 17.7500)
 9. 2_TCGA-A2-A0ST-01A-01-TSA.8e2979c6-24f8-4dcf-8439-1da07dbc6a9b_x_75776_y_15008_a_99.939.png (distance: 17.8438)
10. 3_TCGA-C8-A27B-01A-01-TSA.b93af347-1b83-4284-afaf-b3c14d8e038b_x_56293_y_28992_a_99.912.png (distance: 17.8906)
11. 3_TCGA-A2-A0D0-01A-01-BSA.de3699b8-cd5b-4bac-af17-b63d447c55e7_x_75554_y_36560_a_99.860.png (distance: 18.0469)
12. 5_TCGA-A2-A0YM-01A-01-TSA.af2a6b3d-dbf4-4323-aebe-d8b95053fff3_x_13728_y_9424_a_99.783.png (distance: 18.1562)
13. 6_TCGA-B6-A0RE-01A-01-BS1.b3d8a60d-a66a-4cf3-8616-edc125bf48f1_x_68727_y_13698_a_99.750.png (distance: 18.1719)
14. 0_TCGA-B6-A0IJ-01A-01-TSA.3e389914-3756-45ef-b49a-f818883551f1_x_65605_y_13632_a_100.000.png (distance: 18.2344)
15. 0_TCGA-E2-A573-01A-01-TS1.E5F5ABA4-595A-41C0-B686-A96DA9901AED_x_22672_y_17938_a_100.000.png (distance: 18.2500)
16. 6_TCGA-AO-A0JL-01A-01-TSA.b6151e7a-75be-425c-b9b0-d93111659ce9_x_21744_y_10432_a_99.678.png (distance: 18.2969)
17. 3_TCGA-BH-A0E6-01A-01-TSA.54e2d7c5-0b53-4221-a8fe-af32465030ec_x_83495_y_28720_a_99.914.png (distance: 18.3125)
18. 1_TCGA-EW-A1PH-01A-01-TS1.2f389a6d-0faa-49c5-bb7d-ff0eaf2adb69_x_32448_y_4944_a_99.874.png (distance: 18.3281)
19. 4_TCGA-E2-A1AZ-01A-01-TS1.4941221b-33e9-4b2a-8165-cc2221732f78_x_9136_y_20512_a_99.750.png (distance: 18.3594)
20. 2_TCGA-B6-A0RE-01A-01-BS1.b3d8a60d-a66a-4cf3-8616-edc125bf48f1_x_68727_y_14722_a_99.917.png (distance: 18.3750)
21. 0_TCGA-AO-A129-01A-02-TSB.427ec681-3c44-4d87-bfe5-525df3ade7f2_x_68117_y_11793_a_100.000.png (distance: 18.4219)
22. 7_TCGA-BH-A0RX-01A-02-MSB.dd4d6596-9320-4e5d-982b-10909a2e4dd2_x_22704_y_32288_a_99.804.png (distance: 18.4531)
23. 5_TCGA-AO-A124-01A-01-BSA.0770840e-d781-45f2-bbc8-034f0e4138a5_x_72067_y_21328_a_99.852.png (distance: 18.4844)
24. 4_TCGA-A2-A0D0-01A-01-TSA.231084a7-765a-481e-9e40-2c9b131b38ea_x_14496_y_5264_a_99.815.png (distance: 18.5000)
25. 0_TCGA-E2-A159-01A-01-TSA.257b9eec-d799-4545-bae4-b279258bba63_x_53936_y_7904_a_100.000.png (distance: 18.5156)

Saved selected images to selected_images_pam50_label_0.txt
Saved detailed results to selected_images_pam50_label_0_with_distances.json

================================

Selecting representatives for label 1 (her2)...
Loaded 392 images from correct_predictions_pam50_label_1.txt
Loading Virchow v2 model...
Computing embeddings for 392 images...
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:01<00:59,  1.23s/it]  4%|▍         | 2/49 [00:01<00:41,  1.13it/s]  6%|▌         | 3/49 [00:02<00:36,  1.27it/s]  8%|▊         | 4/49 [00:03<00:32,  1.38it/s] 10%|█         | 5/49 [00:03<00:30,  1.44it/s] 12%|█▏        | 6/49 [00:04<00:29,  1.47it/s] 14%|█▍        | 7/49 [00:05<00:28,  1.49it/s] 16%|█▋        | 8/49 [00:05<00:27,  1.50it/s] 18%|█▊        | 9/49 [00:06<00:26,  1.53it/s] 20%|██        | 10/49 [00:07<00:25,  1.53it/s] 22%|██▏       | 11/49 [00:07<00:24,  1.54it/s] 24%|██▍       | 12/49 [00:08<00:24,  1.54it/s] 27%|██▋       | 13/49 [00:08<00:23,  1.54it/s] 29%|██▊       | 14/49 [00:09<00:22,  1.54it/s] 31%|███       | 15/49 [00:10<00:22,  1.54it/s] 33%|███▎      | 16/49 [00:10<00:21,  1.54it/s] 35%|███▍      | 17/49 [00:11<00:20,  1.54it/s] 37%|███▋      | 18/49 [00:12<00:20,  1.54it/s] 39%|███▉      | 19/49 [00:12<00:19,  1.54it/s] 41%|████      | 20/49 [00:13<00:18,  1.54it/s] 43%|████▎     | 21/49 [00:14<00:18,  1.54it/s] 45%|████▍     | 22/49 [00:14<00:17,  1.53it/s] 47%|████▋     | 23/49 [00:15<00:16,  1.53it/s] 49%|████▉     | 24/49 [00:16<00:16,  1.53it/s] 51%|█████     | 25/49 [00:16<00:15,  1.53it/s] 53%|█████▎    | 26/49 [00:17<00:14,  1.54it/s] 55%|█████▌    | 27/49 [00:18<00:14,  1.54it/s] 57%|█████▋    | 28/49 [00:18<00:13,  1.55it/s] 59%|█████▉    | 29/49 [00:19<00:12,  1.55it/s] 61%|██████    | 30/49 [00:20<00:12,  1.55it/s] 63%|██████▎   | 31/49 [00:20<00:11,  1.55it/s] 65%|██████▌   | 32/49 [00:21<00:10,  1.55it/s] 67%|██████▋   | 33/49 [00:21<00:10,  1.55it/s] 69%|██████▉   | 34/49 [00:22<00:09,  1.55it/s] 71%|███████▏  | 35/49 [00:23<00:09,  1.55it/s] 73%|███████▎  | 36/49 [00:23<00:08,  1.55it/s] 76%|███████▌  | 37/49 [00:24<00:07,  1.55it/s] 78%|███████▊  | 38/49 [00:25<00:07,  1.55it/s] 80%|███████▉  | 39/49 [00:25<00:06,  1.55it/s] 82%|████████▏ | 40/49 [00:26<00:05,  1.55it/s] 84%|████████▎ | 41/49 [00:27<00:05,  1.55it/s] 86%|████████▌ | 42/49 [00:27<00:04,  1.55it/s] 88%|████████▊ | 43/49 [00:28<00:03,  1.54it/s] 90%|████████▉ | 44/49 [00:29<00:03,  1.54it/s] 92%|█████████▏| 45/49 [00:29<00:02,  1.54it/s] 94%|█████████▍| 46/49 [00:30<00:01,  1.54it/s] 96%|█████████▌| 47/49 [00:31<00:01,  1.54it/s] 98%|█████████▊| 48/49 [00:31<00:00,  1.55it/s]100%|██████████| 49/49 [00:32<00:00,  1.56it/s]100%|██████████| 49/49 [00:32<00:00,  1.52it/s]
Computed embeddings shape: torch.Size([392, 2560])

============================================================
Selected 25 representative images:
============================================================
 1. 0_TCGA-C8-A8HP-01A-01-TSA.C1048607-5CC7-4798-AA55-55C78B31C10D_x_76297_y_7906_a_100.000.png (distance: 16.3594)
 2. 2_TCGA-C8-A8HP-01A-01-TSA.C1048607-5CC7-4798-AA55-55C78B31C10D_x_24481_y_13344_a_99.902.png (distance: 17.2656)
 3. 2_TCGA-UU-A93S-01A-02-TSB.B831443D-9BE6-43E0-941D-3881CBC80A78_x_75669_y_25536_a_99.901.png (distance: 17.4531)
 4. 0_TCGA-A2-A0CX-01A-02-TSB.eae9814e-e25c-4dfe-9564-e348c74699ba_x_20896_y_14688_a_100.000.png (distance: 17.7969)
 5. 1_TCGA-BH-A0B7-01A-01-BSA.b842b06f-b4a9-4acf-9534-be4c716763d2_x_41089_y_16704_a_99.982.png (distance: 18.0938)
 6. 0_TCGA-B6-A0RS-01A-01-TS1.f7a616c8-c091-46b7-8dbe-90b1343fe3b1_x_84704_y_21585_a_100.000.png (distance: 18.1719)
 7. 1_TCGA-UU-A93S-01A-02-TSB.B831443D-9BE6-43E0-941D-3881CBC80A78_x_76693_y_23488_a_99.951.png (distance: 18.3125)
 8. 6_TCGA-A2-A0CX-01A-02-TSB.eae9814e-e25c-4dfe-9564-e348c74699ba_x_14752_y_15712_a_99.894.png (distance: 18.4844)
 9. 0_TCGA-C8-A12P-01A-01-BSA.0c86a6ed-1d8f-47a9-ab33-7d232c3e359b_x_19184_y_27568_a_100.000.png (distance: 18.5625)
10. 1_TCGA-A8-A08X-01A-01-BS1.e4d6c832-f42b-4a1d-8a98-4fbdb3ce0e2a_x_17696_y_29248_a_99.979.png (distance: 18.7188)
11. 2_TCGA-B6-A0RS-01A-01-BS1.a630cccd-b4c6-4b3d-ae7b-6256dee4bba7_x_75331_y_24480_a_99.941.png (distance: 18.7500)
12. 5_TCGA-UU-A93S-01A-02-TSB.B831443D-9BE6-43E0-941D-3881CBC80A78_x_74133_y_23488_a_99.753.png (distance: 18.8125)
13. 0_TCGA-A2-A0CX-01A-02-BSB.04ad0cae-1b9c-472f-8d08-ea6995e00bdd_x_74929_y_17825_a_100.000.png (distance: 18.8594)
14. 4_TCGA-AR-A1AT-01A-01-TSA.ea146368-893f-4524-b72a-df5beb9a80da_x_30128_y_21104_a_99.809.png (distance: 18.9375)
15. 5_TCGA-A8-A09X-01A-01-BS1.6f6ae7cd-631e-4030-9183-725f5a48c942_x_98018_y_19392_a_99.921.png (distance: 18.9375)
16. 4_TCGA-BH-A0B7-01A-01-BSA.b842b06f-b4a9-4acf-9534-be4c716763d2_x_36993_y_15168_a_99.929.png (distance: 18.9688)
17. 7_TCGA-AO-A12D-01A-01-BSA.e75eaf83-11b8-49a2-b6b1-77f98fa6660a_x_61590_y_9504_a_99.786.png (distance: 18.9844)
18. 1_TCGA-A2-A0CX-01A-02-BSB.04ad0cae-1b9c-472f-8d08-ea6995e00bdd_x_83633_y_9121_a_99.984.png (distance: 19.0312)
19. 5_TCGA-C8-A8HP-01A-01-TSA.C1048607-5CC7-4798-AA55-55C78B31C10D_x_72713_y_9442_a_99.755.png (distance: 19.0938)
20. 0_TCGA-AR-A0TX-01A-01-TSA.4f6a2ef2-8c09-4c9a-aea9-5601722f4e4c_x_16496_y_12096_a_100.000.png (distance: 19.2344)
21. 1_TCGA-A2-A0CX-01A-02-TSB.eae9814e-e25c-4dfe-9564-e348c74699ba_x_39328_y_19808_a_99.982.png (distance: 19.5000)
22. 5_TCGA-AO-A12D-01A-01-BSA.e75eaf83-11b8-49a2-b6b1-77f98fa6660a_x_67734_y_23328_a_99.847.png (distance: 19.5156)
23. 4_TCGA-C8-A26X-01A-03-TSC.d9c6926f-687a-47a1-9427-a00b7040d661_x_60084_y_12384_a_99.832.png (distance: 19.7344)
24. 3_TCGA-C8-A278-01A-01-TSA.f617a0ab-8b9f-4c15-9bf1-76f9dc0df366_x_10080_y_5792_a_99.868.png (distance: 19.8125)
25. 2_TCGA-AO-A12D-01A-01-BSA.e75eaf83-11b8-49a2-b6b1-77f98fa6660a_x_60054_y_11552_a_99.939.png (distance: 19.8438)

Saved selected images to selected_images_pam50_label_1.txt
Saved detailed results to selected_images_pam50_label_1_with_distances.json

================================

Selecting representatives for label 2 (luma)...
Loaded 5688 images from correct_predictions_pam50_label_2.txt
Loading Virchow v2 model...
Computing embeddings for 5688 images...
  0%|          | 0/711 [00:00<?, ?it/s]  0%|          | 1/711 [00:01<14:57,  1.26s/it]  0%|          | 2/711 [00:01<10:37,  1.11it/s]  0%|          | 3/711 [00:02<09:11,  1.28it/s]  1%|          | 4/711 [00:03<08:27,  1.39it/s]  1%|          | 5/711 [00:03<08:01,  1.47it/s]  1%|          | 6/711 [00:04<07:49,  1.50it/s]  1%|          | 7/711 [00:05<07:39,  1.53it/s]  1%|          | 8/711 [00:05<07:33,  1.55it/s]  1%|▏         | 9/711 [00:06<07:35,  1.54it/s]  1%|▏         | 10/711 [00:06<07:35,  1.54it/s]  2%|▏         | 11/711 [00:07<07:31,  1.55it/s]  2%|▏         | 12/711 [00:08<07:28,  1.56it/s]  2%|▏         | 13/711 [00:08<07:26,  1.56it/s]  2%|▏         | 14/711 [00:09<07:20,  1.58it/s]  2%|▏         | 15/711 [00:10<07:14,  1.60it/s]  2%|▏         | 16/711 [00:10<07:16,  1.59it/s]  2%|▏         | 17/711 [00:11<06:53,  1.68it/s]  3%|▎         | 18/711 [00:11<07:14,  1.60it/s]  3%|▎         | 19/711 [00:12<07:12,  1.60it/s]  3%|▎         | 20/711 [00:13<07:12,  1.60it/s]  3%|▎         | 21/711 [00:13<07:13,  1.59it/s]  3%|▎         | 22/711 [00:14<07:15,  1.58it/s]  3%|▎         | 23/711 [00:15<07:18,  1.57it/s]  3%|▎         | 24/711 [00:15<07:20,  1.56it/s]  4%|▎         | 25/711 [00:16<07:17,  1.57it/s]  4%|▎         | 26/711 [00:17<07:14,  1.58it/s]  4%|▍         | 27/711 [00:17<07:14,  1.57it/s]  4%|▍         | 28/711 [00:18<07:00,  1.62it/s]  4%|▍         | 29/711 [00:18<07:08,  1.59it/s]  4%|▍         | 30/711 [00:19<07:08,  1.59it/s]  4%|▍         | 31/711 [00:20<07:06,  1.59it/s]  5%|▍         | 32/711 [00:20<07:05,  1.60it/s]  5%|▍         | 33/711 [00:21<07:04,  1.60it/s]  5%|▍         | 34/711 [00:22<07:04,  1.59it/s]  5%|▍         | 35/711 [00:22<07:03,  1.60it/s]  5%|▌         | 36/711 [00:23<07:05,  1.59it/s]  5%|▌         | 37/711 [00:23<07:08,  1.57it/s]  5%|▌         | 38/711 [00:24<07:07,  1.57it/s]  5%|▌         | 39/711 [00:25<07:04,  1.58it/s]  6%|▌         | 40/711 [00:25<07:05,  1.58it/s]  6%|▌         | 41/711 [00:26<07:04,  1.58it/s]  6%|▌         | 42/711 [00:27<07:02,  1.58it/s]  6%|▌         | 43/711 [00:27<07:00,  1.59it/s]  6%|▌         | 44/711 [00:28<07:04,  1.57it/s]  6%|▋         | 45/711 [00:29<07:03,  1.57it/s]  6%|▋         | 46/711 [00:29<07:05,  1.56it/s]  7%|▋         | 47/711 [00:30<07:07,  1.55it/s]  7%|▋         | 48/711 [00:30<07:08,  1.55it/s]  7%|▋         | 49/711 [00:31<07:08,  1.54it/s]  7%|▋         | 50/711 [00:32<07:08,  1.54it/s]  7%|▋         | 51/711 [00:32<07:08,  1.54it/s]  7%|▋         | 52/711 [00:33<07:08,  1.54it/s]  7%|▋         | 53/711 [00:34<07:06,  1.54it/s]  8%|▊         | 54/711 [00:34<07:06,  1.54it/s]  8%|▊         | 55/711 [00:35<07:06,  1.54it/s]  8%|▊         | 56/711 [00:36<07:07,  1.53it/s]  8%|▊         | 57/711 [00:36<07:05,  1.54it/s]  8%|▊         | 58/711 [00:37<07:04,  1.54it/s]  8%|▊         | 59/711 [00:38<07:02,  1.54it/s]  8%|▊         | 60/711 [00:38<07:01,  1.54it/s]  9%|▊         | 61/711 [00:39<07:02,  1.54it/s]  9%|▊         | 62/711 [00:40<07:00,  1.54it/s]  9%|▉         | 63/711 [00:40<07:01,  1.54it/s]  9%|▉         | 64/711 [00:41<06:59,  1.54it/s]  9%|▉         | 65/711 [00:42<06:59,  1.54it/s]  9%|▉         | 66/711 [00:42<06:57,  1.54it/s]  9%|▉         | 67/711 [00:43<06:58,  1.54it/s] 10%|▉         | 68/711 [00:43<06:57,  1.54it/s] 10%|▉         | 69/711 [00:44<06:57,  1.54it/s] 10%|▉         | 70/711 [00:45<06:55,  1.54it/s] 10%|▉         | 71/711 [00:45<06:53,  1.55it/s] 10%|█         | 72/711 [00:46<06:53,  1.54it/s] 10%|█         | 73/711 [00:47<06:54,  1.54it/s] 10%|█         | 74/711 [00:47<06:53,  1.54it/s] 11%|█         | 75/711 [00:48<06:54,  1.53it/s] 11%|█         | 76/711 [00:49<06:54,  1.53it/s] 11%|█         | 77/711 [00:49<06:53,  1.53it/s] 11%|█         | 78/711 [00:50<06:52,  1.53it/s] 11%|█         | 79/711 [00:51<06:52,  1.53it/s] 11%|█▏        | 80/711 [00:51<06:52,  1.53it/s] 11%|█▏        | 81/711 [00:52<06:49,  1.54it/s] 12%|█▏        | 82/711 [00:53<06:47,  1.54it/s] 12%|█▏        | 83/711 [00:53<06:45,  1.55it/s] 12%|█▏        | 84/711 [00:54<06:44,  1.55it/s] 12%|█▏        | 85/711 [00:55<06:44,  1.55it/s] 12%|█▏        | 86/711 [00:55<06:44,  1.55it/s] 12%|█▏        | 87/711 [00:56<06:42,  1.55it/s] 12%|█▏        | 88/711 [00:56<06:43,  1.55it/s] 13%|█▎        | 89/711 [00:57<06:42,  1.54it/s] 13%|█▎        | 90/711 [00:58<06:43,  1.54it/s] 13%|█▎        | 91/711 [00:58<06:42,  1.54it/s] 13%|█▎        | 92/711 [00:59<06:42,  1.54it/s] 13%|█▎        | 93/711 [01:00<06:41,  1.54it/s] 13%|█▎        | 94/711 [01:00<06:40,  1.54it/s] 13%|█▎        | 95/711 [01:01<06:40,  1.54it/s] 14%|█▎        | 96/711 [01:02<06:37,  1.55it/s] 14%|█▎        | 97/711 [01:02<06:36,  1.55it/s] 14%|█▍        | 98/711 [01:03<06:37,  1.54it/s] 14%|█▍        | 99/711 [01:04<06:37,  1.54it/s] 14%|█▍        | 100/711 [01:04<06:37,  1.54it/s] 14%|█▍        | 101/711 [01:05<06:37,  1.54it/s] 14%|█▍        | 102/711 [01:06<06:39,  1.53it/s] 14%|█▍        | 103/711 [01:06<06:35,  1.54it/s] 15%|█▍        | 104/711 [01:07<06:35,  1.53it/s] 15%|█▍        | 105/711 [01:07<06:33,  1.54it/s] 15%|█▍        | 106/711 [01:08<06:34,  1.54it/s] 15%|█▌        | 107/711 [01:09<06:32,  1.54it/s] 15%|█▌        | 108/711 [01:09<06:32,  1.54it/s] 15%|█▌        | 109/711 [01:10<06:30,  1.54it/s] 15%|█▌        | 110/711 [01:11<06:29,  1.54it/s] 16%|█▌        | 111/711 [01:11<06:29,  1.54it/s] 16%|█▌        | 112/711 [01:12<06:29,  1.54it/s] 16%|█▌        | 113/711 [01:13<06:26,  1.55it/s] 16%|█▌        | 114/711 [01:13<06:26,  1.55it/s] 16%|█▌        | 115/711 [01:14<06:21,  1.56it/s] 16%|█▋        | 116/711 [01:15<06:22,  1.56it/s] 16%|█▋        | 117/711 [01:15<06:21,  1.56it/s] 17%|█▋        | 118/711 [01:16<06:21,  1.56it/s] 17%|█▋        | 119/711 [01:17<06:22,  1.55it/s] 17%|█▋        | 120/711 [01:17<06:22,  1.54it/s] 17%|█▋        | 121/711 [01:18<06:23,  1.54it/s] 17%|█▋        | 122/711 [01:19<06:22,  1.54it/s] 17%|█▋        | 123/711 [01:19<06:22,  1.54it/s] 17%|█▋        | 124/711 [01:20<06:22,  1.54it/s] 18%|█▊        | 125/711 [01:20<06:19,  1.54it/s] 18%|█▊        | 126/711 [01:21<06:19,  1.54it/s] 18%|█▊        | 127/711 [01:22<06:20,  1.54it/s] 18%|█▊        | 128/711 [01:22<06:20,  1.53it/s] 18%|█▊        | 129/711 [01:23<06:19,  1.53it/s] 18%|█▊        | 130/711 [01:24<06:19,  1.53it/s] 18%|█▊        | 131/711 [01:24<06:16,  1.54it/s] 19%|█▊        | 132/711 [01:25<06:14,  1.54it/s] 19%|█▊        | 133/711 [01:26<06:15,  1.54it/s] 19%|█▉        | 134/711 [01:26<06:15,  1.54it/s] 19%|█▉        | 135/711 [01:27<06:15,  1.54it/s] 19%|█▉        | 136/711 [01:28<06:13,  1.54it/s] 19%|█▉        | 137/711 [01:28<06:11,  1.55it/s] 19%|█▉        | 138/711 [01:29<06:12,  1.54it/s] 20%|█▉        | 139/711 [01:30<06:11,  1.54it/s] 20%|█▉        | 140/711 [01:30<06:11,  1.54it/s] 20%|█▉        | 141/711 [01:31<06:11,  1.54it/s] 20%|█▉        | 142/711 [01:31<06:07,  1.55it/s] 20%|██        | 143/711 [01:32<06:07,  1.55it/s] 20%|██        | 144/711 [01:33<06:07,  1.54it/s] 20%|██        | 145/711 [01:33<06:06,  1.55it/s] 21%|██        | 146/711 [01:34<06:04,  1.55it/s] 21%|██        | 147/711 [01:35<06:05,  1.54it/s] 21%|██        | 148/711 [01:35<06:04,  1.54it/s] 21%|██        | 149/711 [01:36<06:03,  1.55it/s] 21%|██        | 150/711 [01:37<06:01,  1.55it/s] 21%|██        | 151/711 [01:37<06:01,  1.55it/s] 21%|██▏       | 152/711 [01:38<05:59,  1.56it/s] 22%|██▏       | 153/711 [01:39<06:00,  1.55it/s] 22%|██▏       | 154/711 [01:39<05:57,  1.56it/s] 22%|██▏       | 155/711 [01:40<05:59,  1.55it/s] 22%|██▏       | 156/711 [01:41<05:59,  1.54it/s] 22%|██▏       | 157/711 [01:41<05:59,  1.54it/s] 22%|██▏       | 158/711 [01:42<05:59,  1.54it/s] 22%|██▏       | 159/711 [01:42<05:57,  1.54it/s] 23%|██▎       | 160/711 [01:43<05:55,  1.55it/s] 23%|██▎       | 161/711 [01:44<05:56,  1.54it/s] 23%|██▎       | 162/711 [01:44<05:57,  1.54it/s] 23%|██▎       | 163/711 [01:45<05:56,  1.54it/s] 23%|██▎       | 164/711 [01:46<05:56,  1.53it/s] 23%|██▎       | 165/711 [01:46<05:55,  1.54it/s] 23%|██▎       | 166/711 [01:47<05:54,  1.54it/s] 23%|██▎       | 167/711 [01:48<05:51,  1.55it/s] 24%|██▎       | 168/711 [01:48<05:50,  1.55it/s] 24%|██▍       | 169/711 [01:49<05:49,  1.55it/s] 24%|██▍       | 170/711 [01:50<05:49,  1.55it/s] 24%|██▍       | 171/711 [01:50<05:49,  1.54it/s] 24%|██▍       | 172/711 [01:51<05:49,  1.54it/s] 24%|██▍       | 173/711 [01:52<05:49,  1.54it/s] 24%|██▍       | 174/711 [01:52<05:51,  1.53it/s] 25%|██▍       | 175/711 [01:53<05:48,  1.54it/s] 25%|██▍       | 176/711 [01:54<05:46,  1.54it/s] 25%|██▍       | 177/711 [01:54<05:44,  1.55it/s] 25%|██▌       | 178/711 [01:55<05:45,  1.54it/s] 25%|██▌       | 179/711 [01:55<05:45,  1.54it/s] 25%|██▌       | 180/711 [01:56<05:45,  1.54it/s] 25%|██▌       | 181/711 [01:57<05:45,  1.53it/s] 26%|██▌       | 182/711 [01:57<05:42,  1.54it/s] 26%|██▌       | 183/711 [01:58<05:43,  1.54it/s] 26%|██▌       | 184/711 [01:59<05:43,  1.53it/s] 26%|██▌       | 185/711 [01:59<05:41,  1.54it/s] 26%|██▌       | 186/711 [02:00<05:42,  1.53it/s] 26%|██▋       | 187/711 [02:01<05:38,  1.55it/s] 26%|██▋       | 188/711 [02:01<05:37,  1.55it/s] 27%|██▋       | 189/711 [02:02<05:38,  1.54it/s] 27%|██▋       | 190/711 [02:03<05:36,  1.55it/s] 27%|██▋       | 191/711 [02:03<05:34,  1.55it/s] 27%|██▋       | 192/711 [02:04<05:34,  1.55it/s] 27%|██▋       | 193/711 [02:05<05:33,  1.55it/s] 27%|██▋       | 194/711 [02:05<05:32,  1.56it/s] 27%|██▋       | 195/711 [02:06<05:31,  1.56it/s] 28%|██▊       | 196/711 [02:06<05:31,  1.56it/s] 28%|██▊       | 197/711 [02:07<05:30,  1.56it/s] 28%|██▊       | 198/711 [02:08<05:29,  1.56it/s] 28%|██▊       | 199/711 [02:08<05:31,  1.54it/s] 28%|██▊       | 200/711 [02:09<05:30,  1.55it/s] 28%|██▊       | 201/711 [02:10<05:30,  1.54it/s] 28%|██▊       | 202/711 [02:10<05:29,  1.54it/s] 29%|██▊       | 203/711 [02:11<05:27,  1.55it/s] 29%|██▊       | 204/711 [02:12<05:26,  1.55it/s] 29%|██▉       | 205/711 [02:12<05:25,  1.55it/s] 29%|██▉       | 206/711 [02:13<05:25,  1.55it/s] 29%|██▉       | 207/711 [02:14<05:25,  1.55it/s] 29%|██▉       | 208/711 [02:14<05:24,  1.55it/s] 29%|██▉       | 209/711 [02:15<05:25,  1.54it/s] 30%|██▉       | 210/711 [02:16<05:25,  1.54it/s] 30%|██▉       | 211/711 [02:16<05:25,  1.54it/s] 30%|██▉       | 212/711 [02:17<05:25,  1.53it/s] 30%|██▉       | 213/711 [02:17<05:25,  1.53it/s] 30%|███       | 214/711 [02:18<05:22,  1.54it/s] 30%|███       | 215/711 [02:19<05:22,  1.54it/s] 30%|███       | 216/711 [02:19<05:21,  1.54it/s] 31%|███       | 217/711 [02:20<05:19,  1.55it/s] 31%|███       | 218/711 [02:21<05:18,  1.55it/s] 31%|███       | 219/711 [02:21<05:18,  1.54it/s] 31%|███       | 220/711 [02:22<05:17,  1.54it/s] 31%|███       | 221/711 [02:23<05:17,  1.55it/s] 31%|███       | 222/711 [02:23<05:19,  1.53it/s] 31%|███▏      | 223/711 [02:24<05:17,  1.54it/s] 32%|███▏      | 224/711 [02:25<05:15,  1.54it/s] 32%|███▏      | 225/711 [02:25<05:13,  1.55it/s] 32%|███▏      | 226/711 [02:26<05:12,  1.55it/s] 32%|███▏      | 227/711 [02:27<05:11,  1.55it/s] 32%|███▏      | 228/711 [02:27<05:11,  1.55it/s] 32%|███▏      | 229/711 [02:28<05:13,  1.54it/s] 32%|███▏      | 230/711 [02:28<05:11,  1.55it/s] 32%|███▏      | 231/711 [02:29<05:11,  1.54it/s] 33%|███▎      | 232/711 [02:30<05:11,  1.54it/s] 33%|███▎      | 233/711 [02:30<05:09,  1.54it/s] 33%|███▎      | 234/711 [02:31<05:09,  1.54it/s] 33%|███▎      | 235/711 [02:32<05:09,  1.54it/s] 33%|███▎      | 236/711 [02:32<05:08,  1.54it/s] 33%|███▎      | 237/711 [02:33<05:08,  1.53it/s] 33%|███▎      | 238/711 [02:34<05:06,  1.54it/s] 34%|███▎      | 239/711 [02:34<05:07,  1.54it/s] 34%|███▍      | 240/711 [02:35<05:06,  1.53it/s] 34%|███▍      | 241/711 [02:36<05:06,  1.53it/s] 34%|███▍      | 242/711 [02:36<05:05,  1.54it/s] 34%|███▍      | 243/711 [02:37<05:05,  1.53it/s] 34%|███▍      | 244/711 [02:38<05:03,  1.54it/s] 34%|███▍      | 245/711 [02:38<05:03,  1.53it/s] 35%|███▍      | 246/711 [02:39<05:03,  1.53it/s] 35%|███▍      | 247/711 [02:40<05:03,  1.53it/s] 35%|███▍      | 248/711 [02:40<05:02,  1.53it/s] 35%|███▌      | 249/711 [02:41<05:00,  1.54it/s] 35%|███▌      | 250/711 [02:41<05:00,  1.54it/s] 35%|███▌      | 251/711 [02:42<04:58,  1.54it/s] 35%|███▌      | 252/711 [02:43<04:56,  1.55it/s] 36%|███▌      | 253/711 [02:43<04:55,  1.55it/s] 36%|███▌      | 254/711 [02:44<04:54,  1.55it/s] 36%|███▌      | 255/711 [02:45<04:53,  1.55it/s] 36%|███▌      | 256/711 [02:45<04:51,  1.56it/s] 36%|███▌      | 257/711 [02:46<04:51,  1.56it/s] 36%|███▋      | 258/711 [02:47<04:52,  1.55it/s] 36%|███▋      | 259/711 [02:47<04:53,  1.54it/s] 37%|███▋      | 260/711 [02:48<04:51,  1.55it/s] 37%|███▋      | 261/711 [02:49<04:50,  1.55it/s] 37%|███▋      | 262/711 [02:49<04:50,  1.54it/s] 37%|███▋      | 263/711 [02:50<04:50,  1.54it/s] 37%|███▋      | 264/711 [02:51<04:49,  1.55it/s] 37%|███▋      | 265/711 [02:51<04:49,  1.54it/s] 37%|███▋      | 266/711 [02:52<04:49,  1.54it/s] 38%|███▊      | 267/711 [02:52<04:48,  1.54it/s] 38%|███▊      | 268/711 [02:53<04:48,  1.54it/s] 38%|███▊      | 269/711 [02:54<04:48,  1.53it/s] 38%|███▊      | 270/711 [02:54<04:45,  1.54it/s] 38%|███▊      | 271/711 [02:55<04:45,  1.54it/s] 38%|███▊      | 272/711 [02:56<04:44,  1.55it/s] 38%|███▊      | 273/711 [02:56<04:43,  1.55it/s] 39%|███▊      | 274/711 [02:57<04:40,  1.56it/s] 39%|███▊      | 275/711 [02:58<04:39,  1.56it/s] 39%|███▉      | 276/711 [02:58<04:40,  1.55it/s] 39%|███▉      | 277/711 [02:59<04:40,  1.55it/s] 39%|███▉      | 278/711 [03:00<04:38,  1.56it/s] 39%|███▉      | 279/711 [03:00<04:38,  1.55it/s] 39%|███▉      | 280/711 [03:01<04:40,  1.54it/s] 40%|███▉      | 281/711 [03:02<04:42,  1.52it/s] 40%|███▉      | 282/711 [03:02<04:42,  1.52it/s] 40%|███▉      | 283/711 [03:03<04:43,  1.51it/s] 40%|███▉      | 284/711 [03:04<04:43,  1.51it/s] 40%|████      | 285/711 [03:04<04:42,  1.51it/s] 40%|████      | 286/711 [03:05<04:42,  1.51it/s] 40%|████      | 287/711 [03:06<04:41,  1.51it/s] 41%|████      | 288/711 [03:06<04:41,  1.50it/s] 41%|████      | 289/711 [03:07<04:41,  1.50it/s] 41%|████      | 290/711 [03:08<04:40,  1.50it/s] 41%|████      | 291/711 [03:08<04:39,  1.51it/s] 41%|████      | 292/711 [03:09<04:37,  1.51it/s] 41%|████      | 293/711 [03:10<04:35,  1.52it/s] 41%|████▏     | 294/711 [03:10<04:32,  1.53it/s] 41%|████▏     | 295/711 [03:11<04:30,  1.54it/s] 42%|████▏     | 296/711 [03:11<04:29,  1.54it/s] 42%|████▏     | 297/711 [03:12<04:29,  1.54it/s] 42%|████▏     | 298/711 [03:13<04:29,  1.53it/s] 42%|████▏     | 299/711 [03:13<04:27,  1.54it/s] 42%|████▏     | 300/711 [03:14<04:27,  1.54it/s] 42%|████▏     | 301/711 [03:15<04:27,  1.54it/s] 42%|████▏     | 302/711 [03:15<04:26,  1.54it/s] 43%|████▎     | 303/711 [03:16<04:24,  1.54it/s] 43%|████▎     | 304/711 [03:17<04:22,  1.55it/s] 43%|████▎     | 305/711 [03:17<04:27,  1.52it/s] 43%|████▎     | 306/711 [03:18<04:25,  1.53it/s] 43%|████▎     | 307/711 [03:19<04:24,  1.53it/s] 43%|████▎     | 308/711 [03:19<04:24,  1.53it/s] 43%|████▎     | 309/711 [03:20<04:23,  1.53it/s] 44%|████▎     | 310/711 [03:21<04:22,  1.53it/s] 44%|████▎     | 311/711 [03:21<04:21,  1.53it/s] 44%|████▍     | 312/711 [03:22<04:19,  1.54it/s] 44%|████▍     | 313/711 [03:23<04:18,  1.54it/s] 44%|████▍     | 314/711 [03:23<04:16,  1.55it/s] 44%|████▍     | 315/711 [03:24<04:17,  1.54it/s] 44%|████▍     | 316/711 [03:24<04:15,  1.55it/s] 45%|████▍     | 317/711 [03:25<04:14,  1.55it/s] 45%|████▍     | 318/711 [03:26<04:13,  1.55it/s] 45%|████▍     | 319/711 [03:26<04:11,  1.56it/s] 45%|████▌     | 320/711 [03:27<04:11,  1.56it/s] 45%|████▌     | 321/711 [03:28<04:10,  1.56it/s] 45%|████▌     | 322/711 [03:28<04:09,  1.56it/s] 45%|████▌     | 323/711 [03:29<04:10,  1.55it/s] 46%|████▌     | 324/711 [03:30<04:10,  1.54it/s] 46%|████▌     | 325/711 [03:30<04:10,  1.54it/s] 46%|████▌     | 326/711 [03:31<04:10,  1.54it/s] 46%|████▌     | 327/711 [03:32<04:10,  1.53it/s] 46%|████▌     | 328/711 [03:32<04:08,  1.54it/s] 46%|████▋     | 329/711 [03:33<04:06,  1.55it/s] 46%|████▋     | 330/711 [03:34<04:06,  1.54it/s] 47%|████▋     | 331/711 [03:34<04:06,  1.54it/s] 47%|████▋     | 332/711 [03:35<04:05,  1.54it/s] 47%|████▋     | 333/711 [03:35<04:05,  1.54it/s] 47%|████▋     | 334/711 [03:36<04:04,  1.54it/s] 47%|████▋     | 335/711 [03:37<04:04,  1.54it/s] 47%|████▋     | 336/711 [03:37<04:03,  1.54it/s] 47%|████▋     | 337/711 [03:38<04:03,  1.54it/s] 48%|████▊     | 338/711 [03:39<04:03,  1.53it/s] 48%|████▊     | 339/711 [03:39<04:02,  1.53it/s] 48%|████▊     | 340/711 [03:40<04:01,  1.53it/s] 48%|████▊     | 341/711 [03:41<04:01,  1.53it/s] 48%|████▊     | 342/711 [03:41<04:00,  1.53it/s] 48%|████▊     | 343/711 [03:42<04:00,  1.53it/s] 48%|████▊     | 344/711 [03:43<03:59,  1.53it/s] 49%|████▊     | 345/711 [03:43<03:58,  1.53it/s] 49%|████▊     | 346/711 [03:44<03:57,  1.54it/s] 49%|████▉     | 347/711 [03:45<03:56,  1.54it/s] 49%|████▉     | 348/711 [03:45<03:56,  1.54it/s] 49%|████▉     | 349/711 [03:46<03:55,  1.54it/s] 49%|████▉     | 350/711 [03:47<03:55,  1.53it/s] 49%|████▉     | 351/711 [03:47<03:53,  1.54it/s] 50%|████▉     | 352/711 [03:48<03:53,  1.54it/s] 50%|████▉     | 353/711 [03:48<03:52,  1.54it/s] 50%|████▉     | 354/711 [03:49<03:52,  1.54it/s] 50%|████▉     | 355/711 [03:50<03:50,  1.54it/s] 50%|█████     | 356/711 [03:50<03:51,  1.54it/s] 50%|█████     | 357/711 [03:51<03:49,  1.54it/s] 50%|█████     | 358/711 [03:52<03:49,  1.54it/s] 50%|█████     | 359/711 [03:52<03:48,  1.54it/s] 51%|█████     | 360/711 [03:53<03:48,  1.54it/s] 51%|█████     | 361/711 [03:54<03:47,  1.54it/s] 51%|█████     | 362/711 [03:54<03:48,  1.53it/s] 51%|█████     | 363/711 [03:55<03:47,  1.53it/s] 51%|█████     | 364/711 [03:56<03:46,  1.53it/s] 51%|█████▏    | 365/711 [03:56<03:46,  1.53it/s] 51%|█████▏    | 366/711 [03:57<03:45,  1.53it/s] 52%|█████▏    | 367/711 [03:58<03:44,  1.53it/s] 52%|█████▏    | 368/711 [03:58<03:43,  1.53it/s] 52%|█████▏    | 369/711 [03:59<03:42,  1.54it/s] 52%|█████▏    | 370/711 [04:00<03:40,  1.55it/s] 52%|█████▏    | 371/711 [04:00<03:40,  1.54it/s] 52%|█████▏    | 372/711 [04:01<03:40,  1.54it/s] 52%|█████▏    | 373/711 [04:02<03:39,  1.54it/s] 53%|█████▎    | 374/711 [04:02<03:39,  1.54it/s] 53%|█████▎    | 375/711 [04:03<03:38,  1.54it/s] 53%|█████▎    | 376/711 [04:03<03:38,  1.53it/s] 53%|█████▎    | 377/711 [04:04<03:35,  1.55it/s] 53%|█████▎    | 378/711 [04:05<03:35,  1.54it/s] 53%|█████▎    | 379/711 [04:05<03:35,  1.54it/s] 53%|█████▎    | 380/711 [04:06<03:35,  1.54it/s] 54%|█████▎    | 381/711 [04:07<03:34,  1.54it/s] 54%|█████▎    | 382/711 [04:07<03:34,  1.53it/s] 54%|█████▍    | 383/711 [04:08<03:34,  1.53it/s] 54%|█████▍    | 384/711 [04:09<03:31,  1.54it/s] 54%|█████▍    | 385/711 [04:09<03:30,  1.55it/s] 54%|█████▍    | 386/711 [04:10<03:30,  1.55it/s] 54%|█████▍    | 387/711 [04:11<03:29,  1.54it/s] 55%|█████▍    | 388/711 [04:11<03:28,  1.55it/s] 55%|█████▍    | 389/711 [04:12<03:27,  1.55it/s] 55%|█████▍    | 390/711 [04:13<03:28,  1.54it/s] 55%|█████▍    | 391/711 [04:13<03:27,  1.54it/s] 55%|█████▌    | 392/711 [04:14<03:27,  1.54it/s] 55%|█████▌    | 393/711 [04:14<03:27,  1.53it/s] 55%|█████▌    | 394/711 [04:15<03:26,  1.53it/s] 56%|█████▌    | 395/711 [04:16<03:26,  1.53it/s] 56%|█████▌    | 396/711 [04:16<03:26,  1.53it/s] 56%|█████▌    | 397/711 [04:17<03:25,  1.53it/s] 56%|█████▌    | 398/711 [04:18<03:24,  1.53it/s] 56%|█████▌    | 399/711 [04:18<03:22,  1.54it/s] 56%|█████▋    | 400/711 [04:19<03:22,  1.53it/s] 56%|█████▋    | 401/711 [04:20<03:22,  1.53it/s] 57%|█████▋    | 402/711 [04:20<03:21,  1.53it/s] 57%|█████▋    | 403/711 [04:21<03:19,  1.54it/s] 57%|█████▋    | 404/711 [04:22<03:19,  1.54it/s] 57%|█████▋    | 405/711 [04:22<03:19,  1.54it/s] 57%|█████▋    | 406/711 [04:23<03:18,  1.54it/s] 57%|█████▋    | 407/711 [04:24<03:17,  1.54it/s] 57%|█████▋    | 408/711 [04:24<03:16,  1.54it/s] 58%|█████▊    | 409/711 [04:25<03:15,  1.54it/s] 58%|█████▊    | 410/711 [04:26<03:13,  1.55it/s] 58%|█████▊    | 411/711 [04:26<03:12,  1.56it/s] 58%|█████▊    | 412/711 [04:27<03:13,  1.55it/s] 58%|█████▊    | 413/711 [04:27<03:12,  1.54it/s] 58%|█████▊    | 414/711 [04:28<03:12,  1.54it/s] 58%|█████▊    | 415/711 [04:29<03:11,  1.54it/s] 59%|█████▊    | 416/711 [04:29<03:11,  1.54it/s] 59%|█████▊    | 417/711 [04:30<03:10,  1.54it/s] 59%|█████▉    | 418/711 [04:31<03:09,  1.54it/s] 59%|█████▉    | 419/711 [04:31<03:09,  1.54it/s] 59%|█████▉    | 420/711 [04:32<03:08,  1.55it/s] 59%|█████▉    | 421/711 [04:33<03:07,  1.54it/s] 59%|█████▉    | 422/711 [04:33<03:07,  1.54it/s] 59%|█████▉    | 423/711 [04:34<03:07,  1.54it/s] 60%|█████▉    | 424/711 [04:35<03:06,  1.54it/s] 60%|█████▉    | 425/711 [04:35<03:06,  1.53it/s] 60%|█████▉    | 426/711 [04:36<03:05,  1.53it/s] 60%|██████    | 427/711 [04:37<03:04,  1.54it/s] 60%|██████    | 428/711 [04:37<03:03,  1.54it/s] 60%|██████    | 429/711 [04:38<03:03,  1.54it/s] 60%|██████    | 430/711 [04:39<03:02,  1.54it/s] 61%|██████    | 431/711 [04:39<03:02,  1.54it/s] 61%|██████    | 432/711 [04:40<03:00,  1.54it/s] 61%|██████    | 433/711 [04:40<03:00,  1.54it/s] 61%|██████    | 434/711 [04:41<02:59,  1.55it/s] 61%|██████    | 435/711 [04:42<02:58,  1.54it/s] 61%|██████▏   | 436/711 [04:42<02:58,  1.54it/s] 61%|██████▏   | 437/711 [04:43<02:58,  1.54it/s] 62%|██████▏   | 438/711 [04:44<02:57,  1.54it/s] 62%|██████▏   | 439/711 [04:44<02:57,  1.53it/s] 62%|██████▏   | 440/711 [04:45<02:56,  1.53it/s] 62%|██████▏   | 441/711 [04:46<02:56,  1.53it/s] 62%|██████▏   | 442/711 [04:46<02:55,  1.53it/s] 62%|██████▏   | 443/711 [04:47<02:55,  1.53it/s] 62%|██████▏   | 444/711 [04:48<02:54,  1.53it/s] 63%|██████▎   | 445/711 [04:48<02:53,  1.53it/s] 63%|██████▎   | 446/711 [04:49<02:52,  1.54it/s] 63%|██████▎   | 447/711 [04:50<02:52,  1.53it/s] 63%|██████▎   | 448/711 [04:50<02:51,  1.53it/s] 63%|██████▎   | 449/711 [04:51<02:50,  1.54it/s] 63%|██████▎   | 450/711 [04:52<02:50,  1.53it/s] 63%|██████▎   | 451/711 [04:52<02:48,  1.54it/s] 64%|██████▎   | 452/711 [04:53<02:48,  1.54it/s] 64%|██████▎   | 453/711 [04:54<02:48,  1.54it/s] 64%|██████▍   | 454/711 [04:54<02:46,  1.54it/s] 64%|██████▍   | 455/711 [04:55<02:45,  1.55it/s] 64%|██████▍   | 456/711 [04:55<02:44,  1.55it/s] 64%|██████▍   | 457/711 [04:56<02:43,  1.56it/s] 64%|██████▍   | 458/711 [04:57<02:43,  1.55it/s] 65%|██████▍   | 459/711 [04:57<02:41,  1.56it/s] 65%|██████▍   | 460/711 [04:58<02:41,  1.56it/s] 65%|██████▍   | 461/711 [04:59<02:40,  1.56it/s] 65%|██████▍   | 462/711 [04:59<02:40,  1.56it/s] 65%|██████▌   | 463/711 [05:00<02:38,  1.56it/s] 65%|██████▌   | 464/711 [05:01<02:38,  1.56it/s] 65%|██████▌   | 465/711 [05:01<02:37,  1.56it/s] 66%|██████▌   | 466/711 [05:02<02:37,  1.55it/s] 66%|██████▌   | 467/711 [05:02<02:37,  1.55it/s] 66%|██████▌   | 468/711 [05:03<02:36,  1.55it/s] 66%|██████▌   | 469/711 [05:04<02:36,  1.55it/s] 66%|██████▌   | 470/711 [05:04<02:35,  1.55it/s] 66%|██████▌   | 471/711 [05:05<02:34,  1.55it/s] 66%|██████▋   | 472/711 [05:06<02:34,  1.55it/s] 67%|██████▋   | 473/711 [05:06<02:34,  1.54it/s] 67%|██████▋   | 474/711 [05:07<02:34,  1.54it/s] 67%|██████▋   | 475/711 [05:08<02:33,  1.54it/s] 67%|██████▋   | 476/711 [05:08<02:33,  1.53it/s] 67%|██████▋   | 477/711 [05:09<02:32,  1.53it/s] 67%|██████▋   | 478/711 [05:10<02:32,  1.53it/s] 67%|██████▋   | 479/711 [05:10<02:31,  1.53it/s] 68%|██████▊   | 480/711 [05:11<02:30,  1.53it/s] 68%|██████▊   | 481/711 [05:12<02:30,  1.53it/s] 68%|██████▊   | 482/711 [05:12<02:29,  1.53it/s] 68%|██████▊   | 483/711 [05:13<02:29,  1.53it/s] 68%|██████▊   | 484/711 [05:14<02:28,  1.53it/s] 68%|██████▊   | 485/711 [05:14<02:27,  1.53it/s] 68%|██████▊   | 486/711 [05:15<02:26,  1.53it/s] 68%|██████▊   | 487/711 [05:16<02:25,  1.54it/s] 69%|██████▊   | 488/711 [05:16<02:23,  1.55it/s] 69%|██████▉   | 489/711 [05:17<02:23,  1.55it/s] 69%|██████▉   | 490/711 [05:17<02:23,  1.54it/s] 69%|██████▉   | 491/711 [05:18<02:22,  1.54it/s] 69%|██████▉   | 492/711 [05:19<02:22,  1.54it/s] 69%|██████▉   | 493/711 [05:19<02:21,  1.54it/s] 69%|██████▉   | 494/711 [05:20<02:20,  1.55it/s] 70%|██████▉   | 495/711 [05:21<02:20,  1.54it/s] 70%|██████▉   | 496/711 [05:21<02:19,  1.54it/s] 70%|██████▉   | 497/711 [05:22<02:19,  1.54it/s] 70%|███████   | 498/711 [05:23<02:18,  1.54it/s] 70%|███████   | 499/711 [05:23<02:18,  1.53it/s] 70%|███████   | 500/711 [05:24<02:17,  1.54it/s] 70%|███████   | 501/711 [05:25<02:16,  1.54it/s] 71%|███████   | 502/711 [05:25<02:15,  1.54it/s] 71%|███████   | 503/711 [05:26<02:15,  1.54it/s] 71%|███████   | 504/711 [05:27<02:15,  1.53it/s] 71%|███████   | 505/711 [05:27<02:14,  1.53it/s] 71%|███████   | 506/711 [05:28<02:13,  1.53it/s] 71%|███████▏  | 507/711 [05:29<02:13,  1.52it/s] 71%|███████▏  | 508/711 [05:29<02:13,  1.53it/s] 72%|███████▏  | 509/711 [05:30<02:12,  1.52it/s] 72%|███████▏  | 510/711 [05:31<02:11,  1.52it/s] 72%|███████▏  | 511/711 [05:31<02:11,  1.53it/s] 72%|███████▏  | 512/711 [05:32<02:10,  1.53it/s] 72%|███████▏  | 513/711 [05:32<02:09,  1.53it/s] 72%|███████▏  | 514/711 [05:33<02:07,  1.54it/s] 72%|███████▏  | 515/711 [05:34<02:06,  1.54it/s] 73%|███████▎  | 516/711 [05:34<02:05,  1.55it/s] 73%|███████▎  | 517/711 [05:35<02:04,  1.56it/s] 73%|███████▎  | 518/711 [05:36<02:04,  1.55it/s] 73%|███████▎  | 519/711 [05:36<02:04,  1.54it/s] 73%|███████▎  | 520/711 [05:37<02:04,  1.54it/s] 73%|███████▎  | 521/711 [05:38<02:03,  1.54it/s] 73%|███████▎  | 522/711 [05:38<02:02,  1.55it/s] 74%|███████▎  | 523/711 [05:39<02:01,  1.55it/s] 74%|███████▎  | 524/711 [05:40<02:01,  1.54it/s] 74%|███████▍  | 525/711 [05:40<02:00,  1.55it/s] 74%|███████▍  | 526/711 [05:41<01:59,  1.55it/s] 74%|███████▍  | 527/711 [05:41<01:58,  1.55it/s] 74%|███████▍  | 528/711 [05:42<01:57,  1.55it/s] 74%|███████▍  | 529/711 [05:43<01:57,  1.55it/s] 75%|███████▍  | 530/711 [05:43<01:56,  1.55it/s] 75%|███████▍  | 531/711 [05:44<01:56,  1.55it/s] 75%|███████▍  | 532/711 [05:45<01:55,  1.54it/s] 75%|███████▍  | 533/711 [05:45<01:55,  1.55it/s] 75%|███████▌  | 534/711 [05:46<01:54,  1.55it/s] 75%|███████▌  | 535/711 [05:47<01:54,  1.54it/s] 75%|███████▌  | 536/711 [05:47<01:53,  1.54it/s] 76%|███████▌  | 537/711 [05:48<01:52,  1.55it/s] 76%|███████▌  | 538/711 [05:49<01:51,  1.55it/s] 76%|███████▌  | 539/711 [05:49<01:51,  1.54it/s] 76%|███████▌  | 540/711 [05:50<01:50,  1.55it/s] 76%|███████▌  | 541/711 [05:51<01:49,  1.55it/s] 76%|███████▌  | 542/711 [05:51<01:49,  1.55it/s] 76%|███████▋  | 543/711 [05:52<01:49,  1.54it/s] 77%|███████▋  | 544/711 [05:53<01:48,  1.54it/s] 77%|███████▋  | 545/711 [05:53<01:48,  1.54it/s] 77%|███████▋  | 546/711 [05:54<01:47,  1.54it/s] 77%|███████▋  | 547/711 [05:54<01:46,  1.54it/s] 77%|███████▋  | 548/711 [05:55<01:46,  1.54it/s] 77%|███████▋  | 549/711 [05:56<01:44,  1.55it/s] 77%|███████▋  | 550/711 [05:56<01:43,  1.55it/s] 77%|███████▋  | 551/711 [05:57<01:43,  1.55it/s] 78%|███████▊  | 552/711 [05:58<01:43,  1.54it/s] 78%|███████▊  | 553/711 [05:58<01:42,  1.55it/s] 78%|███████▊  | 554/711 [05:59<01:41,  1.55it/s] 78%|███████▊  | 555/711 [06:00<01:40,  1.55it/s] 78%|███████▊  | 556/711 [06:00<01:40,  1.55it/s] 78%|███████▊  | 557/711 [06:01<01:39,  1.55it/s] 78%|███████▊  | 558/711 [06:02<01:38,  1.56it/s] 79%|███████▊  | 559/711 [06:02<01:37,  1.55it/s] 79%|███████▉  | 560/711 [06:03<01:37,  1.55it/s] 79%|███████▉  | 561/711 [06:03<01:37,  1.55it/s] 79%|███████▉  | 562/711 [06:04<01:36,  1.54it/s] 79%|███████▉  | 563/711 [06:05<01:36,  1.54it/s] 79%|███████▉  | 564/711 [06:05<01:35,  1.53it/s] 79%|███████▉  | 565/711 [06:06<01:34,  1.54it/s] 80%|███████▉  | 566/711 [06:07<01:33,  1.54it/s] 80%|███████▉  | 567/711 [06:07<01:33,  1.54it/s] 80%|███████▉  | 568/711 [06:08<01:32,  1.55it/s] 80%|████████  | 569/711 [06:09<01:31,  1.54it/s] 80%|████████  | 570/711 [06:09<01:31,  1.54it/s] 80%|████████  | 571/711 [06:10<01:30,  1.54it/s] 80%|████████  | 572/711 [06:11<01:30,  1.54it/s] 81%|████████  | 573/711 [06:11<01:29,  1.54it/s] 81%|████████  | 574/711 [06:12<01:29,  1.54it/s] 81%|████████  | 575/711 [06:13<01:28,  1.55it/s] 81%|████████  | 576/711 [06:13<01:27,  1.55it/s] 81%|████████  | 577/711 [06:14<01:26,  1.54it/s] 81%|████████▏ | 578/711 [06:15<01:26,  1.54it/s] 81%|████████▏ | 579/711 [06:15<01:25,  1.54it/s] 82%|████████▏ | 580/711 [06:16<01:25,  1.54it/s] 82%|████████▏ | 581/711 [06:16<01:24,  1.53it/s] 82%|████████▏ | 582/711 [06:17<01:23,  1.54it/s] 82%|████████▏ | 583/711 [06:18<01:22,  1.55it/s] 82%|████████▏ | 584/711 [06:18<01:21,  1.55it/s] 82%|████████▏ | 585/711 [06:19<01:21,  1.55it/s] 82%|████████▏ | 586/711 [06:20<01:21,  1.54it/s] 83%|████████▎ | 587/711 [06:20<01:20,  1.54it/s] 83%|████████▎ | 588/711 [06:21<01:20,  1.53it/s] 83%|████████▎ | 589/711 [06:22<01:19,  1.54it/s] 83%|████████▎ | 590/711 [06:22<01:18,  1.54it/s] 83%|████████▎ | 591/711 [06:23<01:18,  1.54it/s] 83%|████████▎ | 592/711 [06:24<01:17,  1.53it/s] 83%|████████▎ | 593/711 [06:24<01:16,  1.54it/s] 84%|████████▎ | 594/711 [06:25<01:16,  1.54it/s] 84%|████████▎ | 595/711 [06:26<01:15,  1.54it/s] 84%|████████▍ | 596/711 [06:26<01:14,  1.54it/s] 84%|████████▍ | 597/711 [06:27<01:14,  1.54it/s] 84%|████████▍ | 598/711 [06:28<01:13,  1.54it/s] 84%|████████▍ | 599/711 [06:28<01:12,  1.54it/s] 84%|████████▍ | 600/711 [06:29<01:12,  1.54it/s] 85%|████████▍ | 601/711 [06:29<01:11,  1.54it/s] 85%|████████▍ | 602/711 [06:30<01:11,  1.53it/s] 85%|████████▍ | 603/711 [06:31<01:10,  1.54it/s] 85%|████████▍ | 604/711 [06:31<01:09,  1.54it/s] 85%|████████▌ | 605/711 [06:32<01:08,  1.55it/s] 85%|████████▌ | 606/711 [06:33<01:08,  1.54it/s] 85%|████████▌ | 607/711 [06:33<01:07,  1.54it/s] 86%|████████▌ | 608/711 [06:34<01:07,  1.54it/s] 86%|████████▌ | 609/711 [06:35<01:06,  1.54it/s] 86%|████████▌ | 610/711 [06:35<01:06,  1.53it/s] 86%|████████▌ | 611/711 [06:36<01:05,  1.53it/s] 86%|████████▌ | 612/711 [06:37<01:04,  1.53it/s] 86%|████████▌ | 613/711 [06:37<01:03,  1.53it/s] 86%|████████▋ | 614/711 [06:38<01:03,  1.54it/s] 86%|████████▋ | 615/711 [06:39<01:02,  1.54it/s] 87%|████████▋ | 616/711 [06:39<01:01,  1.54it/s] 87%|████████▋ | 617/711 [06:40<01:00,  1.54it/s] 87%|████████▋ | 618/711 [06:41<01:00,  1.54it/s] 87%|████████▋ | 619/711 [06:41<00:59,  1.54it/s] 87%|████████▋ | 620/711 [06:42<00:58,  1.54it/s] 87%|████████▋ | 621/711 [06:42<00:58,  1.54it/s] 87%|████████▋ | 622/711 [06:43<00:57,  1.54it/s] 88%|████████▊ | 623/711 [06:44<00:57,  1.54it/s] 88%|████████▊ | 624/711 [06:44<00:56,  1.53it/s] 88%|████████▊ | 625/711 [06:45<00:56,  1.53it/s] 88%|████████▊ | 626/711 [06:46<00:55,  1.53it/s] 88%|████████▊ | 627/711 [06:46<00:54,  1.54it/s] 88%|████████▊ | 628/711 [06:47<00:54,  1.53it/s] 88%|████████▊ | 629/711 [06:48<00:53,  1.53it/s] 89%|████████▊ | 630/711 [06:48<00:52,  1.53it/s] 89%|████████▊ | 631/711 [06:49<00:52,  1.53it/s] 89%|████████▉ | 632/711 [06:50<00:51,  1.54it/s] 89%|████████▉ | 633/711 [06:50<00:50,  1.54it/s] 89%|████████▉ | 634/711 [06:51<00:49,  1.54it/s] 89%|████████▉ | 635/711 [06:52<00:49,  1.54it/s] 89%|████████▉ | 636/711 [06:52<00:48,  1.54it/s] 90%|████████▉ | 637/711 [06:53<00:47,  1.54it/s] 90%|████████▉ | 638/711 [06:54<00:47,  1.54it/s] 90%|████████▉ | 639/711 [06:54<00:47,  1.52it/s] 90%|█████████ | 640/711 [06:55<00:46,  1.52it/s] 90%|█████████ | 641/711 [06:56<00:45,  1.53it/s] 90%|█████████ | 642/711 [06:56<00:44,  1.53it/s] 90%|█████████ | 643/711 [06:57<00:44,  1.53it/s] 91%|█████████ | 644/711 [06:57<00:43,  1.54it/s] 91%|█████████ | 645/711 [06:58<00:42,  1.55it/s] 91%|█████████ | 646/711 [06:59<00:42,  1.54it/s] 91%|█████████ | 647/711 [06:59<00:41,  1.54it/s] 91%|█████████ | 648/711 [07:00<00:40,  1.55it/s] 91%|█████████▏| 649/711 [07:01<00:39,  1.55it/s] 91%|█████████▏| 650/711 [07:01<00:39,  1.54it/s] 92%|█████████▏| 651/711 [07:02<00:38,  1.54it/s] 92%|█████████▏| 652/711 [07:03<00:38,  1.54it/s] 92%|█████████▏| 653/711 [07:03<00:37,  1.54it/s] 92%|█████████▏| 654/711 [07:04<00:37,  1.54it/s] 92%|█████████▏| 655/711 [07:05<00:36,  1.54it/s] 92%|█████████▏| 656/711 [07:05<00:35,  1.54it/s] 92%|█████████▏| 657/711 [07:06<00:35,  1.54it/s] 93%|█████████▎| 658/711 [07:07<00:34,  1.54it/s] 93%|█████████▎| 659/711 [07:07<00:33,  1.54it/s] 93%|█████████▎| 660/711 [07:08<00:33,  1.53it/s] 93%|█████████▎| 661/711 [07:09<00:32,  1.53it/s] 93%|█████████▎| 662/711 [07:09<00:31,  1.53it/s] 93%|█████████▎| 663/711 [07:10<00:31,  1.53it/s] 93%|█████████▎| 664/711 [07:10<00:30,  1.54it/s] 94%|█████████▎| 665/711 [07:11<00:29,  1.54it/s] 94%|█████████▎| 666/711 [07:12<00:29,  1.54it/s] 94%|█████████▍| 667/711 [07:12<00:28,  1.54it/s] 94%|█████████▍| 668/711 [07:13<00:27,  1.54it/s] 94%|█████████▍| 669/711 [07:14<00:27,  1.54it/s] 94%|█████████▍| 670/711 [07:14<00:26,  1.55it/s] 94%|█████████▍| 671/711 [07:15<00:25,  1.55it/s] 95%|█████████▍| 672/711 [07:16<00:25,  1.54it/s] 95%|█████████▍| 673/711 [07:16<00:24,  1.53it/s] 95%|█████████▍| 674/711 [07:17<00:24,  1.53it/s] 95%|█████████▍| 675/711 [07:18<00:23,  1.54it/s] 95%|█████████▌| 676/711 [07:18<00:22,  1.54it/s] 95%|█████████▌| 677/711 [07:19<00:22,  1.54it/s] 95%|█████████▌| 678/711 [07:20<00:21,  1.54it/s] 95%|█████████▌| 679/711 [07:20<00:20,  1.53it/s] 96%|█████████▌| 680/711 [07:21<00:20,  1.53it/s] 96%|█████████▌| 681/711 [07:22<00:19,  1.53it/s] 96%|█████████▌| 682/711 [07:22<00:18,  1.54it/s] 96%|█████████▌| 683/711 [07:23<00:18,  1.54it/s] 96%|█████████▌| 684/711 [07:23<00:17,  1.54it/s] 96%|█████████▋| 685/711 [07:24<00:16,  1.54it/s] 96%|█████████▋| 686/711 [07:25<00:16,  1.53it/s] 97%|█████████▋| 687/711 [07:25<00:15,  1.54it/s] 97%|█████████▋| 688/711 [07:26<00:14,  1.54it/s] 97%|█████████▋| 689/711 [07:27<00:14,  1.53it/s] 97%|█████████▋| 690/711 [07:27<00:13,  1.54it/s] 97%|█████████▋| 691/711 [07:28<00:12,  1.54it/s] 97%|█████████▋| 692/711 [07:29<00:12,  1.54it/s] 97%|█████████▋| 693/711 [07:29<00:11,  1.54it/s] 98%|█████████▊| 694/711 [07:30<00:11,  1.54it/s] 98%|█████████▊| 695/711 [07:31<00:10,  1.54it/s] 98%|█████████▊| 696/711 [07:31<00:09,  1.54it/s] 98%|█████████▊| 697/711 [07:32<00:09,  1.53it/s] 98%|█████████▊| 698/711 [07:33<00:08,  1.54it/s] 98%|█████████▊| 699/711 [07:33<00:07,  1.53it/s] 98%|█████████▊| 700/711 [07:34<00:07,  1.54it/s] 99%|█████████▊| 701/711 [07:35<00:06,  1.53it/s] 99%|█████████▊| 702/711 [07:35<00:05,  1.54it/s] 99%|█████████▉| 703/711 [07:36<00:05,  1.54it/s] 99%|█████████▉| 704/711 [07:36<00:04,  1.54it/s] 99%|█████████▉| 705/711 [07:37<00:03,  1.54it/s] 99%|█████████▉| 706/711 [07:38<00:03,  1.54it/s] 99%|█████████▉| 707/711 [07:38<00:02,  1.55it/s]100%|█████████▉| 708/711 [07:39<00:01,  1.54it/s]100%|█████████▉| 709/711 [07:40<00:01,  1.54it/s]100%|█████████▉| 710/711 [07:40<00:00,  1.54it/s]100%|██████████| 711/711 [07:41<00:00,  1.53it/s]100%|██████████| 711/711 [07:41<00:00,  1.54it/s]
Computed embeddings shape: torch.Size([5688, 2560])

============================================================
Selected 25 representative images:
============================================================
 1. 1_TCGA-BH-A0BR-01A-02-TSB.c3274f30-ee10-44ef-a781-1441f0a4c659_x_92163_y_2528_a_99.961.png (distance: 19.2656)
 2. 7_TCGA-BH-A0AZ-01A-02-TSB.a9b7b640-d2bb-4e2a-820a-d621212eea2e_x_26016_y_16672_a_99.858.png (distance: 19.5625)
 3. 2_TCGA-B6-A0IG-01A-01-BSA.f4b6e4d4-e56d-479f-8bd9-8be8eca6d7c7_x_113173_y_20914_a_99.925.png (distance: 19.5938)
 4. 7_TCGA-BH-A0GZ-01A-01-TSA.0f63b7d7-9142-4f14-a9fb-8c061a0fa4b8_x_80935_y_42486_a_99.659.png (distance: 19.6094)
 5. 5_TCGA-OL-A66J-01A-01-TSA.E4BF378D-1355-4CA2-B0A5-B6C2290EBFCE_x_25120_y_8704_a_99.686.png (distance: 19.7500)
 6. 0_TCGA-AO-A03V-01A-01-MS1.ade6a103-b697-4730-82f9-4c9ba6eda8a1_x_29072_y_25780_a_100.000.png (distance: 19.9062)
 7. 2_TCGA-AN-A0FW-01A-01-BSA.9f4517b2-d96c-44e4-8b06-2ed4af594385_x_85232_y_22994_a_99.827.png (distance: 20.0156)
 8. 2_TCGA-A2-A0D3-01A-01-TSA.55add6f4-ecd3-4228-af07-045ef5a2cbf6_x_11312_y_14625_a_99.944.png (distance: 20.1094)
 9. 5_TCGA-B6-A0WS-01A-01-MS1.2e7cbe20-6c15-4267-b2fd-f33b1519ced7_x_23952_y_11792_a_99.700.png (distance: 20.1562)
10. 2_TCGA-A7-A0D9-01A-03-BS3.32f8b687-d044-4a69-a179-80ea0ee03c7b_x_12065_y_9504_a_99.892.png (distance: 20.2031)
11. 2_TCGA-A8-A07E-01A-01-TS1.6861c3fd-60df-457a-8d4f-28298d7d15c6_x_77366_y_11264_a_99.929.png (distance: 20.2344)
12. 1_TCGA-A2-A0CQ-01A-02-TSB.9510458b-dc35-43ef-a4ff-684a23bf6b87_x_67651_y_15360_a_99.960.png (distance: 20.2969)
13. 7_TCGA-A2-A0SU-01A-01-BSA.660c932a-61fb-4054-8499-2a39387bf4ab_x_28592_y_32976_a_99.852.png (distance: 20.2969)
14. 1_TCGA-B6-A0WS-01A-01-TS1.13cafabb-f734-4639-9bc5-5d49a6ba33d0_x_50106_y_13584_a_99.897.png (distance: 20.3281)
15. 6_TCGA-A2-A0EU-01A-02-TSB.648d1299-d273-4ae2-8926-cfad39ff735a_x_8704_y_3745_a_99.487.png (distance: 20.3594)
16. 0_TCGA-BH-A0DQ-01A-01-MSA.3e981cdd-f9e6-454a-9746-16e29a072b17_x_87028_y_13650_a_100.000.png (distance: 20.3750)
17. 7_TCGA-BH-A0B4-01A-01-BSA.f2bcfe2d-e385-4d55-989e-9013d4a38230_x_15280_y_8096_a_99.884.png (distance: 20.3906)
18. 7_TCGA-AO-A0JF-01A-01-TSA.8a6d6272-723a-44f5-9682-6aed7f0964f6_x_8208_y_14096_a_99.799.png (distance: 20.4062)
19. 4_TCGA-A2-A0T7-01A-02-BSB.8f69b301-dcf9-4a7f-a504-187f9a11252a_x_75208_y_26512_a_99.892.png (distance: 20.4375)
20. 3_TCGA-BH-A0DX-01A-01-BSA.6a01c1b0-28e9-4d6a-9114-d53b17130c02_x_21920_y_19968_a_99.876.png (distance: 20.4531)
21. 7_TCGA-A7-A0CD-01A-01-TSA.8966c3d7-c0d2-47a4-badf-df9412a1e5f0_x_70801_y_28482_a_99.904.png (distance: 20.4531)
22. 6_TCGA-A8-A099-01A-01-TS1.db6b41ce-27e3-44b2-9c61-6e218f9a75b4_x_113963_y_12016_a_99.850.png (distance: 20.4844)
23. 4_TCGA-BH-A0HQ-01A-01-BSA.4d080ff5-e61d-49e5-ae36-697e5b0ba630_x_167303_y_8224_a_99.949.png (distance: 20.5000)
24. 4_TCGA-BH-A0BR-01A-02-TSB.c3274f30-ee10-44ef-a781-1441f0a4c659_x_31777_y_7616_a_99.842.png (distance: 20.5312)
25. 5_TCGA-BH-A0BT-01A-01-TSA.0d7af972-fe18-47c7-b863-2bb47d611f22_x_26848_y_21666_a_99.790.png (distance: 20.5469)

Saved selected images to selected_images_pam50_label_2.txt
Saved detailed results to selected_images_pam50_label_2_with_distances.json

================================

Selecting representatives for label 3 (lumb)...
Loaded 1864 images from correct_predictions_pam50_label_3.txt
Loading Virchow v2 model...
Computing embeddings for 1864 images...
  0%|          | 0/233 [00:00<?, ?it/s]  0%|          | 1/233 [00:01<04:43,  1.22s/it]  1%|          | 2/233 [00:01<03:24,  1.13it/s]  1%|▏         | 3/233 [00:02<02:58,  1.29it/s]  2%|▏         | 4/233 [00:03<02:46,  1.38it/s]  2%|▏         | 5/233 [00:03<02:38,  1.44it/s]  3%|▎         | 6/233 [00:04<02:34,  1.47it/s]  3%|▎         | 7/233 [00:05<02:30,  1.50it/s]  3%|▎         | 8/233 [00:05<02:29,  1.51it/s]  4%|▍         | 9/233 [00:06<02:27,  1.52it/s]  4%|▍         | 10/233 [00:07<02:26,  1.52it/s]  5%|▍         | 11/233 [00:07<02:25,  1.52it/s]  5%|▌         | 12/233 [00:08<02:24,  1.53it/s]  6%|▌         | 13/233 [00:09<02:23,  1.54it/s]  6%|▌         | 14/233 [00:09<02:21,  1.54it/s]  6%|▋         | 15/233 [00:10<02:21,  1.54it/s]  7%|▋         | 16/233 [00:10<02:20,  1.54it/s]  7%|▋         | 17/233 [00:11<02:20,  1.54it/s]  8%|▊         | 18/233 [00:12<02:20,  1.53it/s]  8%|▊         | 19/233 [00:12<02:19,  1.53it/s]  9%|▊         | 20/233 [00:13<02:19,  1.53it/s]  9%|▉         | 21/233 [00:14<02:18,  1.53it/s]  9%|▉         | 22/233 [00:14<02:18,  1.53it/s] 10%|▉         | 23/233 [00:15<02:16,  1.53it/s] 10%|█         | 24/233 [00:16<02:15,  1.54it/s] 11%|█         | 25/233 [00:16<02:14,  1.55it/s] 11%|█         | 26/233 [00:17<02:13,  1.55it/s] 12%|█▏        | 27/233 [00:18<02:13,  1.55it/s] 12%|█▏        | 28/233 [00:18<02:12,  1.54it/s] 12%|█▏        | 29/233 [00:19<02:12,  1.54it/s] 13%|█▎        | 30/233 [00:20<02:12,  1.54it/s] 13%|█▎        | 31/233 [00:20<02:11,  1.54it/s] 14%|█▎        | 32/233 [00:21<02:10,  1.54it/s] 14%|█▍        | 33/233 [00:22<02:10,  1.53it/s] 15%|█▍        | 34/233 [00:22<02:10,  1.53it/s] 15%|█▌        | 35/233 [00:23<02:08,  1.54it/s] 15%|█▌        | 36/233 [00:23<02:08,  1.53it/s] 16%|█▌        | 37/233 [00:24<02:07,  1.54it/s] 16%|█▋        | 38/233 [00:25<02:06,  1.54it/s] 17%|█▋        | 39/233 [00:25<02:06,  1.53it/s] 17%|█▋        | 40/233 [00:26<02:06,  1.53it/s] 18%|█▊        | 41/233 [00:27<02:05,  1.53it/s] 18%|█▊        | 42/233 [00:27<02:04,  1.53it/s] 18%|█▊        | 43/233 [00:28<02:04,  1.53it/s] 19%|█▉        | 44/233 [00:29<02:03,  1.53it/s] 19%|█▉        | 45/233 [00:29<02:03,  1.53it/s] 20%|█▉        | 46/233 [00:30<02:02,  1.53it/s] 20%|██        | 47/233 [00:31<02:00,  1.54it/s] 21%|██        | 48/233 [00:31<02:00,  1.54it/s] 21%|██        | 49/233 [00:32<01:59,  1.53it/s] 21%|██▏       | 50/233 [00:33<01:59,  1.53it/s] 22%|██▏       | 51/233 [00:33<01:58,  1.54it/s] 22%|██▏       | 52/233 [00:34<01:58,  1.53it/s] 23%|██▎       | 53/233 [00:35<01:57,  1.53it/s] 23%|██▎       | 54/233 [00:35<01:57,  1.53it/s] 24%|██▎       | 55/233 [00:36<01:56,  1.53it/s] 24%|██▍       | 56/233 [00:37<01:55,  1.54it/s] 24%|██▍       | 57/233 [00:37<01:54,  1.53it/s] 25%|██▍       | 58/233 [00:38<01:54,  1.53it/s] 25%|██▌       | 59/233 [00:38<01:53,  1.53it/s] 26%|██▌       | 60/233 [00:39<01:53,  1.53it/s] 26%|██▌       | 61/233 [00:40<01:51,  1.54it/s] 27%|██▋       | 62/233 [00:40<01:50,  1.54it/s] 27%|██▋       | 63/233 [00:41<01:50,  1.54it/s] 27%|██▋       | 64/233 [00:42<01:49,  1.54it/s] 28%|██▊       | 65/233 [00:42<01:49,  1.54it/s] 28%|██▊       | 66/233 [00:43<01:48,  1.54it/s] 29%|██▉       | 67/233 [00:44<01:48,  1.54it/s] 29%|██▉       | 68/233 [00:44<01:47,  1.54it/s] 30%|██▉       | 69/233 [00:45<01:46,  1.54it/s] 30%|███       | 70/233 [00:46<01:45,  1.54it/s] 30%|███       | 71/233 [00:46<01:45,  1.54it/s] 31%|███       | 72/233 [00:47<01:45,  1.53it/s] 31%|███▏      | 73/233 [00:48<01:44,  1.53it/s] 32%|███▏      | 74/233 [00:48<01:43,  1.53it/s] 32%|███▏      | 75/233 [00:49<01:43,  1.53it/s] 33%|███▎      | 76/233 [00:50<01:42,  1.54it/s] 33%|███▎      | 77/233 [00:50<01:41,  1.54it/s] 33%|███▎      | 78/233 [00:51<01:40,  1.54it/s] 34%|███▍      | 79/233 [00:51<01:40,  1.54it/s] 34%|███▍      | 80/233 [00:52<01:39,  1.54it/s] 35%|███▍      | 81/233 [00:53<01:38,  1.54it/s] 35%|███▌      | 82/233 [00:53<01:37,  1.55it/s] 36%|███▌      | 83/233 [00:54<01:36,  1.55it/s] 36%|███▌      | 84/233 [00:55<01:36,  1.54it/s] 36%|███▋      | 85/233 [00:55<01:36,  1.54it/s] 37%|███▋      | 86/233 [00:56<01:35,  1.53it/s] 37%|███▋      | 87/233 [00:57<01:35,  1.53it/s] 38%|███▊      | 88/233 [00:57<01:34,  1.53it/s] 38%|███▊      | 89/233 [00:58<01:33,  1.53it/s] 39%|███▊      | 90/233 [00:59<01:33,  1.54it/s] 39%|███▉      | 91/233 [00:59<01:31,  1.55it/s] 39%|███▉      | 92/233 [01:00<01:31,  1.55it/s] 40%|███▉      | 93/233 [01:01<01:30,  1.54it/s] 40%|████      | 94/233 [01:01<01:30,  1.54it/s] 41%|████      | 95/233 [01:02<01:29,  1.54it/s] 41%|████      | 96/233 [01:03<01:29,  1.54it/s] 42%|████▏     | 97/233 [01:03<01:28,  1.53it/s] 42%|████▏     | 98/233 [01:04<01:28,  1.53it/s] 42%|████▏     | 99/233 [01:04<01:27,  1.54it/s] 43%|████▎     | 100/233 [01:05<01:26,  1.54it/s] 43%|████▎     | 101/233 [01:06<01:26,  1.53it/s] 44%|████▍     | 102/233 [01:06<01:25,  1.54it/s] 44%|████▍     | 103/233 [01:07<01:24,  1.54it/s] 45%|████▍     | 104/233 [01:08<01:24,  1.54it/s] 45%|████▌     | 105/233 [01:08<01:23,  1.54it/s] 45%|████▌     | 106/233 [01:09<01:22,  1.54it/s] 46%|████▌     | 107/233 [01:10<01:21,  1.54it/s] 46%|████▋     | 108/233 [01:10<01:21,  1.53it/s] 47%|████▋     | 109/233 [01:11<01:20,  1.54it/s] 47%|████▋     | 110/233 [01:12<01:20,  1.54it/s] 48%|████▊     | 111/233 [01:12<01:19,  1.53it/s] 48%|████▊     | 112/233 [01:13<01:19,  1.53it/s] 48%|████▊     | 113/233 [01:14<01:18,  1.53it/s] 49%|████▉     | 114/233 [01:14<01:17,  1.53it/s] 49%|████▉     | 115/233 [01:15<01:17,  1.53it/s] 50%|████▉     | 116/233 [01:16<01:16,  1.53it/s] 50%|█████     | 117/233 [01:16<01:15,  1.53it/s] 51%|█████     | 118/233 [01:17<01:15,  1.53it/s] 51%|█████     | 119/233 [01:18<01:14,  1.53it/s] 52%|█████▏    | 120/233 [01:18<01:13,  1.53it/s] 52%|█████▏    | 121/233 [01:19<01:13,  1.53it/s] 52%|█████▏    | 122/233 [01:19<01:12,  1.53it/s] 53%|█████▎    | 123/233 [01:20<01:11,  1.53it/s] 53%|█████▎    | 124/233 [01:21<01:10,  1.55it/s] 54%|█████▎    | 125/233 [01:21<01:10,  1.54it/s] 54%|█████▍    | 126/233 [01:22<01:09,  1.54it/s] 55%|█████▍    | 127/233 [01:23<01:08,  1.54it/s] 55%|█████▍    | 128/233 [01:23<01:08,  1.54it/s] 55%|█████▌    | 129/233 [01:24<01:07,  1.54it/s] 56%|█████▌    | 130/233 [01:25<01:07,  1.54it/s] 56%|█████▌    | 131/233 [01:25<01:06,  1.53it/s] 57%|█████▋    | 132/233 [01:26<01:05,  1.53it/s] 57%|█████▋    | 133/233 [01:27<01:05,  1.53it/s] 58%|█████▊    | 134/233 [01:27<01:04,  1.53it/s] 58%|█████▊    | 135/233 [01:28<01:04,  1.53it/s] 58%|█████▊    | 136/233 [01:29<01:03,  1.54it/s] 59%|█████▉    | 137/233 [01:29<01:02,  1.54it/s] 59%|█████▉    | 138/233 [01:30<01:01,  1.54it/s] 60%|█████▉    | 139/233 [01:31<01:01,  1.53it/s] 60%|██████    | 140/233 [01:31<01:00,  1.53it/s] 61%|██████    | 141/233 [01:32<00:59,  1.53it/s] 61%|██████    | 142/233 [01:32<00:59,  1.53it/s] 61%|██████▏   | 143/233 [01:33<00:58,  1.53it/s] 62%|██████▏   | 144/233 [01:34<00:57,  1.54it/s] 62%|██████▏   | 145/233 [01:34<00:57,  1.53it/s] 63%|██████▎   | 146/233 [01:35<00:56,  1.53it/s] 63%|██████▎   | 147/233 [01:36<00:56,  1.53it/s] 64%|██████▎   | 148/233 [01:36<00:55,  1.54it/s] 64%|██████▍   | 149/233 [01:37<00:54,  1.54it/s] 64%|██████▍   | 150/233 [01:38<00:53,  1.54it/s] 65%|██████▍   | 151/233 [01:38<00:53,  1.53it/s] 65%|██████▌   | 152/233 [01:39<00:52,  1.54it/s] 66%|██████▌   | 153/233 [01:40<00:51,  1.54it/s] 66%|██████▌   | 154/233 [01:40<00:51,  1.54it/s] 67%|██████▋   | 155/233 [01:41<00:50,  1.53it/s] 67%|██████▋   | 156/233 [01:42<00:50,  1.53it/s] 67%|██████▋   | 157/233 [01:42<00:49,  1.54it/s] 68%|██████▊   | 158/233 [01:43<00:48,  1.55it/s] 68%|██████▊   | 159/233 [01:44<00:48,  1.54it/s] 69%|██████▊   | 160/233 [01:44<00:47,  1.54it/s] 69%|██████▉   | 161/233 [01:45<00:46,  1.54it/s] 70%|██████▉   | 162/233 [01:46<00:46,  1.54it/s] 70%|██████▉   | 163/233 [01:46<00:46,  1.52it/s] 70%|███████   | 164/233 [01:47<00:45,  1.53it/s] 71%|███████   | 165/233 [01:47<00:44,  1.53it/s] 71%|███████   | 166/233 [01:48<00:43,  1.53it/s] 72%|███████▏  | 167/233 [01:49<00:43,  1.53it/s] 72%|███████▏  | 168/233 [01:49<00:42,  1.54it/s] 73%|███████▎  | 169/233 [01:50<00:41,  1.54it/s] 73%|███████▎  | 170/233 [01:51<00:41,  1.54it/s] 73%|███████▎  | 171/233 [01:51<00:40,  1.53it/s] 74%|███████▍  | 172/233 [01:52<00:39,  1.53it/s] 74%|███████▍  | 173/233 [01:53<00:39,  1.53it/s] 75%|███████▍  | 174/233 [01:53<00:38,  1.53it/s] 75%|███████▌  | 175/233 [01:54<00:37,  1.53it/s] 76%|███████▌  | 176/233 [01:55<00:37,  1.53it/s] 76%|███████▌  | 177/233 [01:55<00:36,  1.53it/s] 76%|███████▋  | 178/233 [01:56<00:35,  1.53it/s] 77%|███████▋  | 179/233 [01:57<00:35,  1.54it/s] 77%|███████▋  | 180/233 [01:57<00:34,  1.54it/s] 78%|███████▊  | 181/233 [01:58<00:33,  1.53it/s] 78%|███████▊  | 182/233 [01:59<00:33,  1.53it/s] 79%|███████▊  | 183/233 [01:59<00:32,  1.53it/s] 79%|███████▉  | 184/233 [02:00<00:32,  1.53it/s] 79%|███████▉  | 185/233 [02:01<00:31,  1.53it/s] 80%|███████▉  | 186/233 [02:01<00:30,  1.53it/s] 80%|████████  | 187/233 [02:02<00:30,  1.53it/s] 81%|████████  | 188/233 [02:02<00:29,  1.53it/s] 81%|████████  | 189/233 [02:03<00:28,  1.53it/s] 82%|████████▏ | 190/233 [02:04<00:28,  1.53it/s] 82%|████████▏ | 191/233 [02:04<00:27,  1.53it/s] 82%|████████▏ | 192/233 [02:05<00:26,  1.53it/s] 83%|████████▎ | 193/233 [02:06<00:26,  1.53it/s] 83%|████████▎ | 194/233 [02:06<00:25,  1.54it/s] 84%|████████▎ | 195/233 [02:07<00:24,  1.53it/s] 84%|████████▍ | 196/233 [02:08<00:24,  1.53it/s] 85%|████████▍ | 197/233 [02:08<00:23,  1.53it/s] 85%|████████▍ | 198/233 [02:09<00:22,  1.53it/s] 85%|████████▌ | 199/233 [02:10<00:22,  1.53it/s] 86%|████████▌ | 200/233 [02:10<00:21,  1.53it/s] 86%|████████▋ | 201/233 [02:11<00:20,  1.53it/s] 87%|████████▋ | 202/233 [02:12<00:20,  1.53it/s] 87%|████████▋ | 203/233 [02:12<00:19,  1.53it/s] 88%|████████▊ | 204/233 [02:13<00:18,  1.53it/s] 88%|████████▊ | 205/233 [02:14<00:18,  1.53it/s] 88%|████████▊ | 206/233 [02:14<00:17,  1.53it/s] 89%|████████▉ | 207/233 [02:15<00:16,  1.53it/s] 89%|████████▉ | 208/233 [02:16<00:16,  1.53it/s] 90%|████████▉ | 209/233 [02:16<00:15,  1.53it/s] 90%|█████████ | 210/233 [02:17<00:15,  1.53it/s] 91%|█████████ | 211/233 [02:18<00:14,  1.53it/s] 91%|█████████ | 212/233 [02:18<00:13,  1.53it/s] 91%|█████████▏| 213/233 [02:19<00:13,  1.53it/s] 92%|█████████▏| 214/233 [02:19<00:12,  1.53it/s] 92%|█████████▏| 215/233 [02:20<00:11,  1.53it/s] 93%|█████████▎| 216/233 [02:21<00:11,  1.53it/s] 93%|█████████▎| 217/233 [02:21<00:10,  1.53it/s] 94%|█████████▎| 218/233 [02:22<00:09,  1.53it/s] 94%|█████████▍| 219/233 [02:23<00:09,  1.54it/s] 94%|█████████▍| 220/233 [02:23<00:08,  1.54it/s] 95%|█████████▍| 221/233 [02:24<00:07,  1.54it/s] 95%|█████████▌| 222/233 [02:25<00:07,  1.53it/s] 96%|█████████▌| 223/233 [02:25<00:06,  1.54it/s] 96%|█████████▌| 224/233 [02:26<00:05,  1.54it/s] 97%|█████████▋| 225/233 [02:27<00:05,  1.55it/s] 97%|█████████▋| 226/233 [02:27<00:04,  1.54it/s] 97%|█████████▋| 227/233 [02:28<00:03,  1.54it/s] 98%|█████████▊| 228/233 [02:29<00:03,  1.54it/s] 98%|█████████▊| 229/233 [02:29<00:02,  1.54it/s] 99%|█████████▊| 230/233 [02:30<00:01,  1.54it/s] 99%|█████████▉| 231/233 [02:31<00:01,  1.54it/s]100%|█████████▉| 232/233 [02:31<00:00,  1.54it/s]100%|██████████| 233/233 [02:32<00:00,  1.54it/s]100%|██████████| 233/233 [02:32<00:00,  1.53it/s]
Computed embeddings shape: torch.Size([1864, 2560])

============================================================
Selected 25 representative images:
============================================================
 1. 0_TCGA-B6-A0IB-01A-01-TSA.67edd3f0-b36e-427c-b8ec-4e527de67414_x_8592_y_10096_a_100.000.png (distance: 20.8281)
 2. 0_TCGA-C8-A12U-01A-01-TSA.46d73ab3-ab0b-4739-aabc-3a678d422419_x_77240_y_22464_a_100.000.png (distance: 20.8438)
 3. 7_TCGA-E2-A14S-01A-01-TSA.34b0dc8d-f4f4-4f51-ad17-794e6a10fedc_x_67830_y_13713_a_99.533.png (distance: 21.4375)
 4. 5_TCGA-A2-A0SW-01A-01-BSA.7a710f66-502f-43fa-94eb-742243cf2aff_x_62745_y_19616_a_99.548.png (distance: 21.4375)
 5. 7_TCGA-AN-A0AK-01A-02-TSB.7d73ccfb-c2b8-4836-a414-6cba51801984_x_4080_y_16945_a_99.738.png (distance: 21.5156)
 6. 7_TCGA-BH-A0BZ-01A-03-BSC.875682e9-3d99-4189-8ad1-f1e4e4bb7610_x_82996_y_14144_a_99.900.png (distance: 21.5625)
 7. 0_TCGA-B6-A0RL-01A-01-TSA.497a08d0-67ef-4486-abf0-8d04b713d770_x_84649_y_9504_a_100.000.png (distance: 21.5625)
 8. 7_TCGA-AR-A250-01A-03-TSC.ac0f9192-2961-470c-9fe6-fd72f7f07d0c_x_11440_y_17584_a_99.713.png (distance: 21.7031)
 9. 7_TCGA-E2-A109-01A-01-TSA.21eaebd6-c736-452d-96ea-60ecdbd07764_x_49747_y_18433_a_99.635.png (distance: 21.7812)
10. 4_TCGA-B6-A0IB-01A-01-TSA.67edd3f0-b36e-427c-b8ec-4e527de67414_x_7568_y_11632_a_99.662.png (distance: 21.7969)
11. 3_TCGA-E2-A15A-01A-01-TS1.12b3eabe-32d3-4772-8337-e4ae024911bb_x_84611_y_14016_a_99.872.png (distance: 21.8438)
12. 3_TCGA-BH-A0BZ-01A-03-BSC.875682e9-3d99-4189-8ad1-f1e4e4bb7610_x_88628_y_21312_a_99.957.png (distance: 21.8750)
13. 5_TCGA-EW-A6SA-01A-02-TS2.F8EDBB12-CB23-4661-A860-0AFEA6760BEF_x_101428_y_15360_a_99.817.png (distance: 21.9375)
14. 6_TCGA-A8-A084-01A-02-MS2.20452f22-4c24-488f-a8e5-e7594579888c_x_88976_y_11200_a_99.895.png (distance: 21.9531)
15. 2_TCGA-C8-A130-01A-03-BSC.f362f3af-a66f-4a3b-a3cc-3768a59602f3_x_71220_y_17186_a_99.919.png (distance: 21.9688)
16. 0_TCGA-BH-A0BZ-01A-03-BSC.875682e9-3d99-4189-8ad1-f1e4e4bb7610_x_85556_y_17216_a_100.000.png (distance: 22.0000)
17. 0_TCGA-A8-A079-01A-02-BS2.af4b2721-1e8c-4b61-b03f-1a50c2366832_x_8464_y_2560_a_100.000.png (distance: 22.0938)
18. 2_TCGA-E2-A15A-06A-01-TS1.bc17c613-409e-4308-beae-d7dea1493c10_x_63300_y_19153_a_99.943.png (distance: 22.1562)
19. 6_TCGA-A8-A06R-01A-01-BS1.81f34f39-e1c2-4769-aaa3-5aa5df1c3543_x_15712_y_20387_a_99.875.png (distance: 22.1719)
20. 4_TCGA-S3-A6ZF-01A-03-TS3.2DE8CF7F-0109-42C3-8C05-4D708BBE19F6_x_6240_y_6370_a_99.190.png (distance: 22.2031)
21. 5_TCGA-AN-A0AK-01A-02-TSB.7d73ccfb-c2b8-4836-a414-6cba51801984_x_54038_y_18723_a_99.813.png (distance: 22.2344)
22. 1_TCGA-A8-A06R-01A-01-BS1.81f34f39-e1c2-4769-aaa3-5aa5df1c3543_x_33632_y_24483_a_99.979.png (distance: 22.2500)
23. 6_TCGA-BH-A18L-01A-03-TSC.6bf9df68-0928-475d-89d6-2d92223306f7_x_16992_y_20257_a_99.794.png (distance: 22.2656)
24. 5_TCGA-A8-A09I-01A-02-BS2.ca9aacf2-573b-4af2-bc50-5213526eb3a3_x_17616_y_34608_a_99.692.png (distance: 22.2812)
25. 3_TCGA-A8-A084-01A-02-MS2.20452f22-4c24-488f-a8e5-e7594579888c_x_97168_y_14272_a_99.947.png (distance: 22.3125)

Saved selected images to selected_images_pam50_label_3.txt
Saved detailed results to selected_images_pam50_label_3_with_distances.json

================================

Selecting representatives for label 4 (normal)...
Loaded 192 images from correct_predictions_pam50_label_4.txt
Loading Virchow v2 model...
Computing embeddings for 192 images...
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:01<00:28,  1.23s/it]  8%|▊         | 2/24 [00:01<00:19,  1.12it/s] 12%|█▎        | 3/24 [00:02<00:16,  1.28it/s] 17%|█▋        | 4/24 [00:03<00:14,  1.37it/s] 21%|██        | 5/24 [00:03<00:13,  1.43it/s] 25%|██▌       | 6/24 [00:04<00:12,  1.46it/s] 29%|██▉       | 7/24 [00:05<00:11,  1.48it/s] 33%|███▎      | 8/24 [00:05<00:10,  1.50it/s] 38%|███▊      | 9/24 [00:06<00:09,  1.52it/s] 42%|████▏     | 10/24 [00:07<00:09,  1.52it/s] 46%|████▌     | 11/24 [00:07<00:08,  1.52it/s] 50%|█████     | 12/24 [00:08<00:07,  1.52it/s] 54%|█████▍    | 13/24 [00:09<00:07,  1.53it/s] 58%|█████▊    | 14/24 [00:09<00:06,  1.53it/s] 62%|██████▎   | 15/24 [00:10<00:05,  1.53it/s] 67%|██████▋   | 16/24 [00:11<00:05,  1.53it/s] 71%|███████   | 17/24 [00:11<00:04,  1.53it/s] 75%|███████▌  | 18/24 [00:12<00:03,  1.53it/s] 79%|███████▉  | 19/24 [00:12<00:03,  1.53it/s] 83%|████████▎ | 20/24 [00:13<00:02,  1.54it/s] 88%|████████▊ | 21/24 [00:14<00:01,  1.54it/s] 92%|█████████▏| 22/24 [00:14<00:01,  1.54it/s] 96%|█████████▌| 23/24 [00:15<00:00,  1.54it/s]100%|██████████| 24/24 [00:16<00:00,  1.54it/s]100%|██████████| 24/24 [00:16<00:00,  1.48it/s]
Computed embeddings shape: torch.Size([192, 2560])

============================================================
Selected 25 representative images:
============================================================
 1. 5_TCGA-A2-A0CZ-01A-01-BS1.792ef70c-5f29-44df-8d18-0b54697b2cca_x_5552_y_26512_a_99.912.png (distance: 19.6719)
 2. 0_TCGA-A2-A1G6-01A-01-TSA.da860c75-25a5-4542-b546-e14c8beb8649_x_11824_y_7312_a_100.000.png (distance: 20.9219)
 3. 1_TCGA-BH-A28O-01A-01-MS1.B25C7456-CDA1-4989-97F6-13B9AB7D3688_x_89892_y_1488_a_99.976.png (distance: 20.9688)
 4. 1_TCGA-A2-A0CZ-01A-01-BS1.792ef70c-5f29-44df-8d18-0b54697b2cca_x_5552_y_24976_a_99.982.png (distance: 21.0938)
 5. 4_TCGA-B6-A0RQ-01A-01-TSA.bae984a1-d15c-4c22-a9dd-057fd2d6da04_x_74919_y_13280_a_99.900.png (distance: 21.7656)
 6. 7_TCGA-AO-A0JB-01A-01-BSA.705ff788-9aea-491f-8eb4-d19e21c984ba_x_8512_y_5408_a_99.871.png (distance: 21.8906)
 7. 0_TCGA-EW-A1P1-01A-03-TSC.8fd02727-ac5a-449b-9cd7-628e3dda1c3c_x_22192_y_12224_a_100.000.png (distance: 22.0000)
 8. 4_TCGA-PL-A8LY-01A-02-DX2.6F9520F1-3210-4A96-81C2-A14424F650D1_x_16544_y_8544_a_99.720.png (distance: 22.0625)
 9. 1_TCGA-B6-A0RQ-01A-01-BSA.47ecd2ab-489d-4880-85b5-c718d4ceb477_x_9744_y_11440_a_99.950.png (distance: 22.1562)
10. 5_TCGA-BH-A28O-01A-01-MS1.B25C7456-CDA1-4989-97F6-13B9AB7D3688_x_23904_y_15425_a_99.882.png (distance: 22.5781)
11. 0_TCGA-PL-A8LY-01A-01-DX1.32047D5E-8A42-480A-B2B8-A56B47B949FD_x_12384_y_8931_a_100.000.png (distance: 22.7031)
12. 7_TCGA-A2-A0CZ-01A-01-BS1.792ef70c-5f29-44df-8d18-0b54697b2cca_x_5552_y_26000_a_99.877.png (distance: 22.8125)
13. 1_TCGA-EW-A1P7-01A-02-TSB.5628be59-b3f9-493a-9e68-053187bbb7d3_x_49973_y_12209_a_99.925.png (distance: 22.8906)
14. 6_TCGA-AO-A0JB-01A-01-BSA.705ff788-9aea-491f-8eb4-d19e21c984ba_x_8512_y_4896_a_99.889.png (distance: 23.1406)
15. 0_TCGA-B6-A0RQ-01A-01-TSA.bae984a1-d15c-4c22-a9dd-057fd2d6da04_x_19488_y_22640_a_100.000.png (distance: 23.2031)
16. 0_TCGA-B6-A0RQ-01A-01-BSA.47ecd2ab-489d-4880-85b5-c718d4ceb477_x_77157_y_25874_a_100.000.png (distance: 23.4844)
17. 7_TCGA-A2-A0CZ-01A-01-TS1.ad515c60-a532-4cab-ac6d-6bbdd877683b_x_6176_y_24576_a_99.847.png (distance: 23.7812)
18. 5_TCGA-PL-A8LY-01A-02-DX2.6F9520F1-3210-4A96-81C2-A14424F650D1_x_70901_y_10928_a_99.650.png (distance: 23.9062)
19. 3_TCGA-A2-A0CZ-01A-01-BS1.792ef70c-5f29-44df-8d18-0b54697b2cca_x_8624_y_23952_a_99.947.png (distance: 24.2969)
20. 3_TCGA-B6-A0RQ-01A-01-BSA.47ecd2ab-489d-4880-85b5-c718d4ceb477_x_77669_y_22290_a_99.851.png (distance: 24.3594)
21. 3_TCGA-A2-A0CZ-01A-01-TS1.ad515c60-a532-4cab-ac6d-6bbdd877683b_x_82578_y_9632_a_99.934.png (distance: 24.4688)
22. 7_TCGA-AC-A2FK-01A-01-TS1.807C5D36-7171-495C-B6AB-8951B77EAD21_x_5520_y_20784_a_99.806.png (distance: 24.4688)
23. 6_TCGA-PL-A8LY-01A-02-DX2.6F9520F1-3210-4A96-81C2-A14424F650D1_x_69877_y_12464_a_99.580.png (distance: 24.5469)
24. 2_TCGA-AO-A1KO-01A-03-TSC.4226d4b4-f783-41d6-ba0e-ee74719cb152_x_72853_y_19489_a_99.866.png (distance: 24.7031)
25. 0_TCGA-PL-A8LY-01A-02-DX2.6F9520F1-3210-4A96-81C2-A14424F650D1_x_8352_y_12640_a_100.000.png (distance: 24.8594)

Saved selected images to selected_images_pam50_label_4.txt
Saved detailed results to selected_images_pam50_label_4_with_distances.json

Done! PAM50 results saved to:
  - selected_images_pam50_label_0.txt (basal)
  - selected_images_pam50_label_1.txt (her2)
  - selected_images_pam50_label_2.txt (luma)
  - selected_images_pam50_label_3.txt (lumb)
  - selected_images_pam50_label_4.txt (normal)
