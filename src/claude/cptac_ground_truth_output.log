===================================
Processing by GROUND TRUTH labels
Database: cptac
===================================

Processing ER dataset...
Found 4 label directories
Loaded CSV with 379 entries
Created label mapping for 379 slide IDs

Scanning directory: data/histomorfologico/cptac/er/label_negative_pred_1
  Found 808 images

Scanning directory: data/histomorfologico/cptac/er/label_positive_pred_1
  Found 1800 images

Scanning directory: data/histomorfologico/cptac/er/label_positive_pred_0
  Found 80 images

Scanning directory: data/histomorfologico/cptac/er/label_negative_pred_0
  Found 344 images

============================================================
Images grouped by ground truth label:
  negative: 1152 images
  positive: 1880 images
Total images: 3032
Not found in CSV: 0
============================================================

Loading Virchow v2 model...

============================================================
Processing label: negative
Total images: 1152
============================================================

Computing embeddings for 808 images from data/histomorfologico/cptac/er/label_negative_pred_1...
Computing embeddings:   0%|          | 0/101 [00:00<?, ?it/s]Computing embeddings:   1%|          | 1/101 [00:00<00:57,  1.73it/s]Computing embeddings:   2%|▏         | 2/101 [00:00<00:40,  2.44it/s]Computing embeddings:   3%|▎         | 3/101 [00:01<00:34,  2.82it/s]Computing embeddings:   4%|▍         | 4/101 [00:01<00:31,  3.04it/s]Computing embeddings:   5%|▍         | 5/101 [00:01<00:30,  3.17it/s]Computing embeddings:   6%|▌         | 6/101 [00:02<00:28,  3.28it/s]Computing embeddings:   7%|▋         | 7/101 [00:02<00:28,  3.33it/s]Computing embeddings:   8%|▊         | 8/101 [00:02<00:27,  3.39it/s]Computing embeddings:   9%|▉         | 9/101 [00:02<00:26,  3.43it/s]Computing embeddings:  10%|▉         | 10/101 [00:03<00:26,  3.46it/s]Computing embeddings:  11%|█         | 11/101 [00:03<00:25,  3.48it/s]Computing embeddings:  12%|█▏        | 12/101 [00:03<00:26,  3.42it/s]Computing embeddings:  13%|█▎        | 13/101 [00:04<00:25,  3.44it/s]Computing embeddings:  14%|█▍        | 14/101 [00:04<00:25,  3.45it/s]Computing embeddings:  15%|█▍        | 15/101 [00:04<00:24,  3.45it/s]Computing embeddings:  16%|█▌        | 16/101 [00:04<00:24,  3.46it/s]Computing embeddings:  17%|█▋        | 17/101 [00:05<00:24,  3.39it/s]Computing embeddings:  18%|█▊        | 18/101 [00:05<00:24,  3.40it/s]Computing embeddings:  19%|█▉        | 19/101 [00:05<00:24,  3.32it/s]Computing embeddings:  20%|█▉        | 20/101 [00:06<00:24,  3.36it/s]Computing embeddings:  21%|██        | 21/101 [00:06<00:23,  3.38it/s]Computing embeddings:  22%|██▏       | 22/101 [00:06<00:23,  3.41it/s]Computing embeddings:  23%|██▎       | 23/101 [00:06<00:22,  3.43it/s]Computing embeddings:  24%|██▍       | 24/101 [00:07<00:22,  3.46it/s]Computing embeddings:  25%|██▍       | 25/101 [00:07<00:21,  3.46it/s]Computing embeddings:  26%|██▌       | 26/101 [00:07<00:21,  3.48it/s]Computing embeddings:  27%|██▋       | 27/101 [00:08<00:21,  3.48it/s]Computing embeddings:  28%|██▊       | 28/101 [00:08<00:21,  3.47it/s]Computing embeddings:  29%|██▊       | 29/101 [00:08<00:20,  3.48it/s]Computing embeddings:  30%|██▉       | 30/101 [00:08<00:20,  3.48it/s]Computing embeddings:  31%|███       | 31/101 [00:09<00:20,  3.39it/s]Computing embeddings:  32%|███▏      | 32/101 [00:09<00:20,  3.41it/s]Computing embeddings:  33%|███▎      | 33/101 [00:09<00:20,  3.37it/s]Computing embeddings:  34%|███▎      | 34/101 [00:10<00:19,  3.38it/s]Computing embeddings:  35%|███▍      | 35/101 [00:10<00:19,  3.34it/s]Computing embeddings:  36%|███▌      | 36/101 [00:10<00:19,  3.32it/s]Computing embeddings:  37%|███▋      | 37/101 [00:11<00:19,  3.36it/s]Computing embeddings:  38%|███▊      | 38/101 [00:11<00:18,  3.38it/s]Computing embeddings:  39%|███▊      | 39/101 [00:11<00:18,  3.39it/s]Computing embeddings:  40%|███▉      | 40/101 [00:11<00:18,  3.38it/s]Computing embeddings:  41%|████      | 41/101 [00:12<00:17,  3.36it/s]Computing embeddings:  42%|████▏     | 42/101 [00:12<00:17,  3.36it/s]Computing embeddings:  43%|████▎     | 43/101 [00:12<00:17,  3.36it/s]Computing embeddings:  44%|████▎     | 44/101 [00:13<00:16,  3.36it/s]Computing embeddings:  45%|████▍     | 45/101 [00:13<00:16,  3.35it/s]Computing embeddings:  46%|████▌     | 46/101 [00:13<00:16,  3.34it/s]Computing embeddings:  47%|████▋     | 47/101 [00:14<00:16,  3.29it/s]Computing embeddings:  48%|████▊     | 48/101 [00:14<00:15,  3.32it/s]Computing embeddings:  49%|████▊     | 49/101 [00:14<00:15,  3.31it/s]Computing embeddings:  50%|████▉     | 50/101 [00:14<00:15,  3.26it/s]Computing embeddings:  50%|█████     | 51/101 [00:15<00:15,  3.31it/s]Computing embeddings:  51%|█████▏    | 52/101 [00:15<00:14,  3.32it/s]Computing embeddings:  52%|█████▏    | 53/101 [00:15<00:14,  3.31it/s]Computing embeddings:  53%|█████▎    | 54/101 [00:16<00:14,  3.32it/s]Computing embeddings:  54%|█████▍    | 55/101 [00:16<00:13,  3.33it/s]Computing embeddings:  55%|█████▌    | 56/101 [00:16<00:13,  3.33it/s]Computing embeddings:  56%|█████▋    | 57/101 [00:17<00:13,  3.33it/s]Computing embeddings:  57%|█████▋    | 58/101 [00:17<00:12,  3.36it/s]Computing embeddings:  58%|█████▊    | 59/101 [00:17<00:12,  3.35it/s]Computing embeddings:  59%|█████▉    | 60/101 [00:17<00:12,  3.36it/s]Computing embeddings:  60%|██████    | 61/101 [00:18<00:11,  3.37it/s]Computing embeddings:  61%|██████▏   | 62/101 [00:18<00:11,  3.36it/s]Computing embeddings:  62%|██████▏   | 63/101 [00:18<00:11,  3.36it/s]Computing embeddings:  63%|██████▎   | 64/101 [00:19<00:10,  3.38it/s]Computing embeddings:  64%|██████▍   | 65/101 [00:19<00:10,  3.38it/s]Computing embeddings:  65%|██████▌   | 66/101 [00:19<00:10,  3.33it/s]Computing embeddings:  66%|██████▋   | 67/101 [00:20<00:10,  3.30it/s]Computing embeddings:  67%|██████▋   | 68/101 [00:20<00:09,  3.33it/s]Computing embeddings:  68%|██████▊   | 69/101 [00:20<00:09,  3.27it/s]Computing embeddings:  69%|██████▉   | 70/101 [00:20<00:09,  3.29it/s]Computing embeddings:  70%|███████   | 71/101 [00:21<00:09,  3.31it/s]Computing embeddings:  71%|███████▏  | 72/101 [00:21<00:08,  3.34it/s]Computing embeddings:  72%|███████▏  | 73/101 [00:21<00:08,  3.35it/s]Computing embeddings:  73%|███████▎  | 74/101 [00:22<00:08,  3.31it/s]Computing embeddings:  74%|███████▍  | 75/101 [00:22<00:07,  3.31it/s]Computing embeddings:  75%|███████▌  | 76/101 [00:22<00:07,  3.32it/s]Computing embeddings:  76%|███████▌  | 77/101 [00:23<00:07,  3.33it/s]Computing embeddings:  77%|███████▋  | 78/101 [00:23<00:06,  3.36it/s]Computing embeddings:  78%|███████▊  | 79/101 [00:23<00:06,  3.35it/s]Computing embeddings:  79%|███████▉  | 80/101 [00:23<00:06,  3.37it/s]Computing embeddings:  80%|████████  | 81/101 [00:24<00:05,  3.33it/s]Computing embeddings:  81%|████████  | 82/101 [00:24<00:05,  3.32it/s]Computing embeddings:  82%|████████▏ | 83/101 [00:24<00:05,  3.28it/s]Computing embeddings:  83%|████████▎ | 84/101 [00:25<00:05,  3.27it/s]Computing embeddings:  84%|████████▍ | 85/101 [00:25<00:04,  3.24it/s]Computing embeddings:  85%|████████▌ | 86/101 [00:25<00:04,  3.24it/s]Computing embeddings:  86%|████████▌ | 87/101 [00:26<00:04,  3.21it/s]Computing embeddings:  87%|████████▋ | 88/101 [00:26<00:04,  3.18it/s]Computing embeddings:  88%|████████▊ | 89/101 [00:26<00:03,  3.14it/s]Computing embeddings:  89%|████████▉ | 90/101 [00:27<00:03,  3.09it/s]Computing embeddings:  90%|█████████ | 91/101 [00:27<00:03,  3.01it/s]Computing embeddings:  91%|█████████ | 92/101 [00:27<00:03,  2.97it/s]Computing embeddings:  92%|█████████▏| 93/101 [00:28<00:02,  2.97it/s]Computing embeddings:  93%|█████████▎| 94/101 [00:28<00:02,  2.97it/s]Computing embeddings:  94%|█████████▍| 95/101 [00:28<00:02,  2.92it/s]Computing embeddings:  95%|█████████▌| 96/101 [00:29<00:01,  2.83it/s]Computing embeddings:  96%|█████████▌| 97/101 [00:29<00:01,  2.80it/s]Computing embeddings:  97%|█████████▋| 98/101 [00:29<00:01,  2.78it/s]Computing embeddings:  98%|█████████▊| 99/101 [00:30<00:00,  2.86it/s]Computing embeddings:  99%|█████████▉| 100/101 [00:30<00:00,  2.83it/s]Computing embeddings: 100%|██████████| 101/101 [00:31<00:00,  2.76it/s]Computing embeddings: 100%|██████████| 101/101 [00:31<00:00,  3.25it/s]

Computing embeddings for 344 images from data/histomorfologico/cptac/er/label_negative_pred_0...
Computing embeddings:   0%|          | 0/43 [00:00<?, ?it/s]Computing embeddings:   2%|▏         | 1/43 [00:00<00:16,  2.48it/s]Computing embeddings:   5%|▍         | 2/43 [00:00<00:17,  2.35it/s]Computing embeddings:   7%|▋         | 3/43 [00:01<00:18,  2.15it/s]Computing embeddings:   9%|▉         | 4/43 [00:01<00:18,  2.05it/s]Computing embeddings:  12%|█▏        | 5/43 [00:02<00:18,  2.01it/s]Computing embeddings:  14%|█▍        | 6/43 [00:02<00:18,  1.99it/s]Computing embeddings:  16%|█▋        | 7/43 [00:03<00:18,  1.97it/s]Computing embeddings:  19%|█▊        | 8/43 [00:03<00:17,  1.96it/s]Computing embeddings:  21%|██        | 9/43 [00:04<00:17,  1.96it/s]Computing embeddings:  23%|██▎       | 10/43 [00:05<00:17,  1.91it/s]Computing embeddings:  26%|██▌       | 11/43 [00:05<00:17,  1.85it/s]Computing embeddings:  28%|██▊       | 12/43 [00:06<00:16,  1.82it/s]Computing embeddings:  30%|███       | 13/43 [00:06<00:16,  1.80it/s]Computing embeddings:  33%|███▎      | 14/43 [00:07<00:16,  1.79it/s]Computing embeddings:  35%|███▍      | 15/43 [00:07<00:15,  1.77it/s]Computing embeddings:  37%|███▋      | 16/43 [00:08<00:15,  1.76it/s]Computing embeddings:  40%|███▉      | 17/43 [00:09<00:14,  1.75it/s]Computing embeddings:  42%|████▏     | 18/43 [00:09<00:14,  1.75it/s]Computing embeddings:  44%|████▍     | 19/43 [00:09<00:12,  1.94it/s]Computing embeddings:  47%|████▋     | 20/43 [00:10<00:11,  2.06it/s]Computing embeddings:  49%|████▉     | 21/43 [00:10<00:10,  2.10it/s]Computing embeddings:  51%|█████     | 22/43 [00:11<00:10,  1.98it/s]Computing embeddings:  53%|█████▎    | 23/43 [00:12<00:10,  1.83it/s]Computing embeddings:  56%|█████▌    | 24/43 [00:12<00:10,  1.75it/s]Computing embeddings:  58%|█████▊    | 25/43 [00:13<00:10,  1.70it/s]Computing embeddings:  60%|██████    | 26/43 [00:13<00:10,  1.66it/s]Computing embeddings:  63%|██████▎   | 27/43 [00:14<00:09,  1.65it/s]Computing embeddings:  65%|██████▌   | 28/43 [00:15<00:09,  1.63it/s]Computing embeddings:  67%|██████▋   | 29/43 [00:15<00:08,  1.63it/s]Computing embeddings:  70%|██████▉   | 30/43 [00:16<00:08,  1.61it/s]Computing embeddings:  72%|███████▏  | 31/43 [00:17<00:07,  1.60it/s]Computing embeddings:  74%|███████▍  | 32/43 [00:17<00:06,  1.59it/s]Computing embeddings:  77%|███████▋  | 33/43 [00:18<00:06,  1.57it/s]Computing embeddings:  79%|███████▉  | 34/43 [00:19<00:05,  1.57it/s]Computing embeddings:  81%|████████▏ | 35/43 [00:19<00:04,  1.63it/s]Computing embeddings:  84%|████████▎ | 36/43 [00:20<00:04,  1.63it/s]Computing embeddings:  86%|████████▌ | 37/43 [00:20<00:03,  1.62it/s]Computing embeddings:  88%|████████▊ | 38/43 [00:21<00:03,  1.62it/s]Computing embeddings:  91%|█████████ | 39/43 [00:22<00:02,  1.62it/s]Computing embeddings:  93%|█████████▎| 40/43 [00:22<00:01,  1.61it/s]Computing embeddings:  95%|█████████▌| 41/43 [00:23<00:01,  1.61it/s]Computing embeddings:  98%|█████████▊| 42/43 [00:23<00:00,  1.61it/s]Computing embeddings: 100%|██████████| 43/43 [00:24<00:00,  1.62it/s]Computing embeddings: 100%|██████████| 43/43 [00:24<00:00,  1.75it/s]

Selecting 25 representative images...

Results for label 'negative':
  Selected 25 images
  Distance range: 23.8594 - 26.0938
  Saved to: selected_gt_cptac_er_negative.txt
  Saved to: selected_gt_cptac_er_negative_with_distances.json

============================================================
Processing label: positive
Total images: 1880
============================================================

Computing embeddings for 1800 images from data/histomorfologico/cptac/er/label_positive_pred_1...
Computing embeddings:   0%|          | 0/225 [00:00<?, ?it/s]Computing embeddings:   0%|          | 1/225 [00:00<02:18,  1.61it/s]Computing embeddings:   1%|          | 2/225 [00:01<02:19,  1.60it/s]Computing embeddings:   1%|▏         | 3/225 [00:01<02:18,  1.60it/s]Computing embeddings:   2%|▏         | 4/225 [00:02<02:16,  1.61it/s]Computing embeddings:   2%|▏         | 5/225 [00:03<02:15,  1.62it/s]Computing embeddings:   3%|▎         | 6/225 [00:03<02:15,  1.62it/s]Computing embeddings:   3%|▎         | 7/225 [00:04<02:14,  1.62it/s]Computing embeddings:   4%|▎         | 8/225 [00:04<02:13,  1.62it/s]Computing embeddings:   4%|▍         | 9/225 [00:05<02:13,  1.62it/s]Computing embeddings:   4%|▍         | 10/225 [00:06<02:12,  1.63it/s]Computing embeddings:   5%|▍         | 11/225 [00:06<02:11,  1.62it/s]Computing embeddings:   5%|▌         | 12/225 [00:07<02:11,  1.62it/s]Computing embeddings:   6%|▌         | 13/225 [00:08<02:10,  1.62it/s]Computing embeddings:   6%|▌         | 14/225 [00:08<02:10,  1.62it/s]Computing embeddings:   7%|▋         | 15/225 [00:09<02:10,  1.61it/s]Computing embeddings:   7%|▋         | 16/225 [00:09<02:10,  1.61it/s]Computing embeddings:   8%|▊         | 17/225 [00:10<02:10,  1.60it/s]Computing embeddings:   8%|▊         | 18/225 [00:11<02:09,  1.60it/s]Computing embeddings:   8%|▊         | 19/225 [00:11<02:08,  1.61it/s]Computing embeddings:   9%|▉         | 20/225 [00:12<02:06,  1.61it/s]Computing embeddings:   9%|▉         | 21/225 [00:13<02:06,  1.62it/s]Computing embeddings:  10%|▉         | 22/225 [00:13<02:05,  1.62it/s]Computing embeddings:  10%|█         | 23/225 [00:14<02:04,  1.62it/s]Computing embeddings:  11%|█         | 24/225 [00:14<02:03,  1.62it/s]Computing embeddings:  11%|█         | 25/225 [00:15<02:03,  1.62it/s]Computing embeddings:  12%|█▏        | 26/225 [00:16<02:02,  1.62it/s]Computing embeddings:  12%|█▏        | 27/225 [00:16<02:01,  1.62it/s]Computing embeddings:  12%|█▏        | 28/225 [00:17<02:01,  1.63it/s]Computing embeddings:  13%|█▎        | 29/225 [00:17<02:01,  1.61it/s]Computing embeddings:  13%|█▎        | 30/225 [00:18<02:00,  1.62it/s]Computing embeddings:  14%|█▍        | 31/225 [00:19<02:00,  1.62it/s]Computing embeddings:  14%|█▍        | 32/225 [00:19<01:59,  1.62it/s]Computing embeddings:  15%|█▍        | 33/225 [00:20<01:58,  1.62it/s]Computing embeddings:  15%|█▌        | 34/225 [00:21<01:57,  1.62it/s]Computing embeddings:  16%|█▌        | 35/225 [00:21<01:57,  1.62it/s]Computing embeddings:  16%|█▌        | 36/225 [00:22<01:56,  1.62it/s]Computing embeddings:  16%|█▋        | 37/225 [00:22<01:55,  1.62it/s]Computing embeddings:  17%|█▋        | 38/225 [00:23<01:55,  1.63it/s]Computing embeddings:  17%|█▋        | 39/225 [00:24<01:54,  1.63it/s]Computing embeddings:  18%|█▊        | 40/225 [00:24<01:53,  1.63it/s]Computing embeddings:  18%|█▊        | 41/225 [00:25<01:52,  1.63it/s]Computing embeddings:  19%|█▊        | 42/225 [00:25<01:52,  1.63it/s]Computing embeddings:  19%|█▉        | 43/225 [00:26<01:51,  1.63it/s]Computing embeddings:  20%|█▉        | 44/225 [00:27<01:50,  1.63it/s]Computing embeddings:  20%|██        | 45/225 [00:27<01:50,  1.63it/s]Computing embeddings:  20%|██        | 46/225 [00:28<01:49,  1.63it/s]Computing embeddings:  21%|██        | 47/225 [00:29<01:49,  1.63it/s]Computing embeddings:  21%|██▏       | 48/225 [00:29<01:48,  1.63it/s]Computing embeddings:  22%|██▏       | 49/225 [00:30<01:48,  1.63it/s]Computing embeddings:  22%|██▏       | 50/225 [00:30<01:47,  1.63it/s]Computing embeddings:  23%|██▎       | 51/225 [00:31<01:46,  1.63it/s]Computing embeddings:  23%|██▎       | 52/225 [00:32<01:45,  1.64it/s]Computing embeddings:  24%|██▎       | 53/225 [00:32<01:45,  1.63it/s]Computing embeddings:  24%|██▍       | 54/225 [00:33<01:44,  1.63it/s]Computing embeddings:  24%|██▍       | 55/225 [00:33<01:44,  1.63it/s]Computing embeddings:  25%|██▍       | 56/225 [00:34<01:43,  1.63it/s]Computing embeddings:  25%|██▌       | 57/225 [00:35<01:43,  1.63it/s]Computing embeddings:  26%|██▌       | 58/225 [00:35<01:42,  1.63it/s]Computing embeddings:  26%|██▌       | 59/225 [00:36<01:41,  1.63it/s]Computing embeddings:  27%|██▋       | 60/225 [00:36<01:41,  1.63it/s]Computing embeddings:  27%|██▋       | 61/225 [00:37<01:40,  1.64it/s]Computing embeddings:  28%|██▊       | 62/225 [00:38<01:37,  1.68it/s]Computing embeddings:  28%|██▊       | 63/225 [00:38<01:25,  1.89it/s]Computing embeddings:  28%|██▊       | 64/225 [00:38<01:17,  2.08it/s]Computing embeddings:  29%|██▉       | 65/225 [00:39<01:11,  2.22it/s]Computing embeddings:  29%|██▉       | 66/225 [00:39<01:08,  2.33it/s]Computing embeddings:  30%|██▉       | 67/225 [00:40<01:05,  2.42it/s]Computing embeddings:  30%|███       | 68/225 [00:40<01:03,  2.48it/s]Computing embeddings:  31%|███       | 69/225 [00:40<01:01,  2.53it/s]Computing embeddings:  31%|███       | 70/225 [00:41<01:00,  2.56it/s]Computing embeddings:  32%|███▏      | 71/225 [00:41<00:59,  2.58it/s]Computing embeddings:  32%|███▏      | 72/225 [00:41<01:00,  2.53it/s]Computing embeddings:  32%|███▏      | 73/225 [00:42<01:01,  2.47it/s]Computing embeddings:  33%|███▎      | 74/225 [00:42<01:02,  2.43it/s]Computing embeddings:  33%|███▎      | 75/225 [00:43<01:02,  2.40it/s]Computing embeddings:  34%|███▍      | 76/225 [00:43<01:02,  2.37it/s]Computing embeddings:  34%|███▍      | 77/225 [00:44<01:02,  2.37it/s]Computing embeddings:  35%|███▍      | 78/225 [00:44<01:02,  2.36it/s]Computing embeddings:  35%|███▌      | 79/225 [00:44<01:01,  2.36it/s]Computing embeddings:  36%|███▌      | 80/225 [00:45<01:01,  2.36it/s]Computing embeddings:  36%|███▌      | 81/225 [00:45<01:01,  2.36it/s]Computing embeddings:  36%|███▋      | 82/225 [00:46<01:00,  2.35it/s]Computing embeddings:  37%|███▋      | 83/225 [00:46<01:00,  2.35it/s]Computing embeddings:  37%|███▋      | 84/225 [00:47<00:59,  2.35it/s]Computing embeddings:  38%|███▊      | 85/225 [00:47<00:59,  2.35it/s]Computing embeddings:  38%|███▊      | 86/225 [00:47<00:59,  2.35it/s]Computing embeddings:  39%|███▊      | 87/225 [00:48<00:58,  2.35it/s]Computing embeddings:  39%|███▉      | 88/225 [00:48<00:56,  2.44it/s]Computing embeddings:  40%|███▉      | 89/225 [00:49<00:52,  2.60it/s]Computing embeddings:  40%|████      | 90/225 [00:49<00:51,  2.64it/s]Computing embeddings:  40%|████      | 91/225 [00:49<00:50,  2.64it/s]Computing embeddings:  41%|████      | 92/225 [00:50<00:50,  2.63it/s]Computing embeddings:  41%|████▏     | 93/225 [00:50<00:47,  2.80it/s]Computing embeddings:  42%|████▏     | 94/225 [00:50<00:45,  2.85it/s]Computing embeddings:  42%|████▏     | 95/225 [00:51<00:45,  2.84it/s]Computing embeddings:  43%|████▎     | 96/225 [00:51<00:45,  2.85it/s]Computing embeddings:  43%|████▎     | 97/225 [00:51<00:46,  2.73it/s]Computing embeddings:  44%|████▎     | 98/225 [00:52<00:48,  2.61it/s]Computing embeddings:  44%|████▍     | 99/225 [00:52<00:49,  2.53it/s]Computing embeddings:  44%|████▍     | 100/225 [00:53<00:50,  2.45it/s]Computing embeddings:  45%|████▍     | 101/225 [00:53<00:51,  2.39it/s]Computing embeddings:  45%|████▌     | 102/225 [00:53<00:48,  2.56it/s]Computing embeddings:  46%|████▌     | 103/225 [00:54<00:47,  2.59it/s]Computing embeddings:  46%|████▌     | 104/225 [00:54<00:47,  2.57it/s]Computing embeddings:  47%|████▋     | 105/225 [00:55<00:47,  2.55it/s]Computing embeddings:  47%|████▋     | 106/225 [00:55<00:46,  2.54it/s]Computing embeddings:  48%|████▊     | 107/225 [00:55<00:46,  2.53it/s]Computing embeddings:  48%|████▊     | 108/225 [00:56<00:46,  2.53it/s]Computing embeddings:  48%|████▊     | 109/225 [00:56<00:45,  2.53it/s]Computing embeddings:  49%|████▉     | 110/225 [00:57<00:45,  2.52it/s]Computing embeddings:  49%|████▉     | 111/225 [00:57<00:42,  2.70it/s]Computing embeddings:  50%|████▉     | 112/225 [00:58<00:49,  2.28it/s]Computing embeddings:  50%|█████     | 113/225 [00:58<00:54,  2.04it/s]Computing embeddings:  51%|█████     | 114/225 [00:59<00:58,  1.90it/s]Computing embeddings:  51%|█████     | 115/225 [00:59<01:00,  1.81it/s]Computing embeddings:  52%|█████▏    | 116/225 [01:00<01:02,  1.76it/s]Computing embeddings:  52%|█████▏    | 117/225 [01:01<01:00,  1.79it/s]Computing embeddings:  52%|█████▏    | 118/225 [01:01<00:58,  1.83it/s]Computing embeddings:  53%|█████▎    | 119/225 [01:02<00:56,  1.86it/s]Computing embeddings:  53%|█████▎    | 120/225 [01:02<00:55,  1.88it/s]Computing embeddings:  54%|█████▍    | 121/225 [01:03<00:54,  1.90it/s]Computing embeddings:  54%|█████▍    | 122/225 [01:03<00:53,  1.91it/s]Computing embeddings:  55%|█████▍    | 123/225 [01:04<00:53,  1.92it/s]Computing embeddings:  55%|█████▌    | 124/225 [01:04<00:52,  1.93it/s]Computing embeddings:  56%|█████▌    | 125/225 [01:05<00:51,  1.94it/s]Computing embeddings:  56%|█████▌    | 126/225 [01:05<00:51,  1.93it/s]Computing embeddings:  56%|█████▋    | 127/225 [01:06<00:50,  1.93it/s]Computing embeddings:  57%|█████▋    | 128/225 [01:06<00:46,  2.08it/s]Computing embeddings:  57%|█████▋    | 129/225 [01:06<00:43,  2.20it/s]Computing embeddings:  58%|█████▊    | 130/225 [01:07<00:41,  2.29it/s]Computing embeddings:  58%|█████▊    | 131/225 [01:07<00:40,  2.35it/s]Computing embeddings:  59%|█████▊    | 132/225 [01:08<00:38,  2.39it/s]Computing embeddings:  59%|█████▉    | 133/225 [01:08<00:37,  2.43it/s]Computing embeddings:  60%|█████▉    | 134/225 [01:08<00:37,  2.46it/s]Computing embeddings:  60%|██████    | 135/225 [01:09<00:36,  2.47it/s]Computing embeddings:  60%|██████    | 136/225 [01:09<00:35,  2.49it/s]Computing embeddings:  61%|██████    | 137/225 [01:10<00:35,  2.49it/s]Computing embeddings:  61%|██████▏   | 138/225 [01:10<00:34,  2.50it/s]Computing embeddings:  62%|██████▏   | 139/225 [01:10<00:34,  2.50it/s]Computing embeddings:  62%|██████▏   | 140/225 [01:11<00:33,  2.51it/s]Computing embeddings:  63%|██████▎   | 141/225 [01:11<00:33,  2.51it/s]Computing embeddings:  63%|██████▎   | 142/225 [01:12<00:33,  2.51it/s]Computing embeddings:  64%|██████▎   | 143/225 [01:12<00:32,  2.51it/s]Computing embeddings:  64%|██████▍   | 144/225 [01:12<00:32,  2.51it/s]Computing embeddings:  64%|██████▍   | 145/225 [01:13<00:31,  2.51it/s]Computing embeddings:  65%|██████▍   | 146/225 [01:13<00:31,  2.51it/s]Computing embeddings:  65%|██████▌   | 147/225 [01:14<00:29,  2.68it/s]Computing embeddings:  66%|██████▌   | 148/225 [01:14<00:28,  2.73it/s]Computing embeddings:  66%|██████▌   | 149/225 [01:14<00:27,  2.72it/s]Computing embeddings:  67%|██████▋   | 150/225 [01:15<00:28,  2.64it/s]Computing embeddings:  67%|██████▋   | 151/225 [01:15<00:28,  2.60it/s]Computing embeddings:  68%|██████▊   | 152/225 [01:15<00:28,  2.57it/s]Computing embeddings:  68%|██████▊   | 153/225 [01:16<00:27,  2.64it/s]Computing embeddings:  68%|██████▊   | 154/225 [01:16<00:27,  2.61it/s]Computing embeddings:  69%|██████▉   | 155/225 [01:17<00:27,  2.56it/s]Computing embeddings:  69%|██████▉   | 156/225 [01:17<00:27,  2.53it/s]Computing embeddings:  70%|██████▉   | 157/225 [01:17<00:27,  2.49it/s]Computing embeddings:  70%|███████   | 158/225 [01:18<00:27,  2.48it/s]Computing embeddings:  71%|███████   | 159/225 [01:18<00:26,  2.47it/s]Computing embeddings:  71%|███████   | 160/225 [01:19<00:26,  2.46it/s]Computing embeddings:  72%|███████▏  | 161/225 [01:19<00:26,  2.46it/s]Computing embeddings:  72%|███████▏  | 162/225 [01:19<00:25,  2.45it/s]Computing embeddings:  72%|███████▏  | 163/225 [01:20<00:25,  2.44it/s]Computing embeddings:  73%|███████▎  | 164/225 [01:20<00:25,  2.44it/s]Computing embeddings:  73%|███████▎  | 165/225 [01:21<00:24,  2.44it/s]Computing embeddings:  74%|███████▍  | 166/225 [01:21<00:24,  2.44it/s]Computing embeddings:  74%|███████▍  | 167/225 [01:22<00:23,  2.44it/s]Computing embeddings:  75%|███████▍  | 168/225 [01:22<00:23,  2.44it/s]Computing embeddings:  75%|███████▌  | 169/225 [01:22<00:22,  2.44it/s]Computing embeddings:  76%|███████▌  | 170/225 [01:23<00:22,  2.44it/s]Computing embeddings:  76%|███████▌  | 171/225 [01:23<00:22,  2.44it/s]Computing embeddings:  76%|███████▋  | 172/225 [01:24<00:21,  2.44it/s]Computing embeddings:  77%|███████▋  | 173/225 [01:24<00:21,  2.44it/s]Computing embeddings:  77%|███████▋  | 174/225 [01:24<00:20,  2.44it/s]Computing embeddings:  78%|███████▊  | 175/225 [01:25<00:20,  2.45it/s]Computing embeddings:  78%|███████▊  | 176/225 [01:25<00:20,  2.45it/s]Computing embeddings:  79%|███████▊  | 177/225 [01:26<00:19,  2.44it/s]Computing embeddings:  79%|███████▉  | 178/225 [01:26<00:19,  2.44it/s]Computing embeddings:  80%|███████▉  | 179/225 [01:26<00:18,  2.44it/s]Computing embeddings:  80%|████████  | 180/225 [01:27<00:18,  2.45it/s]Computing embeddings:  80%|████████  | 181/225 [01:27<00:17,  2.45it/s]Computing embeddings:  81%|████████  | 182/225 [01:28<00:17,  2.45it/s]Computing embeddings:  81%|████████▏ | 183/225 [01:28<00:17,  2.45it/s]Computing embeddings:  82%|████████▏ | 184/225 [01:28<00:16,  2.44it/s]Computing embeddings:  82%|████████▏ | 185/225 [01:29<00:16,  2.44it/s]Computing embeddings:  83%|████████▎ | 186/225 [01:29<00:15,  2.45it/s]Computing embeddings:  83%|████████▎ | 187/225 [01:30<00:15,  2.45it/s]Computing embeddings:  84%|████████▎ | 188/225 [01:30<00:15,  2.44it/s]Computing embeddings:  84%|████████▍ | 189/225 [01:31<00:14,  2.45it/s]Computing embeddings:  84%|████████▍ | 190/225 [01:31<00:14,  2.45it/s]Computing embeddings:  85%|████████▍ | 191/225 [01:31<00:13,  2.45it/s]Computing embeddings:  85%|████████▌ | 192/225 [01:32<00:13,  2.42it/s]Computing embeddings:  86%|████████▌ | 193/225 [01:32<00:13,  2.43it/s]Computing embeddings:  86%|████████▌ | 194/225 [01:33<00:12,  2.44it/s]Computing embeddings:  87%|████████▋ | 195/225 [01:33<00:12,  2.44it/s]Computing embeddings:  87%|████████▋ | 196/225 [01:33<00:11,  2.44it/s]Computing embeddings:  88%|████████▊ | 197/225 [01:34<00:11,  2.44it/s]Computing embeddings:  88%|████████▊ | 198/225 [01:34<00:11,  2.45it/s]Computing embeddings:  88%|████████▊ | 199/225 [01:35<00:10,  2.45it/s]Computing embeddings:  89%|████████▉ | 200/225 [01:35<00:10,  2.45it/s]Computing embeddings:  89%|████████▉ | 201/225 [01:35<00:09,  2.44it/s]Computing embeddings:  90%|████████▉ | 202/225 [01:36<00:09,  2.44it/s]Computing embeddings:  90%|█████████ | 203/225 [01:36<00:09,  2.44it/s]Computing embeddings:  91%|█████████ | 204/225 [01:37<00:08,  2.44it/s]Computing embeddings:  91%|█████████ | 205/225 [01:37<00:08,  2.45it/s]Computing embeddings:  92%|█████████▏| 206/225 [01:37<00:07,  2.45it/s]Computing embeddings:  92%|█████████▏| 207/225 [01:38<00:07,  2.45it/s]Computing embeddings:  92%|█████████▏| 208/225 [01:38<00:06,  2.45it/s]Computing embeddings:  93%|█████████▎| 209/225 [01:39<00:06,  2.44it/s]Computing embeddings:  93%|█████████▎| 210/225 [01:39<00:06,  2.44it/s]Computing embeddings:  94%|█████████▍| 211/225 [01:40<00:05,  2.42it/s]Computing embeddings:  94%|█████████▍| 212/225 [01:40<00:05,  2.40it/s]Computing embeddings:  95%|█████████▍| 213/225 [01:40<00:05,  2.39it/s]Computing embeddings:  95%|█████████▌| 214/225 [01:41<00:04,  2.24it/s]Computing embeddings:  96%|█████████▌| 215/225 [01:41<00:04,  2.12it/s]Computing embeddings:  96%|█████████▌| 216/225 [01:42<00:04,  2.06it/s]Computing embeddings:  96%|█████████▋| 217/225 [01:42<00:03,  2.02it/s]Computing embeddings:  97%|█████████▋| 218/225 [01:43<00:03,  2.00it/s]Computing embeddings:  97%|█████████▋| 219/225 [01:43<00:03,  1.99it/s]Computing embeddings:  98%|█████████▊| 220/225 [01:44<00:02,  1.97it/s]Computing embeddings:  98%|█████████▊| 221/225 [01:45<00:02,  1.96it/s]Computing embeddings:  99%|█████████▊| 222/225 [01:45<00:01,  1.95it/s]Computing embeddings:  99%|█████████▉| 223/225 [01:46<00:01,  1.95it/s]Computing embeddings: 100%|█████████▉| 224/225 [01:46<00:00,  1.95it/s]Computing embeddings: 100%|██████████| 225/225 [01:47<00:00,  1.95it/s]Computing embeddings: 100%|██████████| 225/225 [01:47<00:00,  2.10it/s]

Computing embeddings for 80 images from data/histomorfologico/cptac/er/label_positive_pred_0...
Computing embeddings:   0%|          | 0/10 [00:00<?, ?it/s]Computing embeddings:  10%|█         | 1/10 [00:00<00:04,  1.95it/s]Computing embeddings:  20%|██        | 2/10 [00:01<00:04,  1.94it/s]Computing embeddings:  30%|███       | 3/10 [00:01<00:03,  1.95it/s]Computing embeddings:  40%|████      | 4/10 [00:02<00:03,  1.94it/s]Computing embeddings:  50%|█████     | 5/10 [00:02<00:02,  1.94it/s]Computing embeddings:  60%|██████    | 6/10 [00:03<00:02,  1.94it/s]Computing embeddings:  70%|███████   | 7/10 [00:03<00:01,  1.94it/s]Computing embeddings:  80%|████████  | 8/10 [00:04<00:01,  1.95it/s]Computing embeddings:  90%|█████████ | 9/10 [00:04<00:00,  1.95it/s]Computing embeddings: 100%|██████████| 10/10 [00:05<00:00,  1.94it/s]Computing embeddings: 100%|██████████| 10/10 [00:05<00:00,  1.94it/s]

Selecting 25 representative images...

Results for label 'positive':
  Selected 25 images
  Distance range: 23.6719 - 25.2031
  Saved to: selected_gt_cptac_er_positive.txt
  Saved to: selected_gt_cptac_er_positive_with_distances.json

============================================================
Done!
============================================================

Processing HER2 dataset...
Found 2 label directories
Loaded CSV with 387 entries
Created label mapping for 387 slide IDs

Scanning directory: data/histomorfologico/cptac/her2/label_positive_pred_0
  Found 336 images

Scanning directory: data/histomorfologico/cptac/her2/label_negative_pred_0
  Found 2760 images

============================================================
Images grouped by ground truth label:
  negative: 2760 images
  positive: 336 images
Total images: 3096
Not found in CSV: 0
============================================================

Loading Virchow v2 model...

============================================================
Processing label: negative
Total images: 2760
============================================================

Computing embeddings for 2760 images from data/histomorfologico/cptac/her2/label_negative_pred_0...
Computing embeddings:   0%|          | 0/345 [00:00<?, ?it/s]Computing embeddings:   0%|          | 1/345 [00:00<02:47,  2.06it/s]Computing embeddings:   1%|          | 2/345 [00:00<02:09,  2.66it/s]Computing embeddings:   1%|          | 3/345 [00:01<01:57,  2.92it/s]Computing embeddings:   1%|          | 4/345 [00:01<01:51,  3.05it/s]Computing embeddings:   1%|▏         | 5/345 [00:01<01:48,  3.12it/s]Computing embeddings:   2%|▏         | 6/345 [00:02<01:46,  3.18it/s]Computing embeddings:   2%|▏         | 7/345 [00:02<01:46,  3.17it/s]Computing embeddings:   2%|▏         | 8/345 [00:02<01:46,  3.16it/s]Computing embeddings:   3%|▎         | 9/345 [00:02<01:46,  3.17it/s]Computing embeddings:   3%|▎         | 10/345 [00:03<01:45,  3.17it/s]Computing embeddings:   3%|▎         | 11/345 [00:03<01:46,  3.15it/s]Computing embeddings:   3%|▎         | 12/345 [00:03<01:48,  3.06it/s]Computing embeddings:   4%|▍         | 13/345 [00:04<01:50,  3.01it/s]Computing embeddings:   4%|▍         | 14/345 [00:04<01:48,  3.05it/s]Computing embeddings:   4%|▍         | 15/345 [00:04<01:49,  3.02it/s]Computing embeddings:   5%|▍         | 16/345 [00:05<01:51,  2.96it/s]Computing embeddings:   5%|▍         | 17/345 [00:05<01:51,  2.94it/s]Computing embeddings:   5%|▌         | 18/345 [00:05<01:51,  2.92it/s]Computing embeddings:   6%|▌         | 19/345 [00:06<01:51,  2.91it/s]Computing embeddings:   6%|▌         | 20/345 [00:06<01:47,  3.01it/s]Computing embeddings:   6%|▌         | 21/345 [00:07<02:14,  2.41it/s]Computing embeddings:   6%|▋         | 22/345 [00:07<02:20,  2.30it/s]Computing embeddings:   7%|▋         | 23/345 [00:08<02:24,  2.23it/s]Computing embeddings:   7%|▋         | 24/345 [00:08<02:18,  2.33it/s]Computing embeddings:   7%|▋         | 25/345 [00:08<02:13,  2.39it/s]Computing embeddings:   8%|▊         | 26/345 [00:09<02:10,  2.44it/s]Computing embeddings:   8%|▊         | 27/345 [00:09<02:08,  2.48it/s]Computing embeddings:   8%|▊         | 28/345 [00:10<02:06,  2.50it/s]Computing embeddings:   8%|▊         | 29/345 [00:10<02:05,  2.53it/s]Computing embeddings:   9%|▊         | 30/345 [00:10<02:03,  2.55it/s]Computing embeddings:   9%|▉         | 31/345 [00:11<02:02,  2.55it/s]Computing embeddings:   9%|▉         | 32/345 [00:11<02:02,  2.56it/s]Computing embeddings:  10%|▉         | 33/345 [00:12<01:58,  2.63it/s]Computing embeddings:  10%|▉         | 34/345 [00:12<01:53,  2.74it/s]Computing embeddings:  10%|█         | 35/345 [00:12<01:52,  2.75it/s]Computing embeddings:  10%|█         | 36/345 [00:13<01:53,  2.73it/s]Computing embeddings:  11%|█         | 37/345 [00:13<01:53,  2.71it/s]Computing embeddings:  11%|█         | 38/345 [00:13<01:50,  2.78it/s]Computing embeddings:  11%|█▏        | 39/345 [00:14<01:51,  2.75it/s]Computing embeddings:  12%|█▏        | 40/345 [00:14<01:53,  2.69it/s]Computing embeddings:  12%|█▏        | 41/345 [00:14<01:54,  2.65it/s]Computing embeddings:  12%|█▏        | 42/345 [00:15<01:55,  2.62it/s]Computing embeddings:  12%|█▏        | 43/345 [00:15<01:55,  2.61it/s]Computing embeddings:  13%|█▎        | 44/345 [00:16<01:49,  2.75it/s]Computing embeddings:  13%|█▎        | 45/345 [00:16<01:47,  2.80it/s]Computing embeddings:  13%|█▎        | 46/345 [00:16<01:47,  2.78it/s]Computing embeddings:  14%|█▎        | 47/345 [00:17<01:43,  2.89it/s]Computing embeddings:  14%|█▍        | 48/345 [00:17<01:43,  2.86it/s]Computing embeddings:  14%|█▍        | 49/345 [00:17<01:45,  2.80it/s]Computing embeddings:  14%|█▍        | 50/345 [00:18<01:48,  2.73it/s]Computing embeddings:  15%|█▍        | 51/345 [00:18<01:55,  2.55it/s]Computing embeddings:  15%|█▌        | 52/345 [00:19<01:59,  2.45it/s]Computing embeddings:  15%|█▌        | 53/345 [00:19<02:02,  2.38it/s]Computing embeddings:  16%|█▌        | 54/345 [00:20<02:04,  2.33it/s]Computing embeddings:  16%|█▌        | 55/345 [00:20<02:06,  2.29it/s]Computing embeddings:  16%|█▌        | 56/345 [00:20<01:55,  2.50it/s]Computing embeddings:  17%|█▋        | 57/345 [00:21<01:48,  2.66it/s]Computing embeddings:  17%|█▋        | 58/345 [00:21<01:44,  2.75it/s]Computing embeddings:  17%|█▋        | 59/345 [00:21<01:44,  2.74it/s]Computing embeddings:  17%|█▋        | 60/345 [00:22<01:51,  2.55it/s]Computing embeddings:  18%|█▊        | 61/345 [00:22<01:56,  2.43it/s]Computing embeddings:  18%|█▊        | 62/345 [00:23<01:59,  2.36it/s]Computing embeddings:  18%|█▊        | 63/345 [00:23<02:01,  2.31it/s]Computing embeddings:  19%|█▊        | 64/345 [00:24<02:03,  2.28it/s]Computing embeddings:  19%|█▉        | 65/345 [00:24<02:03,  2.26it/s]Computing embeddings:  19%|█▉        | 66/345 [00:24<02:04,  2.25it/s]Computing embeddings:  19%|█▉        | 67/345 [00:25<02:04,  2.24it/s]Computing embeddings:  20%|█▉        | 68/345 [00:25<02:04,  2.23it/s]Computing embeddings:  20%|██        | 69/345 [00:26<02:03,  2.23it/s]Computing embeddings:  20%|██        | 70/345 [00:26<02:03,  2.23it/s]Computing embeddings:  21%|██        | 71/345 [00:27<02:03,  2.22it/s]Computing embeddings:  21%|██        | 72/345 [00:27<02:03,  2.22it/s]Computing embeddings:  21%|██        | 73/345 [00:28<02:02,  2.22it/s]Computing embeddings:  21%|██▏       | 74/345 [00:28<02:01,  2.22it/s]Computing embeddings:  22%|██▏       | 75/345 [00:29<02:01,  2.22it/s]Computing embeddings:  22%|██▏       | 76/345 [00:29<02:00,  2.22it/s]Computing embeddings:  22%|██▏       | 77/345 [00:29<02:00,  2.22it/s]Computing embeddings:  23%|██▎       | 78/345 [00:30<02:00,  2.22it/s]Computing embeddings:  23%|██▎       | 79/345 [00:30<01:59,  2.23it/s]Computing embeddings:  23%|██▎       | 80/345 [00:31<01:59,  2.22it/s]Computing embeddings:  23%|██▎       | 81/345 [00:31<01:58,  2.23it/s]Computing embeddings:  24%|██▍       | 82/345 [00:32<01:58,  2.23it/s]Computing embeddings:  24%|██▍       | 83/345 [00:32<01:57,  2.23it/s]Computing embeddings:  24%|██▍       | 84/345 [00:33<01:57,  2.22it/s]Computing embeddings:  25%|██▍       | 85/345 [00:33<01:56,  2.22it/s]Computing embeddings:  25%|██▍       | 86/345 [00:33<01:56,  2.23it/s]Computing embeddings:  25%|██▌       | 87/345 [00:34<01:55,  2.23it/s]Computing embeddings:  26%|██▌       | 88/345 [00:34<01:55,  2.22it/s]Computing embeddings:  26%|██▌       | 89/345 [00:35<01:55,  2.22it/s]Computing embeddings:  26%|██▌       | 90/345 [00:35<01:54,  2.22it/s]Computing embeddings:  26%|██▋       | 91/345 [00:36<01:54,  2.22it/s]Computing embeddings:  27%|██▋       | 92/345 [00:36<01:53,  2.22it/s]Computing embeddings:  27%|██▋       | 93/345 [00:37<01:53,  2.23it/s]Computing embeddings:  27%|██▋       | 94/345 [00:37<01:52,  2.22it/s]Computing embeddings:  28%|██▊       | 95/345 [00:38<01:52,  2.22it/s]Computing embeddings:  28%|██▊       | 96/345 [00:38<01:52,  2.22it/s]Computing embeddings:  28%|██▊       | 97/345 [00:38<01:51,  2.22it/s]Computing embeddings:  28%|██▊       | 98/345 [00:39<01:51,  2.22it/s]Computing embeddings:  29%|██▊       | 99/345 [00:39<01:50,  2.23it/s]Computing embeddings:  29%|██▉       | 100/345 [00:40<01:50,  2.22it/s]Computing embeddings:  29%|██▉       | 101/345 [00:40<01:49,  2.22it/s]Computing embeddings:  30%|██▉       | 102/345 [00:41<01:49,  2.22it/s]Computing embeddings:  30%|██▉       | 103/345 [00:41<01:48,  2.22it/s]Computing embeddings:  30%|███       | 104/345 [00:42<01:48,  2.22it/s]Computing embeddings:  30%|███       | 105/345 [00:42<01:47,  2.22it/s]Computing embeddings:  31%|███       | 106/345 [00:42<01:47,  2.22it/s]Computing embeddings:  31%|███       | 107/345 [00:43<01:47,  2.22it/s]Computing embeddings:  31%|███▏      | 108/345 [00:43<01:46,  2.22it/s]Computing embeddings:  32%|███▏      | 109/345 [00:44<01:46,  2.22it/s]Computing embeddings:  32%|███▏      | 110/345 [00:44<01:45,  2.22it/s]Computing embeddings:  32%|███▏      | 111/345 [00:45<01:45,  2.22it/s]Computing embeddings:  32%|███▏      | 112/345 [00:45<01:44,  2.22it/s]Computing embeddings:  33%|███▎      | 113/345 [00:46<01:44,  2.23it/s]Computing embeddings:  33%|███▎      | 114/345 [00:46<01:43,  2.23it/s]Computing embeddings:  33%|███▎      | 115/345 [00:47<01:43,  2.23it/s]Computing embeddings:  34%|███▎      | 116/345 [00:47<01:42,  2.23it/s]Computing embeddings:  34%|███▍      | 117/345 [00:47<01:42,  2.23it/s]Computing embeddings:  34%|███▍      | 118/345 [00:48<01:42,  2.22it/s]Computing embeddings:  34%|███▍      | 119/345 [00:48<01:41,  2.23it/s]Computing embeddings:  35%|███▍      | 120/345 [00:49<01:41,  2.22it/s]Computing embeddings:  35%|███▌      | 121/345 [00:49<01:40,  2.22it/s]Computing embeddings:  35%|███▌      | 122/345 [00:50<01:40,  2.22it/s]Computing embeddings:  36%|███▌      | 123/345 [00:50<01:35,  2.32it/s]Computing embeddings:  36%|███▌      | 124/345 [00:50<01:28,  2.50it/s]Computing embeddings:  36%|███▌      | 125/345 [00:51<01:24,  2.59it/s]Computing embeddings:  37%|███▋      | 126/345 [00:51<01:24,  2.59it/s]Computing embeddings:  37%|███▋      | 127/345 [00:52<01:26,  2.51it/s]Computing embeddings:  37%|███▋      | 128/345 [00:52<01:27,  2.47it/s]Computing embeddings:  37%|███▋      | 129/345 [00:52<01:28,  2.43it/s]Computing embeddings:  38%|███▊      | 130/345 [00:53<01:29,  2.41it/s]Computing embeddings:  38%|███▊      | 131/345 [00:53<01:29,  2.39it/s]Computing embeddings:  38%|███▊      | 132/345 [00:54<01:29,  2.38it/s]Computing embeddings:  39%|███▊      | 133/345 [00:54<01:29,  2.37it/s]Computing embeddings:  39%|███▉      | 134/345 [00:55<01:28,  2.37it/s]Computing embeddings:  39%|███▉      | 135/345 [00:55<01:28,  2.37it/s]Computing embeddings:  39%|███▉      | 136/345 [00:55<01:28,  2.37it/s]Computing embeddings:  40%|███▉      | 137/345 [00:56<01:28,  2.36it/s]Computing embeddings:  40%|████      | 138/345 [00:56<01:24,  2.46it/s]Computing embeddings:  40%|████      | 139/345 [00:57<01:27,  2.37it/s]Computing embeddings:  41%|████      | 140/345 [00:57<01:30,  2.27it/s]Computing embeddings:  41%|████      | 141/345 [00:58<01:32,  2.20it/s]Computing embeddings:  41%|████      | 142/345 [00:58<01:33,  2.16it/s]Computing embeddings:  41%|████▏     | 143/345 [00:59<01:35,  2.12it/s]Computing embeddings:  42%|████▏     | 144/345 [00:59<01:35,  2.10it/s]Computing embeddings:  42%|████▏     | 145/345 [01:00<01:35,  2.09it/s]Computing embeddings:  42%|████▏     | 146/345 [01:00<01:35,  2.08it/s]Computing embeddings:  43%|████▎     | 147/345 [01:01<01:34,  2.08it/s]Computing embeddings:  43%|████▎     | 148/345 [01:01<01:34,  2.08it/s]Computing embeddings:  43%|████▎     | 149/345 [01:01<01:34,  2.08it/s]Computing embeddings:  43%|████▎     | 150/345 [01:02<01:35,  2.05it/s]Computing embeddings:  44%|████▍     | 151/345 [01:02<01:34,  2.05it/s]Computing embeddings:  44%|████▍     | 152/345 [01:03<01:34,  2.05it/s]Computing embeddings:  44%|████▍     | 153/345 [01:03<01:33,  2.06it/s]Computing embeddings:  45%|████▍     | 154/345 [01:04<01:27,  2.18it/s]Computing embeddings:  45%|████▍     | 155/345 [01:04<01:23,  2.29it/s]Computing embeddings:  45%|████▌     | 156/345 [01:05<01:20,  2.36it/s]Computing embeddings:  46%|████▌     | 157/345 [01:05<01:15,  2.51it/s]Computing embeddings:  46%|████▌     | 158/345 [01:05<01:13,  2.56it/s]Computing embeddings:  46%|████▌     | 159/345 [01:06<01:12,  2.56it/s]Computing embeddings:  46%|████▋     | 160/345 [01:06<01:12,  2.56it/s]Computing embeddings:  47%|████▋     | 161/345 [01:06<01:11,  2.57it/s]Computing embeddings:  47%|████▋     | 162/345 [01:07<01:11,  2.56it/s]Computing embeddings:  47%|████▋     | 163/345 [01:07<01:06,  2.74it/s]Computing embeddings:  48%|████▊     | 164/345 [01:08<01:04,  2.79it/s]Computing embeddings:  48%|████▊     | 165/345 [01:08<01:17,  2.32it/s]Computing embeddings:  48%|████▊     | 166/345 [01:09<01:26,  2.07it/s]Computing embeddings:  48%|████▊     | 167/345 [01:09<01:31,  1.94it/s]Computing embeddings:  49%|████▊     | 168/345 [01:10<01:34,  1.88it/s]Computing embeddings:  49%|████▉     | 169/345 [01:10<01:35,  1.83it/s]Computing embeddings:  49%|████▉     | 170/345 [01:11<01:36,  1.81it/s]Computing embeddings:  50%|████▉     | 171/345 [01:12<01:36,  1.80it/s]Computing embeddings:  50%|████▉     | 172/345 [01:12<01:29,  1.94it/s]Computing embeddings:  50%|█████     | 173/345 [01:12<01:23,  2.05it/s]Computing embeddings:  50%|█████     | 174/345 [01:13<01:19,  2.15it/s]Computing embeddings:  51%|█████     | 175/345 [01:13<01:16,  2.21it/s]Computing embeddings:  51%|█████     | 176/345 [01:14<01:14,  2.26it/s]Computing embeddings:  51%|█████▏    | 177/345 [01:14<01:13,  2.30it/s]Computing embeddings:  52%|█████▏    | 178/345 [01:15<01:11,  2.33it/s]Computing embeddings:  52%|█████▏    | 179/345 [01:15<01:11,  2.34it/s]Computing embeddings:  52%|█████▏    | 180/345 [01:15<01:10,  2.35it/s]Computing embeddings:  52%|█████▏    | 181/345 [01:16<01:09,  2.35it/s]Computing embeddings:  53%|█████▎    | 182/345 [01:16<01:09,  2.36it/s]Computing embeddings:  53%|█████▎    | 183/345 [01:17<01:08,  2.37it/s]Computing embeddings:  53%|█████▎    | 184/345 [01:17<01:07,  2.37it/s]Computing embeddings:  54%|█████▎    | 185/345 [01:18<01:11,  2.24it/s]Computing embeddings:  54%|█████▍    | 186/345 [01:18<01:15,  2.11it/s]Computing embeddings:  54%|█████▍    | 187/345 [01:19<01:17,  2.03it/s]Computing embeddings:  54%|█████▍    | 188/345 [01:19<01:19,  1.97it/s]Computing embeddings:  55%|█████▍    | 189/345 [01:20<01:20,  1.94it/s]Computing embeddings:  55%|█████▌    | 190/345 [01:20<01:20,  1.92it/s]Computing embeddings:  55%|█████▌    | 191/345 [01:21<01:15,  2.05it/s]Computing embeddings:  56%|█████▌    | 192/345 [01:21<01:10,  2.16it/s]Computing embeddings:  56%|█████▌    | 193/345 [01:21<01:07,  2.24it/s]Computing embeddings:  56%|█████▌    | 194/345 [01:22<01:05,  2.31it/s]Computing embeddings:  57%|█████▋    | 195/345 [01:22<01:03,  2.36it/s]Computing embeddings:  57%|█████▋    | 196/345 [01:23<01:02,  2.39it/s]Computing embeddings:  57%|█████▋    | 197/345 [01:23<01:01,  2.41it/s]Computing embeddings:  57%|█████▋    | 198/345 [01:23<01:00,  2.43it/s]Computing embeddings:  58%|█████▊    | 199/345 [01:24<00:59,  2.44it/s]Computing embeddings:  58%|█████▊    | 200/345 [01:24<00:59,  2.44it/s]Computing embeddings:  58%|█████▊    | 201/345 [01:25<00:58,  2.45it/s]Computing embeddings:  59%|█████▊    | 202/345 [01:25<00:58,  2.45it/s]Computing embeddings:  59%|█████▉    | 203/345 [01:26<00:58,  2.44it/s]Computing embeddings:  59%|█████▉    | 204/345 [01:26<00:57,  2.45it/s]Computing embeddings:  59%|█████▉    | 205/345 [01:26<00:57,  2.45it/s]Computing embeddings:  60%|█████▉    | 206/345 [01:27<00:56,  2.44it/s]Computing embeddings:  60%|██████    | 207/345 [01:27<00:56,  2.45it/s]Computing embeddings:  60%|██████    | 208/345 [01:28<00:55,  2.46it/s]Computing embeddings:  61%|██████    | 209/345 [01:28<00:55,  2.46it/s]Computing embeddings:  61%|██████    | 210/345 [01:28<00:54,  2.45it/s]Computing embeddings:  61%|██████    | 211/345 [01:29<00:54,  2.47it/s]Computing embeddings:  61%|██████▏   | 212/345 [01:29<00:56,  2.37it/s]Computing embeddings:  62%|██████▏   | 213/345 [01:30<00:57,  2.29it/s]Computing embeddings:  62%|██████▏   | 214/345 [01:30<00:58,  2.24it/s]Computing embeddings:  62%|██████▏   | 215/345 [01:31<01:00,  2.13it/s]Computing embeddings:  63%|██████▎   | 216/345 [01:31<01:02,  2.06it/s]Computing embeddings:  63%|██████▎   | 217/345 [01:32<01:03,  2.01it/s]Computing embeddings:  63%|██████▎   | 218/345 [01:32<01:04,  1.98it/s]Computing embeddings:  63%|██████▎   | 219/345 [01:33<01:04,  1.96it/s]Computing embeddings:  64%|██████▍   | 220/345 [01:33<01:04,  1.95it/s]Computing embeddings:  64%|██████▍   | 221/345 [01:34<01:03,  1.94it/s]Computing embeddings:  64%|██████▍   | 222/345 [01:34<01:03,  1.93it/s]Computing embeddings:  65%|██████▍   | 223/345 [01:35<01:03,  1.92it/s]Computing embeddings:  65%|██████▍   | 224/345 [01:35<01:02,  1.92it/s]Computing embeddings:  65%|██████▌   | 225/345 [01:36<01:02,  1.92it/s]Computing embeddings:  66%|██████▌   | 226/345 [01:36<01:01,  1.92it/s]Computing embeddings:  66%|██████▌   | 227/345 [01:37<01:01,  1.92it/s]Computing embeddings:  66%|██████▌   | 228/345 [01:38<01:00,  1.92it/s]Computing embeddings:  66%|██████▋   | 229/345 [01:38<01:00,  1.92it/s]Computing embeddings:  67%|██████▋   | 230/345 [01:39<00:59,  1.92it/s]Computing embeddings:  67%|██████▋   | 231/345 [01:39<00:59,  1.92it/s]Computing embeddings:  67%|██████▋   | 232/345 [01:39<00:54,  2.06it/s]Computing embeddings:  68%|██████▊   | 233/345 [01:40<00:51,  2.17it/s]Computing embeddings:  68%|██████▊   | 234/345 [01:40<00:49,  2.26it/s]Computing embeddings:  68%|██████▊   | 235/345 [01:41<00:47,  2.32it/s]Computing embeddings:  68%|██████▊   | 236/345 [01:41<00:45,  2.37it/s]Computing embeddings:  69%|██████▊   | 237/345 [01:41<00:41,  2.57it/s]Computing embeddings:  69%|██████▉   | 238/345 [01:42<00:40,  2.62it/s]Computing embeddings:  69%|██████▉   | 239/345 [01:42<00:41,  2.57it/s]Computing embeddings:  70%|██████▉   | 240/345 [01:43<00:42,  2.45it/s]Computing embeddings:  70%|██████▉   | 241/345 [01:43<00:43,  2.37it/s]Computing embeddings:  70%|███████   | 242/345 [01:44<00:44,  2.32it/s]Computing embeddings:  70%|███████   | 243/345 [01:44<00:42,  2.42it/s]Computing embeddings:  71%|███████   | 244/345 [01:44<00:44,  2.29it/s]Computing embeddings:  71%|███████   | 245/345 [01:45<00:46,  2.16it/s]Computing embeddings:  71%|███████▏  | 246/345 [01:45<00:47,  2.08it/s]Computing embeddings:  72%|███████▏  | 247/345 [01:46<00:48,  2.03it/s]Computing embeddings:  72%|███████▏  | 248/345 [01:46<00:48,  2.00it/s]Computing embeddings:  72%|███████▏  | 249/345 [01:47<00:48,  1.97it/s]Computing embeddings:  72%|███████▏  | 250/345 [01:48<00:48,  1.95it/s]Computing embeddings:  73%|███████▎  | 251/345 [01:48<00:48,  1.94it/s]Computing embeddings:  73%|███████▎  | 252/345 [01:49<00:48,  1.93it/s]Computing embeddings:  73%|███████▎  | 253/345 [01:49<00:47,  1.92it/s]Computing embeddings:  74%|███████▎  | 254/345 [01:50<00:47,  1.92it/s]Computing embeddings:  74%|███████▍  | 255/345 [01:50<00:46,  1.93it/s]Computing embeddings:  74%|███████▍  | 256/345 [01:51<00:46,  1.93it/s]Computing embeddings:  74%|███████▍  | 257/345 [01:51<00:45,  1.92it/s]Computing embeddings:  75%|███████▍  | 258/345 [01:52<00:45,  1.92it/s]Computing embeddings:  75%|███████▌  | 259/345 [01:52<00:44,  1.91it/s]Computing embeddings:  75%|███████▌  | 260/345 [01:53<00:44,  1.91it/s]Computing embeddings:  76%|███████▌  | 261/345 [01:53<00:43,  1.91it/s]Computing embeddings:  76%|███████▌  | 262/345 [01:54<00:43,  1.91it/s]Computing embeddings:  76%|███████▌  | 263/345 [01:54<00:40,  2.05it/s]Computing embeddings:  77%|███████▋  | 264/345 [01:55<00:37,  2.17it/s]Computing embeddings:  77%|███████▋  | 265/345 [01:55<00:35,  2.26it/s]Computing embeddings:  77%|███████▋  | 266/345 [01:55<00:32,  2.39it/s]Computing embeddings:  77%|███████▋  | 267/345 [01:56<00:33,  2.34it/s]Computing embeddings:  78%|███████▊  | 268/345 [01:56<00:34,  2.25it/s]Computing embeddings:  78%|███████▊  | 269/345 [01:57<00:34,  2.20it/s]Computing embeddings:  78%|███████▊  | 270/345 [01:57<00:34,  2.17it/s]Computing embeddings:  79%|███████▊  | 271/345 [01:58<00:34,  2.14it/s]Computing embeddings:  79%|███████▉  | 272/345 [01:58<00:34,  2.13it/s]Computing embeddings:  79%|███████▉  | 273/345 [01:59<00:33,  2.12it/s]Computing embeddings:  79%|███████▉  | 274/345 [01:59<00:33,  2.10it/s]Computing embeddings:  80%|███████▉  | 275/345 [02:00<00:33,  2.09it/s]Computing embeddings:  80%|████████  | 276/345 [02:00<00:33,  2.09it/s]Computing embeddings:  80%|████████  | 277/345 [02:01<00:32,  2.09it/s]Computing embeddings:  81%|████████  | 278/345 [02:01<00:32,  2.09it/s]Computing embeddings:  81%|████████  | 279/345 [02:02<00:31,  2.09it/s]Computing embeddings:  81%|████████  | 280/345 [02:02<00:31,  2.09it/s]Computing embeddings:  81%|████████▏ | 281/345 [02:03<00:30,  2.09it/s]Computing embeddings:  82%|████████▏ | 282/345 [02:03<00:30,  2.09it/s]Computing embeddings:  82%|████████▏ | 283/345 [02:03<00:29,  2.09it/s]Computing embeddings:  82%|████████▏ | 284/345 [02:04<00:29,  2.09it/s]Computing embeddings:  83%|████████▎ | 285/345 [02:04<00:28,  2.09it/s]Computing embeddings:  83%|████████▎ | 286/345 [02:05<00:28,  2.09it/s]Computing embeddings:  83%|████████▎ | 287/345 [02:05<00:27,  2.08it/s]Computing embeddings:  83%|████████▎ | 288/345 [02:06<00:27,  2.08it/s]Computing embeddings:  84%|████████▍ | 289/345 [02:06<00:26,  2.08it/s]Computing embeddings:  84%|████████▍ | 290/345 [02:07<00:26,  2.09it/s]Computing embeddings:  84%|████████▍ | 291/345 [02:07<00:25,  2.08it/s]Computing embeddings:  85%|████████▍ | 292/345 [02:08<00:25,  2.09it/s]Computing embeddings:  85%|████████▍ | 293/345 [02:08<00:24,  2.09it/s]Computing embeddings:  85%|████████▌ | 294/345 [02:09<00:24,  2.08it/s]Computing embeddings:  86%|████████▌ | 295/345 [02:09<00:23,  2.09it/s]Computing embeddings:  86%|████████▌ | 296/345 [02:10<00:23,  2.09it/s]Computing embeddings:  86%|████████▌ | 297/345 [02:10<00:23,  2.09it/s]Computing embeddings:  86%|████████▋ | 298/345 [02:11<00:22,  2.09it/s]Computing embeddings:  87%|████████▋ | 299/345 [02:11<00:22,  2.09it/s]Computing embeddings:  87%|████████▋ | 300/345 [02:12<00:21,  2.08it/s]Computing embeddings:  87%|████████▋ | 301/345 [02:12<00:21,  2.08it/s]Computing embeddings:  88%|████████▊ | 302/345 [02:13<00:20,  2.08it/s]Computing embeddings:  88%|████████▊ | 303/345 [02:13<00:20,  2.08it/s]Computing embeddings:  88%|████████▊ | 304/345 [02:14<00:19,  2.08it/s]Computing embeddings:  88%|████████▊ | 305/345 [02:14<00:19,  2.08it/s]Computing embeddings:  89%|████████▊ | 306/345 [02:15<00:18,  2.09it/s]Computing embeddings:  89%|████████▉ | 307/345 [02:15<00:18,  2.08it/s]Computing embeddings:  89%|████████▉ | 308/345 [02:15<00:17,  2.08it/s]Computing embeddings:  90%|████████▉ | 309/345 [02:16<00:17,  2.08it/s]Computing embeddings:  90%|████████▉ | 310/345 [02:16<00:16,  2.08it/s]Computing embeddings:  90%|█████████ | 311/345 [02:17<00:16,  2.09it/s]Computing embeddings:  90%|█████████ | 312/345 [02:17<00:15,  2.09it/s]Computing embeddings:  91%|█████████ | 313/345 [02:18<00:15,  2.09it/s]Computing embeddings:  91%|█████████ | 314/345 [02:18<00:14,  2.09it/s]Computing embeddings:  91%|█████████▏| 315/345 [02:19<00:14,  2.09it/s]Computing embeddings:  92%|█████████▏| 316/345 [02:19<00:13,  2.09it/s]Computing embeddings:  92%|█████████▏| 317/345 [02:20<00:13,  2.09it/s]Computing embeddings:  92%|█████████▏| 318/345 [02:20<00:12,  2.09it/s]Computing embeddings:  92%|█████████▏| 319/345 [02:21<00:12,  2.09it/s]Computing embeddings:  93%|█████████▎| 320/345 [02:21<00:11,  2.09it/s]Computing embeddings:  93%|█████████▎| 321/345 [02:22<00:11,  2.10it/s]Computing embeddings:  93%|█████████▎| 322/345 [02:22<00:11,  2.09it/s]Computing embeddings:  94%|█████████▎| 323/345 [02:23<00:10,  2.09it/s]Computing embeddings:  94%|█████████▍| 324/345 [02:23<00:10,  2.09it/s]Computing embeddings:  94%|█████████▍| 325/345 [02:24<00:09,  2.08it/s]Computing embeddings:  94%|█████████▍| 326/345 [02:24<00:09,  2.09it/s]Computing embeddings:  95%|█████████▍| 327/345 [02:25<00:08,  2.09it/s]Computing embeddings:  95%|█████████▌| 328/345 [02:25<00:08,  2.09it/s]Computing embeddings:  95%|█████████▌| 329/345 [02:26<00:07,  2.08it/s]Computing embeddings:  96%|█████████▌| 330/345 [02:26<00:07,  2.09it/s]Computing embeddings:  96%|█████████▌| 331/345 [02:26<00:06,  2.08it/s]Computing embeddings:  96%|█████████▌| 332/345 [02:27<00:06,  2.08it/s]Computing embeddings:  97%|█████████▋| 333/345 [02:27<00:05,  2.08it/s]Computing embeddings:  97%|█████████▋| 334/345 [02:28<00:05,  2.08it/s]Computing embeddings:  97%|█████████▋| 335/345 [02:28<00:04,  2.08it/s]Computing embeddings:  97%|█████████▋| 336/345 [02:29<00:04,  2.07it/s]Computing embeddings:  98%|█████████▊| 337/345 [02:29<00:03,  2.08it/s]Computing embeddings:  98%|█████████▊| 338/345 [02:30<00:03,  2.09it/s]Computing embeddings:  98%|█████████▊| 339/345 [02:30<00:02,  2.09it/s]Computing embeddings:  99%|█████████▊| 340/345 [02:31<00:02,  2.09it/s]Computing embeddings:  99%|█████████▉| 341/345 [02:31<00:01,  2.10it/s]Computing embeddings:  99%|█████████▉| 342/345 [02:32<00:01,  2.10it/s]Computing embeddings:  99%|█████████▉| 343/345 [02:32<00:00,  2.09it/s]Computing embeddings: 100%|█████████▉| 344/345 [02:33<00:00,  2.09it/s]Computing embeddings: 100%|██████████| 345/345 [02:33<00:00,  2.09it/s]Computing embeddings: 100%|██████████| 345/345 [02:33<00:00,  2.24it/s]

Selecting 25 representative images...

Results for label 'negative':
  Selected 25 images
  Distance range: 23.1719 - 24.8281
  Saved to: selected_gt_cptac_her2_negative.txt
  Saved to: selected_gt_cptac_her2_negative_with_distances.json

============================================================
Processing label: positive
Total images: 336
============================================================

Computing embeddings for 336 images from data/histomorfologico/cptac/her2/label_positive_pred_0...
Computing embeddings:   0%|          | 0/42 [00:00<?, ?it/s]Computing embeddings:   2%|▏         | 1/42 [00:00<00:19,  2.09it/s]Computing embeddings:   5%|▍         | 2/42 [00:00<00:19,  2.09it/s]Computing embeddings:   7%|▋         | 3/42 [00:01<00:18,  2.08it/s]Computing embeddings:  10%|▉         | 4/42 [00:01<00:18,  2.08it/s]Computing embeddings:  12%|█▏        | 5/42 [00:02<00:17,  2.08it/s]Computing embeddings:  14%|█▍        | 6/42 [00:02<00:17,  2.08it/s]Computing embeddings:  17%|█▋        | 7/42 [00:03<00:16,  2.09it/s]Computing embeddings:  19%|█▉        | 8/42 [00:03<00:16,  2.08it/s]Computing embeddings:  21%|██▏       | 9/42 [00:04<00:15,  2.08it/s]Computing embeddings:  24%|██▍       | 10/42 [00:04<00:15,  2.09it/s]Computing embeddings:  26%|██▌       | 11/42 [00:05<00:14,  2.09it/s]Computing embeddings:  29%|██▊       | 12/42 [00:05<00:14,  2.09it/s]Computing embeddings:  31%|███       | 13/42 [00:06<00:13,  2.09it/s]Computing embeddings:  33%|███▎      | 14/42 [00:06<00:13,  2.09it/s]Computing embeddings:  36%|███▌      | 15/42 [00:07<00:12,  2.08it/s]Computing embeddings:  38%|███▊      | 16/42 [00:07<00:12,  2.08it/s]Computing embeddings:  40%|████      | 17/42 [00:08<00:12,  2.08it/s]Computing embeddings:  43%|████▎     | 18/42 [00:08<00:11,  2.08it/s]Computing embeddings:  45%|████▌     | 19/42 [00:09<00:11,  2.08it/s]Computing embeddings:  48%|████▊     | 20/42 [00:09<00:10,  2.07it/s]Computing embeddings:  50%|█████     | 21/42 [00:10<00:10,  2.09it/s]Computing embeddings:  52%|█████▏    | 22/42 [00:10<00:09,  2.09it/s]Computing embeddings:  55%|█████▍    | 23/42 [00:11<00:09,  2.09it/s]Computing embeddings:  57%|█████▋    | 24/42 [00:11<00:08,  2.09it/s]Computing embeddings:  60%|█████▉    | 25/42 [00:11<00:08,  2.08it/s]Computing embeddings:  62%|██████▏   | 26/42 [00:12<00:07,  2.07it/s]Computing embeddings:  64%|██████▍   | 27/42 [00:12<00:07,  2.08it/s]Computing embeddings:  67%|██████▋   | 28/42 [00:13<00:06,  2.08it/s]Computing embeddings:  69%|██████▉   | 29/42 [00:13<00:06,  2.08it/s]Computing embeddings:  71%|███████▏  | 30/42 [00:14<00:05,  2.09it/s]Computing embeddings:  74%|███████▍  | 31/42 [00:14<00:05,  2.09it/s]Computing embeddings:  76%|███████▌  | 32/42 [00:15<00:04,  2.09it/s]Computing embeddings:  79%|███████▊  | 33/42 [00:15<00:04,  2.09it/s]Computing embeddings:  81%|████████  | 34/42 [00:16<00:03,  2.09it/s]Computing embeddings:  83%|████████▎ | 35/42 [00:16<00:03,  2.08it/s]Computing embeddings:  86%|████████▌ | 36/42 [00:17<00:02,  2.08it/s]Computing embeddings:  88%|████████▊ | 37/42 [00:17<00:02,  2.08it/s]Computing embeddings:  90%|█████████ | 38/42 [00:18<00:01,  2.08it/s]Computing embeddings:  93%|█████████▎| 39/42 [00:18<00:01,  2.08it/s]Computing embeddings:  95%|█████████▌| 40/42 [00:19<00:00,  2.08it/s]Computing embeddings:  98%|█████████▊| 41/42 [00:19<00:00,  2.07it/s]Computing embeddings: 100%|██████████| 42/42 [00:20<00:00,  2.08it/s]Computing embeddings: 100%|██████████| 42/42 [00:20<00:00,  2.08it/s]

Selecting 25 representative images...

Results for label 'positive':
  Selected 25 images
  Distance range: 23.3750 - 26.4219
  Saved to: selected_gt_cptac_her2_positive.txt
  Saved to: selected_gt_cptac_her2_positive_with_distances.json

============================================================
Done!
============================================================

Processing PR dataset...
Found 4 label directories
Loaded CSV with 367 entries
Created label mapping for 367 slide IDs

Scanning directory: data/histomorfologico/cptac/pr/label_negative_pred_1
  Found 584 images

Scanning directory: data/histomorfologico/cptac/pr/label_positive_pred_1
  Found 1512 images

Scanning directory: data/histomorfologico/cptac/pr/label_positive_pred_0
  Found 128 images

Scanning directory: data/histomorfologico/cptac/pr/label_negative_pred_0
  Found 768 images

============================================================
Images grouped by ground truth label:
  negative: 1352 images
  positive: 1640 images
Total images: 2992
Not found in CSV: 0
============================================================

Loading Virchow v2 model...

============================================================
Processing label: negative
Total images: 1352
============================================================

Computing embeddings for 584 images from data/histomorfologico/cptac/pr/label_negative_pred_1...
Computing embeddings:   0%|          | 0/73 [00:00<?, ?it/s]Computing embeddings:   1%|▏         | 1/73 [00:00<00:36,  2.00it/s]Computing embeddings:   3%|▎         | 2/73 [00:00<00:27,  2.60it/s]Computing embeddings:   4%|▍         | 3/73 [00:01<00:24,  2.81it/s]Computing embeddings:   5%|▌         | 4/73 [00:01<00:23,  2.89it/s]Computing embeddings:   7%|▋         | 5/73 [00:01<00:23,  2.89it/s]Computing embeddings:   8%|▊         | 6/73 [00:02<00:23,  2.88it/s]Computing embeddings:  10%|▉         | 7/73 [00:02<00:22,  2.87it/s]Computing embeddings:  11%|█         | 8/73 [00:02<00:21,  3.00it/s]Computing embeddings:  12%|█▏        | 9/73 [00:03<00:21,  2.97it/s]Computing embeddings:  14%|█▎        | 10/73 [00:03<00:21,  2.91it/s]Computing embeddings:  15%|█▌        | 11/73 [00:03<00:20,  2.96it/s]Computing embeddings:  16%|█▋        | 12/73 [00:04<00:25,  2.40it/s]Computing embeddings:  18%|█▊        | 13/73 [00:04<00:25,  2.34it/s]Computing embeddings:  19%|█▉        | 14/73 [00:05<00:25,  2.30it/s]Computing embeddings:  21%|██        | 15/73 [00:05<00:25,  2.24it/s]Computing embeddings:  22%|██▏       | 16/73 [00:06<00:25,  2.22it/s]Computing embeddings:  23%|██▎       | 17/73 [00:06<00:25,  2.22it/s]Computing embeddings:  25%|██▍       | 18/73 [00:07<00:24,  2.21it/s]Computing embeddings:  26%|██▌       | 19/73 [00:07<00:24,  2.21it/s]Computing embeddings:  27%|██▋       | 20/73 [00:08<00:24,  2.20it/s]Computing embeddings:  29%|██▉       | 21/73 [00:08<00:22,  2.31it/s]Computing embeddings:  30%|███       | 22/73 [00:08<00:21,  2.39it/s]Computing embeddings:  32%|███▏      | 23/73 [00:09<00:19,  2.54it/s]Computing embeddings:  33%|███▎      | 24/73 [00:09<00:18,  2.61it/s]Computing embeddings:  34%|███▍      | 25/73 [00:09<00:18,  2.64it/s]Computing embeddings:  36%|███▌      | 26/73 [00:10<00:17,  2.61it/s]Computing embeddings:  37%|███▋      | 27/73 [00:10<00:18,  2.50it/s]Computing embeddings:  38%|███▊      | 28/73 [00:11<00:18,  2.43it/s]Computing embeddings:  40%|███▉      | 29/73 [00:11<00:18,  2.39it/s]Computing embeddings:  41%|████      | 30/73 [00:12<00:18,  2.36it/s]Computing embeddings:  42%|████▏     | 31/73 [00:12<00:17,  2.34it/s]Computing embeddings:  44%|████▍     | 32/73 [00:12<00:17,  2.32it/s]Computing embeddings:  45%|████▌     | 33/73 [00:13<00:17,  2.31it/s]Computing embeddings:  47%|████▋     | 34/73 [00:13<00:16,  2.30it/s]Computing embeddings:  48%|████▊     | 35/73 [00:14<00:16,  2.29it/s]Computing embeddings:  49%|████▉     | 36/73 [00:14<00:16,  2.29it/s]Computing embeddings:  51%|█████     | 37/73 [00:15<00:15,  2.29it/s]Computing embeddings:  52%|█████▏    | 38/73 [00:15<00:15,  2.29it/s]Computing embeddings:  53%|█████▎    | 39/73 [00:15<00:14,  2.29it/s]Computing embeddings:  55%|█████▍    | 40/73 [00:16<00:13,  2.37it/s]Computing embeddings:  56%|█████▌    | 41/73 [00:16<00:14,  2.18it/s]Computing embeddings:  58%|█████▊    | 42/73 [00:17<00:15,  2.00it/s]Computing embeddings:  59%|█████▉    | 43/73 [00:18<00:15,  1.89it/s]Computing embeddings:  60%|██████    | 44/73 [00:18<00:15,  1.81it/s]Computing embeddings:  62%|██████▏   | 45/73 [00:19<00:14,  1.93it/s]Computing embeddings:  63%|██████▎   | 46/73 [00:19<00:13,  2.04it/s]Computing embeddings:  64%|██████▍   | 47/73 [00:20<00:12,  2.12it/s]Computing embeddings:  66%|██████▌   | 48/73 [00:20<00:11,  2.18it/s]Computing embeddings:  67%|██████▋   | 49/73 [00:20<00:11,  2.10it/s]Computing embeddings:  68%|██████▊   | 50/73 [00:21<00:11,  1.99it/s]Computing embeddings:  70%|██████▉   | 51/73 [00:22<00:11,  1.91it/s]Computing embeddings:  71%|███████   | 52/73 [00:22<00:11,  1.86it/s]Computing embeddings:  73%|███████▎  | 53/73 [00:23<00:10,  1.83it/s]Computing embeddings:  74%|███████▍  | 54/73 [00:23<00:10,  1.82it/s]Computing embeddings:  75%|███████▌  | 55/73 [00:24<00:09,  1.80it/s]Computing embeddings:  77%|███████▋  | 56/73 [00:24<00:09,  1.79it/s]Computing embeddings:  78%|███████▊  | 57/73 [00:25<00:08,  1.78it/s]Computing embeddings:  79%|███████▉  | 58/73 [00:26<00:08,  1.79it/s]Computing embeddings:  81%|████████  | 59/73 [00:26<00:07,  1.79it/s]Computing embeddings:  82%|████████▏ | 60/73 [00:27<00:07,  1.79it/s]Computing embeddings:  84%|████████▎ | 61/73 [00:27<00:06,  1.79it/s]Computing embeddings:  85%|████████▍ | 62/73 [00:28<00:06,  1.79it/s]Computing embeddings:  86%|████████▋ | 63/73 [00:28<00:05,  1.79it/s]Computing embeddings:  88%|████████▊ | 64/73 [00:29<00:05,  1.79it/s]Computing embeddings:  89%|████████▉ | 65/73 [00:29<00:04,  1.80it/s]Computing embeddings:  90%|█████████ | 66/73 [00:30<00:03,  1.79it/s]Computing embeddings:  92%|█████████▏| 67/73 [00:31<00:03,  1.78it/s]Computing embeddings:  93%|█████████▎| 68/73 [00:31<00:02,  1.79it/s]Computing embeddings:  95%|█████████▍| 69/73 [00:32<00:02,  1.93it/s]Computing embeddings:  96%|█████████▌| 70/73 [00:32<00:01,  2.05it/s]Computing embeddings:  97%|█████████▋| 71/73 [00:32<00:00,  2.15it/s]Computing embeddings:  99%|█████████▊| 72/73 [00:33<00:00,  2.22it/s]Computing embeddings: 100%|██████████| 73/73 [00:33<00:00,  2.27it/s]Computing embeddings: 100%|██████████| 73/73 [00:33<00:00,  2.16it/s]

Computing embeddings for 768 images from data/histomorfologico/cptac/pr/label_negative_pred_0...
Computing embeddings:   0%|          | 0/96 [00:00<?, ?it/s]Computing embeddings:   1%|          | 1/96 [00:00<00:39,  2.39it/s]Computing embeddings:   2%|▏         | 2/96 [00:00<00:39,  2.41it/s]Computing embeddings:   3%|▎         | 3/96 [00:01<00:38,  2.39it/s]Computing embeddings:   4%|▍         | 4/96 [00:01<00:38,  2.40it/s]Computing embeddings:   5%|▌         | 5/96 [00:02<00:37,  2.40it/s]Computing embeddings:   6%|▋         | 6/96 [00:02<00:37,  2.40it/s]Computing embeddings:   7%|▋         | 7/96 [00:02<00:37,  2.40it/s]Computing embeddings:   8%|▊         | 8/96 [00:03<00:36,  2.41it/s]Computing embeddings:   9%|▉         | 9/96 [00:03<00:39,  2.22it/s]Computing embeddings:  10%|█         | 10/96 [00:04<00:41,  2.05it/s]Computing embeddings:  11%|█▏        | 11/96 [00:04<00:43,  1.95it/s]Computing embeddings:  12%|█▎        | 12/96 [00:05<00:44,  1.89it/s]Computing embeddings:  14%|█▎        | 13/96 [00:06<00:44,  1.86it/s]Computing embeddings:  15%|█▍        | 14/96 [00:06<00:44,  1.83it/s]Computing embeddings:  16%|█▌        | 15/96 [00:07<00:41,  1.95it/s]Computing embeddings:  17%|█▋        | 16/96 [00:07<00:39,  2.05it/s]Computing embeddings:  18%|█▊        | 17/96 [00:07<00:37,  2.12it/s]Computing embeddings:  19%|█▉        | 18/96 [00:08<00:35,  2.18it/s]Computing embeddings:  20%|█▉        | 19/96 [00:08<00:34,  2.22it/s]Computing embeddings:  21%|██        | 20/96 [00:09<00:33,  2.27it/s]Computing embeddings:  22%|██▏       | 21/96 [00:09<00:35,  2.13it/s]Computing embeddings:  23%|██▎       | 22/96 [00:10<00:37,  1.99it/s]Computing embeddings:  24%|██▍       | 23/96 [00:10<00:38,  1.88it/s]Computing embeddings:  25%|██▌       | 24/96 [00:11<00:39,  1.83it/s]Computing embeddings:  26%|██▌       | 25/96 [00:12<00:39,  1.79it/s]Computing embeddings:  27%|██▋       | 26/96 [00:12<00:39,  1.77it/s]Computing embeddings:  28%|██▊       | 27/96 [00:13<00:39,  1.76it/s]Computing embeddings:  29%|██▉       | 28/96 [00:13<00:38,  1.74it/s]Computing embeddings:  30%|███       | 29/96 [00:14<00:38,  1.74it/s]Computing embeddings:  31%|███▏      | 30/96 [00:15<00:38,  1.73it/s]Computing embeddings:  32%|███▏      | 31/96 [00:15<00:37,  1.73it/s]Computing embeddings:  33%|███▎      | 32/96 [00:16<00:36,  1.73it/s]Computing embeddings:  34%|███▍      | 33/96 [00:16<00:36,  1.72it/s]Computing embeddings:  35%|███▌      | 34/96 [00:17<00:36,  1.72it/s]Computing embeddings:  36%|███▋      | 35/96 [00:17<00:35,  1.71it/s]Computing embeddings:  38%|███▊      | 36/96 [00:18<00:32,  1.86it/s]Computing embeddings:  39%|███▊      | 37/96 [00:18<00:29,  1.98it/s]Computing embeddings:  40%|███▉      | 38/96 [00:19<00:27,  2.08it/s]Computing embeddings:  41%|████      | 39/96 [00:19<00:26,  2.16it/s]Computing embeddings:  42%|████▏     | 40/96 [00:20<00:25,  2.21it/s]Computing embeddings:  43%|████▎     | 41/96 [00:20<00:24,  2.25it/s]Computing embeddings:  44%|████▍     | 42/96 [00:20<00:23,  2.28it/s]Computing embeddings:  45%|████▍     | 43/96 [00:21<00:22,  2.31it/s]Computing embeddings:  46%|████▌     | 44/96 [00:21<00:22,  2.32it/s]Computing embeddings:  47%|████▋     | 45/96 [00:22<00:21,  2.39it/s]Computing embeddings:  48%|████▊     | 46/96 [00:22<00:22,  2.25it/s]Computing embeddings:  49%|████▉     | 47/96 [00:23<00:23,  2.11it/s]Computing embeddings:  50%|█████     | 48/96 [00:23<00:23,  2.02it/s]Computing embeddings:  51%|█████     | 49/96 [00:24<00:24,  1.95it/s]Computing embeddings:  52%|█████▏    | 50/96 [00:24<00:24,  1.91it/s]Computing embeddings:  53%|█████▎    | 51/96 [00:25<00:23,  1.89it/s]Computing embeddings:  54%|█████▍    | 52/96 [00:25<00:23,  1.87it/s]Computing embeddings:  55%|█████▌    | 53/96 [00:26<00:23,  1.86it/s]Computing embeddings:  56%|█████▋    | 54/96 [00:27<00:22,  1.84it/s]Computing embeddings:  57%|█████▋    | 55/96 [00:27<00:22,  1.83it/s]Computing embeddings:  58%|█████▊    | 56/96 [00:28<00:22,  1.81it/s]Computing embeddings:  59%|█████▉    | 57/96 [00:28<00:20,  1.94it/s]Computing embeddings:  60%|██████    | 58/96 [00:29<00:18,  2.05it/s]Computing embeddings:  61%|██████▏   | 59/96 [00:29<00:17,  2.13it/s]Computing embeddings:  62%|██████▎   | 60/96 [00:29<00:16,  2.19it/s]Computing embeddings:  64%|██████▎   | 61/96 [00:30<00:15,  2.23it/s]Computing embeddings:  65%|██████▍   | 62/96 [00:30<00:15,  2.14it/s]Computing embeddings:  66%|██████▌   | 63/96 [00:31<00:16,  2.02it/s]Computing embeddings:  67%|██████▋   | 64/96 [00:31<00:16,  1.96it/s]Computing embeddings:  68%|██████▊   | 65/96 [00:32<00:16,  1.91it/s]Computing embeddings:  69%|██████▉   | 66/96 [00:33<00:15,  1.89it/s]Computing embeddings:  70%|██████▉   | 67/96 [00:33<00:15,  1.86it/s]Computing embeddings:  71%|███████   | 68/96 [00:34<00:15,  1.84it/s]Computing embeddings:  72%|███████▏  | 69/96 [00:34<00:14,  1.84it/s]Computing embeddings:  73%|███████▎  | 70/96 [00:35<00:14,  1.83it/s]Computing embeddings:  74%|███████▍  | 71/96 [00:35<00:13,  1.83it/s]Computing embeddings:  75%|███████▌  | 72/96 [00:36<00:13,  1.83it/s]Computing embeddings:  76%|███████▌  | 73/96 [00:36<00:12,  1.83it/s]Computing embeddings:  77%|███████▋  | 74/96 [00:37<00:12,  1.83it/s]Computing embeddings:  78%|███████▊  | 75/96 [00:37<00:11,  1.83it/s]Computing embeddings:  79%|███████▉  | 76/96 [00:38<00:10,  1.82it/s]Computing embeddings:  80%|████████  | 77/96 [00:39<00:10,  1.82it/s]Computing embeddings:  81%|████████▏ | 78/96 [00:39<00:09,  1.81it/s]Computing embeddings:  82%|████████▏ | 79/96 [00:40<00:09,  1.81it/s]Computing embeddings:  83%|████████▎ | 80/96 [00:40<00:08,  1.81it/s]Computing embeddings:  84%|████████▍ | 81/96 [00:41<00:08,  1.81it/s]Computing embeddings:  85%|████████▌ | 82/96 [00:41<00:07,  1.96it/s]Computing embeddings:  86%|████████▋ | 83/96 [00:42<00:06,  2.08it/s]Computing embeddings:  88%|████████▊ | 84/96 [00:42<00:05,  2.17it/s]Computing embeddings:  89%|████████▊ | 85/96 [00:42<00:04,  2.24it/s]Computing embeddings:  90%|████████▉ | 86/96 [00:43<00:04,  2.28it/s]Computing embeddings:  91%|█████████ | 87/96 [00:43<00:03,  2.32it/s]Computing embeddings:  92%|█████████▏| 88/96 [00:44<00:03,  2.36it/s]Computing embeddings:  93%|█████████▎| 89/96 [00:44<00:02,  2.37it/s]Computing embeddings:  94%|█████████▍| 90/96 [00:45<00:02,  2.38it/s]Computing embeddings:  95%|█████████▍| 91/96 [00:45<00:02,  2.39it/s]Computing embeddings:  96%|█████████▌| 92/96 [00:45<00:01,  2.39it/s]Computing embeddings:  97%|█████████▋| 93/96 [00:46<00:01,  2.27it/s]Computing embeddings:  98%|█████████▊| 94/96 [00:46<00:00,  2.11it/s]Computing embeddings:  99%|█████████▉| 95/96 [00:47<00:00,  2.01it/s]Computing embeddings: 100%|██████████| 96/96 [00:48<00:00,  1.95it/s]Computing embeddings: 100%|██████████| 96/96 [00:48<00:00,  2.00it/s]

Selecting 25 representative images...

Results for label 'negative':
  Selected 25 images
  Distance range: 24.3906 - 26.1250
  Saved to: selected_gt_cptac_pr_negative.txt
  Saved to: selected_gt_cptac_pr_negative_with_distances.json

============================================================
Processing label: positive
Total images: 1640
============================================================

Computing embeddings for 1512 images from data/histomorfologico/cptac/pr/label_positive_pred_1...
Computing embeddings:   0%|          | 0/189 [00:00<?, ?it/s]Computing embeddings:   1%|          | 1/189 [00:00<01:42,  1.83it/s]Computing embeddings:   1%|          | 2/189 [00:01<01:44,  1.79it/s]Computing embeddings:   2%|▏         | 3/189 [00:01<01:42,  1.82it/s]Computing embeddings:   2%|▏         | 4/189 [00:02<01:41,  1.83it/s]Computing embeddings:   3%|▎         | 5/189 [00:02<01:40,  1.83it/s]Computing embeddings:   3%|▎         | 6/189 [00:03<01:40,  1.81it/s]Computing embeddings:   4%|▎         | 7/189 [00:03<01:39,  1.83it/s]Computing embeddings:   4%|▍         | 8/189 [00:04<01:38,  1.83it/s]Computing embeddings:   5%|▍         | 9/189 [00:04<01:38,  1.83it/s]Computing embeddings:   5%|▌         | 10/189 [00:05<01:37,  1.83it/s]Computing embeddings:   6%|▌         | 11/189 [00:06<01:37,  1.83it/s]Computing embeddings:   6%|▋         | 12/189 [00:06<01:36,  1.83it/s]Computing embeddings:   7%|▋         | 13/189 [00:07<01:36,  1.83it/s]Computing embeddings:   7%|▋         | 14/189 [00:07<01:35,  1.83it/s]Computing embeddings:   8%|▊         | 15/189 [00:08<01:34,  1.83it/s]Computing embeddings:   8%|▊         | 16/189 [00:08<01:34,  1.82it/s]Computing embeddings:   9%|▉         | 17/189 [00:09<01:35,  1.81it/s]Computing embeddings:  10%|▉         | 18/189 [00:09<01:34,  1.81it/s]Computing embeddings:  10%|█         | 19/189 [00:10<01:33,  1.81it/s]Computing embeddings:  11%|█         | 20/189 [00:10<01:32,  1.82it/s]Computing embeddings:  11%|█         | 21/189 [00:11<01:32,  1.82it/s]Computing embeddings:  12%|█▏        | 22/189 [00:11<01:24,  1.97it/s]Computing embeddings:  12%|█▏        | 23/189 [00:12<01:19,  2.09it/s]Computing embeddings:  13%|█▎        | 24/189 [00:12<01:15,  2.18it/s]Computing embeddings:  13%|█▎        | 25/189 [00:13<01:12,  2.25it/s]Computing embeddings:  14%|█▍        | 26/189 [00:13<01:10,  2.31it/s]Computing embeddings:  14%|█▍        | 27/189 [00:13<01:09,  2.35it/s]Computing embeddings:  15%|█▍        | 28/189 [00:14<01:07,  2.38it/s]Computing embeddings:  15%|█▌        | 29/189 [00:14<01:06,  2.40it/s]Computing embeddings:  16%|█▌        | 30/189 [00:15<01:05,  2.41it/s]Computing embeddings:  16%|█▋        | 31/189 [00:15<01:05,  2.42it/s]Computing embeddings:  17%|█▋        | 32/189 [00:16<01:04,  2.43it/s]Computing embeddings:  17%|█▋        | 33/189 [00:16<01:04,  2.42it/s]Computing embeddings:  18%|█▊        | 34/189 [00:16<01:03,  2.43it/s]Computing embeddings:  19%|█▊        | 35/189 [00:17<01:05,  2.36it/s]Computing embeddings:  19%|█▉        | 36/189 [00:17<01:10,  2.18it/s]Computing embeddings:  20%|█▉        | 37/189 [00:18<01:13,  2.07it/s]Computing embeddings:  20%|██        | 38/189 [00:18<01:15,  2.00it/s]Computing embeddings:  21%|██        | 39/189 [00:19<01:16,  1.95it/s]Computing embeddings:  21%|██        | 40/189 [00:20<01:17,  1.92it/s]Computing embeddings:  22%|██▏       | 41/189 [00:20<01:17,  1.90it/s]Computing embeddings:  22%|██▏       | 42/189 [00:21<01:18,  1.88it/s]Computing embeddings:  23%|██▎       | 43/189 [00:21<01:18,  1.87it/s]Computing embeddings:  23%|██▎       | 44/189 [00:22<01:17,  1.86it/s]Computing embeddings:  24%|██▍       | 45/189 [00:22<01:17,  1.85it/s]Computing embeddings:  24%|██▍       | 46/189 [00:23<01:17,  1.85it/s]Computing embeddings:  25%|██▍       | 47/189 [00:23<01:16,  1.85it/s]Computing embeddings:  25%|██▌       | 48/189 [00:24<01:16,  1.85it/s]Computing embeddings:  26%|██▌       | 49/189 [00:24<01:15,  1.85it/s]Computing embeddings:  26%|██▋       | 50/189 [00:25<01:15,  1.85it/s]Computing embeddings:  27%|██▋       | 51/189 [00:25<01:14,  1.85it/s]Computing embeddings:  28%|██▊       | 52/189 [00:26<01:14,  1.85it/s]Computing embeddings:  28%|██▊       | 53/189 [00:27<01:13,  1.85it/s]Computing embeddings:  29%|██▊       | 54/189 [00:27<01:12,  1.85it/s]Computing embeddings:  29%|██▉       | 55/189 [00:28<01:12,  1.85it/s]Computing embeddings:  30%|██▉       | 56/189 [00:28<01:11,  1.85it/s]Computing embeddings:  30%|███       | 57/189 [00:29<01:11,  1.85it/s]Computing embeddings:  31%|███       | 58/189 [00:29<01:10,  1.85it/s]Computing embeddings:  31%|███       | 59/189 [00:30<01:10,  1.85it/s]Computing embeddings:  32%|███▏      | 60/189 [00:30<01:09,  1.86it/s]Computing embeddings:  32%|███▏      | 61/189 [00:31<01:09,  1.85it/s]Computing embeddings:  33%|███▎      | 62/189 [00:31<01:08,  1.86it/s]Computing embeddings:  33%|███▎      | 63/189 [00:32<01:07,  1.86it/s]Computing embeddings:  34%|███▍      | 64/189 [00:32<01:07,  1.87it/s]Computing embeddings:  34%|███▍      | 65/189 [00:33<01:06,  1.86it/s]Computing embeddings:  35%|███▍      | 66/189 [00:34<01:06,  1.86it/s]Computing embeddings:  35%|███▌      | 67/189 [00:34<01:05,  1.86it/s]Computing embeddings:  36%|███▌      | 68/189 [00:35<01:05,  1.86it/s]Computing embeddings:  37%|███▋      | 69/189 [00:35<01:04,  1.86it/s]Computing embeddings:  37%|███▋      | 70/189 [00:36<01:03,  1.86it/s]Computing embeddings:  38%|███▊      | 71/189 [00:36<01:03,  1.86it/s]Computing embeddings:  38%|███▊      | 72/189 [00:37<01:02,  1.86it/s]Computing embeddings:  39%|███▊      | 73/189 [00:37<01:02,  1.86it/s]Computing embeddings:  39%|███▉      | 74/189 [00:38<01:01,  1.86it/s]Computing embeddings:  40%|███▉      | 75/189 [00:38<01:01,  1.85it/s]Computing embeddings:  40%|████      | 76/189 [00:39<01:01,  1.85it/s]Computing embeddings:  41%|████      | 77/189 [00:39<01:00,  1.85it/s]Computing embeddings:  41%|████▏     | 78/189 [00:40<01:00,  1.85it/s]Computing embeddings:  42%|████▏     | 79/189 [00:41<00:59,  1.85it/s]Computing embeddings:  42%|████▏     | 80/189 [00:41<00:58,  1.86it/s]Computing embeddings:  43%|████▎     | 81/189 [00:42<00:58,  1.86it/s]Computing embeddings:  43%|████▎     | 82/189 [00:42<00:57,  1.86it/s]Computing embeddings:  44%|████▍     | 83/189 [00:43<00:57,  1.86it/s]Computing embeddings:  44%|████▍     | 84/189 [00:43<00:56,  1.86it/s]Computing embeddings:  45%|████▍     | 85/189 [00:44<00:55,  1.86it/s]Computing embeddings:  46%|████▌     | 86/189 [00:44<00:55,  1.84it/s]Computing embeddings:  46%|████▌     | 87/189 [00:45<00:55,  1.85it/s]Computing embeddings:  47%|████▋     | 88/189 [00:45<00:54,  1.85it/s]Computing embeddings:  47%|████▋     | 89/189 [00:46<00:54,  1.85it/s]Computing embeddings:  48%|████▊     | 90/189 [00:46<00:53,  1.86it/s]Computing embeddings:  48%|████▊     | 91/189 [00:47<00:48,  2.00it/s]Computing embeddings:  49%|████▊     | 92/189 [00:47<00:45,  2.12it/s]Computing embeddings:  49%|████▉     | 93/189 [00:48<00:43,  2.21it/s]Computing embeddings:  50%|████▉     | 94/189 [00:48<00:41,  2.28it/s]Computing embeddings:  50%|█████     | 95/189 [00:49<00:40,  2.34it/s]Computing embeddings:  51%|█████     | 96/189 [00:49<00:39,  2.37it/s]Computing embeddings:  51%|█████▏    | 97/189 [00:49<00:38,  2.39it/s]Computing embeddings:  52%|█████▏    | 98/189 [00:50<00:37,  2.41it/s]Computing embeddings:  52%|█████▏    | 99/189 [00:50<00:37,  2.43it/s]Computing embeddings:  53%|█████▎    | 100/189 [00:51<00:36,  2.43it/s]Computing embeddings:  53%|█████▎    | 101/189 [00:51<00:36,  2.44it/s]Computing embeddings:  54%|█████▍    | 102/189 [00:51<00:35,  2.45it/s]Computing embeddings:  54%|█████▍    | 103/189 [00:52<00:35,  2.46it/s]Computing embeddings:  55%|█████▌    | 104/189 [00:52<00:36,  2.33it/s]Computing embeddings:  56%|█████▌    | 105/189 [00:53<00:37,  2.25it/s]Computing embeddings:  56%|█████▌    | 106/189 [00:53<00:39,  2.08it/s]Computing embeddings:  57%|█████▋    | 107/189 [00:54<00:42,  1.93it/s]Computing embeddings:  57%|█████▋    | 108/189 [00:55<00:44,  1.84it/s]Computing embeddings:  58%|█████▊    | 109/189 [00:55<00:44,  1.78it/s]Computing embeddings:  58%|█████▊    | 110/189 [00:56<00:45,  1.74it/s]Computing embeddings:  59%|█████▊    | 111/189 [00:56<00:45,  1.71it/s]Computing embeddings:  59%|█████▉    | 112/189 [00:57<00:45,  1.70it/s]Computing embeddings:  60%|█████▉    | 113/189 [00:58<00:45,  1.69it/s]Computing embeddings:  60%|██████    | 114/189 [00:58<00:42,  1.77it/s]Computing embeddings:  61%|██████    | 115/189 [00:59<00:40,  1.85it/s]Computing embeddings:  61%|██████▏   | 116/189 [00:59<00:38,  1.90it/s]Computing embeddings:  62%|██████▏   | 117/189 [00:59<00:37,  1.94it/s]Computing embeddings:  62%|██████▏   | 118/189 [01:00<00:36,  1.96it/s]Computing embeddings:  63%|██████▎   | 119/189 [01:00<00:35,  1.99it/s]Computing embeddings:  63%|██████▎   | 120/189 [01:01<00:34,  2.01it/s]Computing embeddings:  64%|██████▍   | 121/189 [01:01<00:33,  2.02it/s]Computing embeddings:  65%|██████▍   | 122/189 [01:02<00:33,  2.02it/s]Computing embeddings:  65%|██████▌   | 123/189 [01:02<00:32,  2.02it/s]Computing embeddings:  66%|██████▌   | 124/189 [01:03<00:32,  2.02it/s]Computing embeddings:  66%|██████▌   | 125/189 [01:03<00:31,  2.02it/s]Computing embeddings:  67%|██████▋   | 126/189 [01:04<00:31,  2.02it/s]Computing embeddings:  67%|██████▋   | 127/189 [01:04<00:30,  2.03it/s]Computing embeddings:  68%|██████▊   | 128/189 [01:05<00:30,  2.03it/s]Computing embeddings:  68%|██████▊   | 129/189 [01:05<00:29,  2.03it/s]Computing embeddings:  69%|██████▉   | 130/189 [01:06<00:29,  2.03it/s]Computing embeddings:  69%|██████▉   | 131/189 [01:06<00:28,  2.03it/s]Computing embeddings:  70%|██████▉   | 132/189 [01:07<00:27,  2.04it/s]Computing embeddings:  70%|███████   | 133/189 [01:07<00:27,  2.04it/s]Computing embeddings:  71%|███████   | 134/189 [01:08<00:26,  2.04it/s]Computing embeddings:  71%|███████▏  | 135/189 [01:08<00:26,  2.03it/s]Computing embeddings:  72%|███████▏  | 136/189 [01:09<00:26,  2.03it/s]Computing embeddings:  72%|███████▏  | 137/189 [01:09<00:25,  2.03it/s]Computing embeddings:  73%|███████▎  | 138/189 [01:10<00:25,  2.03it/s]Computing embeddings:  74%|███████▎  | 139/189 [01:10<00:24,  2.03it/s]Computing embeddings:  74%|███████▍  | 140/189 [01:11<00:24,  2.03it/s]Computing embeddings:  75%|███████▍  | 141/189 [01:11<00:23,  2.03it/s]Computing embeddings:  75%|███████▌  | 142/189 [01:12<00:23,  2.03it/s]Computing embeddings:  76%|███████▌  | 143/189 [01:12<00:22,  2.03it/s]Computing embeddings:  76%|███████▌  | 144/189 [01:13<00:22,  2.03it/s]Computing embeddings:  77%|███████▋  | 145/189 [01:13<00:21,  2.03it/s]Computing embeddings:  77%|███████▋  | 146/189 [01:14<00:21,  2.03it/s]Computing embeddings:  78%|███████▊  | 147/189 [01:14<00:20,  2.03it/s]Computing embeddings:  78%|███████▊  | 148/189 [01:15<00:20,  2.03it/s]Computing embeddings:  79%|███████▉  | 149/189 [01:15<00:19,  2.03it/s]Computing embeddings:  79%|███████▉  | 150/189 [01:16<00:19,  2.02it/s]Computing embeddings:  80%|███████▉  | 151/189 [01:16<00:18,  2.02it/s]Computing embeddings:  80%|████████  | 152/189 [01:17<00:18,  2.02it/s]Computing embeddings:  81%|████████  | 153/189 [01:17<00:17,  2.02it/s]Computing embeddings:  81%|████████▏ | 154/189 [01:18<00:17,  2.03it/s]Computing embeddings:  82%|████████▏ | 155/189 [01:18<00:17,  1.93it/s]Computing embeddings:  83%|████████▎ | 156/189 [01:19<00:17,  1.84it/s]Computing embeddings:  83%|████████▎ | 157/189 [01:19<00:17,  1.78it/s]Computing embeddings:  84%|████████▎ | 158/189 [01:20<00:17,  1.75it/s]Computing embeddings:  84%|████████▍ | 159/189 [01:21<00:17,  1.73it/s]Computing embeddings:  85%|████████▍ | 160/189 [01:21<00:16,  1.71it/s]Computing embeddings:  85%|████████▌ | 161/189 [01:22<00:16,  1.70it/s]Computing embeddings:  86%|████████▌ | 162/189 [01:22<00:14,  1.83it/s]Computing embeddings:  86%|████████▌ | 163/189 [01:23<00:13,  1.95it/s]Computing embeddings:  87%|████████▋ | 164/189 [01:23<00:12,  2.03it/s]Computing embeddings:  87%|████████▋ | 165/189 [01:24<00:11,  2.09it/s]Computing embeddings:  88%|████████▊ | 166/189 [01:24<00:11,  2.07it/s]Computing embeddings:  88%|████████▊ | 167/189 [01:25<00:10,  2.05it/s]Computing embeddings:  89%|████████▉ | 168/189 [01:25<00:10,  2.03it/s]Computing embeddings:  89%|████████▉ | 169/189 [01:26<00:09,  2.02it/s]Computing embeddings:  90%|████████▉ | 170/189 [01:26<00:09,  2.02it/s]Computing embeddings:  90%|█████████ | 171/189 [01:27<00:08,  2.01it/s]Computing embeddings:  91%|█████████ | 172/189 [01:27<00:08,  2.01it/s]Computing embeddings:  92%|█████████▏| 173/189 [01:28<00:07,  2.00it/s]Computing embeddings:  92%|█████████▏| 174/189 [01:28<00:07,  2.00it/s]Computing embeddings:  93%|█████████▎| 175/189 [01:29<00:07,  2.00it/s]Computing embeddings:  93%|█████████▎| 176/189 [01:29<00:06,  1.99it/s]Computing embeddings:  94%|█████████▎| 177/189 [01:30<00:06,  1.99it/s]Computing embeddings:  94%|█████████▍| 178/189 [01:30<00:05,  1.99it/s]Computing embeddings:  95%|█████████▍| 179/189 [01:31<00:05,  1.99it/s]Computing embeddings:  95%|█████████▌| 180/189 [01:31<00:04,  1.99it/s]Computing embeddings:  96%|█████████▌| 181/189 [01:32<00:04,  1.99it/s]Computing embeddings:  96%|█████████▋| 182/189 [01:32<00:03,  1.99it/s]Computing embeddings:  97%|█████████▋| 183/189 [01:33<00:03,  2.00it/s]Computing embeddings:  97%|█████████▋| 184/189 [01:33<00:02,  2.00it/s]Computing embeddings:  98%|█████████▊| 185/189 [01:34<00:01,  2.00it/s]Computing embeddings:  98%|█████████▊| 186/189 [01:34<00:01,  2.00it/s]Computing embeddings:  99%|█████████▉| 187/189 [01:35<00:01,  2.00it/s]Computing embeddings:  99%|█████████▉| 188/189 [01:35<00:00,  2.00it/s]Computing embeddings: 100%|██████████| 189/189 [01:36<00:00,  2.00it/s]Computing embeddings: 100%|██████████| 189/189 [01:36<00:00,  1.97it/s]

Computing embeddings for 128 images from data/histomorfologico/cptac/pr/label_positive_pred_0...
Computing embeddings:   0%|          | 0/16 [00:00<?, ?it/s]Computing embeddings:   6%|▋         | 1/16 [00:00<00:07,  2.02it/s]Computing embeddings:  12%|█▎        | 2/16 [00:00<00:06,  2.25it/s]Computing embeddings:  19%|█▉        | 3/16 [00:01<00:05,  2.17it/s]Computing embeddings:  25%|██▌       | 4/16 [00:01<00:05,  2.13it/s]Computing embeddings:  31%|███▏      | 5/16 [00:02<00:05,  2.11it/s]Computing embeddings:  38%|███▊      | 6/16 [00:02<00:04,  2.09it/s]Computing embeddings:  44%|████▍     | 7/16 [00:03<00:04,  2.09it/s]Computing embeddings:  50%|█████     | 8/16 [00:03<00:03,  2.08it/s]Computing embeddings:  56%|█████▋    | 9/16 [00:04<00:03,  2.07it/s]Computing embeddings:  62%|██████▎   | 10/16 [00:04<00:02,  2.07it/s]Computing embeddings:  69%|██████▉   | 11/16 [00:05<00:02,  2.07it/s]Computing embeddings:  75%|███████▌  | 12/16 [00:05<00:01,  2.07it/s]Computing embeddings:  81%|████████▏ | 13/16 [00:06<00:01,  2.07it/s]Computing embeddings:  88%|████████▊ | 14/16 [00:06<00:00,  2.06it/s]Computing embeddings:  94%|█████████▍| 15/16 [00:07<00:00,  2.06it/s]Computing embeddings: 100%|██████████| 16/16 [00:07<00:00,  2.06it/s]Computing embeddings: 100%|██████████| 16/16 [00:07<00:00,  2.08it/s]

Selecting 25 representative images...

Results for label 'positive':
  Selected 25 images
  Distance range: 24.2500 - 26.3125
  Saved to: selected_gt_cptac_pr_positive.txt
  Saved to: selected_gt_cptac_pr_positive_with_distances.json

============================================================
Done!
============================================================

Processing PAM50 dataset...
Found 17 label directories
Loaded CSV with 387 entries
Created label mapping for 387 slide IDs

Scanning directory: data/histomorfologico/cptac/pam50/label_basal_pred_3
  Found 72 images

Scanning directory: data/histomorfologico/cptac/pam50/label_luma_pred_0
  Found 40 images

Scanning directory: data/histomorfologico/cptac/pam50/label_normal_pred_3
  Found 8 images

Scanning directory: data/histomorfologico/cptac/pam50/label_her2_pred_2
  Found 208 images

Scanning directory: data/histomorfologico/cptac/pam50/label_her2_pred_3
  Found 16 images

Scanning directory: data/histomorfologico/cptac/pam50/label_basal_pred_4
  Found 48 images

Scanning directory: data/histomorfologico/cptac/pam50/label_lumb_pred_2
  Found 272 images

Scanning directory: data/histomorfologico/cptac/pam50/label_basal_pred_0
  Found 1146 images

Scanning directory: data/histomorfologico/cptac/pam50/label_her2_pred_0
  Found 88 images

Scanning directory: data/histomorfologico/cptac/pam50/label_normal_pred_4
  Found 8 images

Scanning directory: data/histomorfologico/cptac/pam50/label_luma_pred_4
  Found 8 images

Scanning directory: data/histomorfologico/cptac/pam50/label_normal_pred_2
  Found 72 images

Scanning directory: data/histomorfologico/cptac/pam50/label_basal_pred_2
  Found 168 images

Scanning directory: data/histomorfologico/cptac/pam50/label_normal_pred_0
  Found 24 images

Scanning directory: data/histomorfologico/cptac/pam50/label_lumb_pred_3
  Found 226 images

Scanning directory: data/histomorfologico/cptac/pam50/label_luma_pred_2
  Found 2395 images

Scanning directory: data/histomorfologico/cptac/pam50/label_luma_pred_3
  Found 40 images

============================================================
Images grouped by ground truth label:
  basal: 1434 images
  her2: 312 images
  luma: 2483 images
  lumb: 498 images
  normal: 112 images
Total images: 4839
Not found in CSV: 0
============================================================

Loading Virchow v2 model...

============================================================
Processing label: basal
Total images: 1434
============================================================

Computing embeddings for 72 images from data/histomorfologico/cptac/pam50/label_basal_pred_3...
Computing embeddings:   0%|          | 0/9 [00:00<?, ?it/s]Computing embeddings:  11%|█         | 1/9 [00:00<00:03,  2.02it/s]Computing embeddings:  22%|██▏       | 2/9 [00:00<00:02,  2.54it/s]Computing embeddings:  33%|███▎      | 3/9 [00:01<00:02,  2.69it/s]Computing embeddings:  44%|████▍     | 4/9 [00:01<00:01,  2.73it/s]Computing embeddings:  56%|█████▌    | 5/9 [00:01<00:01,  2.71it/s]Computing embeddings:  67%|██████▋   | 6/9 [00:02<00:01,  2.68it/s]Computing embeddings:  78%|███████▊  | 7/9 [00:02<00:00,  2.62it/s]Computing embeddings:  89%|████████▉ | 8/9 [00:03<00:00,  2.56it/s]Computing embeddings: 100%|██████████| 9/9 [00:03<00:00,  2.52it/s]Computing embeddings: 100%|██████████| 9/9 [00:03<00:00,  2.57it/s]

Computing embeddings for 48 images from data/histomorfologico/cptac/pam50/label_basal_pred_4...
Computing embeddings:   0%|          | 0/6 [00:00<?, ?it/s]Computing embeddings:  17%|█▋        | 1/6 [00:00<00:01,  2.52it/s]Computing embeddings:  33%|███▎      | 2/6 [00:00<00:01,  2.50it/s]Computing embeddings:  50%|█████     | 3/6 [00:01<00:01,  2.50it/s]Computing embeddings:  67%|██████▋   | 4/6 [00:01<00:00,  2.50it/s]Computing embeddings:  83%|████████▎ | 5/6 [00:01<00:00,  2.50it/s]Computing embeddings: 100%|██████████| 6/6 [00:02<00:00,  2.50it/s]Computing embeddings: 100%|██████████| 6/6 [00:02<00:00,  2.50it/s]

Computing embeddings for 1146 images from data/histomorfologico/cptac/pam50/label_basal_pred_0...
Computing embeddings:   0%|          | 0/144 [00:00<?, ?it/s]Computing embeddings:   1%|          | 1/144 [00:00<01:00,  2.37it/s]Computing embeddings:   1%|▏         | 2/144 [00:00<01:02,  2.27it/s]Computing embeddings:   2%|▏         | 3/144 [00:01<01:06,  2.11it/s]Computing embeddings:   3%|▎         | 4/144 [00:01<01:08,  2.04it/s]Computing embeddings:   3%|▎         | 5/144 [00:02<01:09,  2.00it/s]Computing embeddings:   4%|▍         | 6/144 [00:02<01:10,  1.97it/s]Computing embeddings:   5%|▍         | 7/144 [00:03<01:10,  1.96it/s]Computing embeddings:   6%|▌         | 8/144 [00:03<01:10,  1.94it/s]Computing embeddings:   6%|▋         | 9/144 [00:04<01:04,  2.08it/s]Computing embeddings:   7%|▋         | 10/144 [00:04<01:04,  2.07it/s]Computing embeddings:   8%|▊         | 11/144 [00:05<01:06,  2.00it/s]Computing embeddings:   8%|▊         | 12/144 [00:05<01:07,  1.96it/s]Computing embeddings:   9%|▉         | 13/144 [00:06<01:07,  1.93it/s]Computing embeddings:  10%|▉         | 14/144 [00:07<01:07,  1.91it/s]Computing embeddings:  10%|█         | 15/144 [00:07<01:08,  1.88it/s]Computing embeddings:  11%|█         | 16/144 [00:08<01:08,  1.88it/s]Computing embeddings:  12%|█▏        | 17/144 [00:08<01:08,  1.86it/s]Computing embeddings:  12%|█▎        | 18/144 [00:09<01:08,  1.85it/s]Computing embeddings:  13%|█▎        | 19/144 [00:09<01:07,  1.85it/s]Computing embeddings:  14%|█▍        | 20/144 [00:10<01:06,  1.86it/s]Computing embeddings:  15%|█▍        | 21/144 [00:10<01:06,  1.86it/s]Computing embeddings:  15%|█▌        | 22/144 [00:11<01:05,  1.86it/s]Computing embeddings:  16%|█▌        | 23/144 [00:11<01:05,  1.85it/s]Computing embeddings:  17%|█▋        | 24/144 [00:12<01:04,  1.85it/s]Computing embeddings:  17%|█▋        | 25/144 [00:12<01:04,  1.86it/s]Computing embeddings:  18%|█▊        | 26/144 [00:13<01:03,  1.86it/s]Computing embeddings:  19%|█▉        | 27/144 [00:14<01:02,  1.87it/s]Computing embeddings:  19%|█▉        | 28/144 [00:14<01:02,  1.87it/s]Computing embeddings:  20%|██        | 29/144 [00:15<01:01,  1.87it/s]Computing embeddings:  21%|██        | 30/144 [00:15<01:00,  1.88it/s]Computing embeddings:  22%|██▏       | 31/144 [00:16<01:00,  1.88it/s]Computing embeddings:  22%|██▏       | 32/144 [00:16<00:59,  1.88it/s]Computing embeddings:  23%|██▎       | 33/144 [00:17<00:59,  1.87it/s]Computing embeddings:  24%|██▎       | 34/144 [00:17<00:58,  1.87it/s]Computing embeddings:  24%|██▍       | 35/144 [00:18<00:58,  1.88it/s]Computing embeddings:  25%|██▌       | 36/144 [00:18<00:57,  1.88it/s]Computing embeddings:  26%|██▌       | 37/144 [00:19<00:57,  1.86it/s]Computing embeddings:  26%|██▋       | 38/144 [00:19<00:56,  1.86it/s]Computing embeddings:  27%|██▋       | 39/144 [00:20<00:56,  1.87it/s]Computing embeddings:  28%|██▊       | 40/144 [00:20<00:55,  1.87it/s]Computing embeddings:  28%|██▊       | 41/144 [00:21<00:54,  1.88it/s]Computing embeddings:  29%|██▉       | 42/144 [00:22<00:54,  1.87it/s]Computing embeddings:  30%|██▉       | 43/144 [00:22<00:54,  1.87it/s]Computing embeddings:  31%|███       | 44/144 [00:23<00:53,  1.86it/s]Computing embeddings:  31%|███▏      | 45/144 [00:23<00:52,  1.87it/s]Computing embeddings:  32%|███▏      | 46/144 [00:24<00:52,  1.86it/s]Computing embeddings:  33%|███▎      | 47/144 [00:24<00:52,  1.86it/s]Computing embeddings:  33%|███▎      | 48/144 [00:25<00:51,  1.87it/s]Computing embeddings:  34%|███▍      | 49/144 [00:25<00:50,  1.87it/s]Computing embeddings:  35%|███▍      | 50/144 [00:26<00:50,  1.88it/s]Computing embeddings:  35%|███▌      | 51/144 [00:26<00:49,  1.88it/s]Computing embeddings:  36%|███▌      | 52/144 [00:27<00:49,  1.87it/s]Computing embeddings:  37%|███▋      | 53/144 [00:27<00:48,  1.88it/s]Computing embeddings:  38%|███▊      | 54/144 [00:28<00:47,  1.88it/s]Computing embeddings:  38%|███▊      | 55/144 [00:28<00:47,  1.87it/s]Computing embeddings:  39%|███▉      | 56/144 [00:29<00:47,  1.87it/s]Computing embeddings:  40%|███▉      | 57/144 [00:30<00:46,  1.87it/s]Computing embeddings:  40%|████      | 58/144 [00:30<00:45,  1.87it/s]Computing embeddings:  41%|████      | 59/144 [00:31<00:45,  1.87it/s]Computing embeddings:  42%|████▏     | 60/144 [00:31<00:44,  1.87it/s]Computing embeddings:  42%|████▏     | 61/144 [00:32<00:44,  1.87it/s]Computing embeddings:  43%|████▎     | 62/144 [00:32<00:43,  1.87it/s]Computing embeddings:  44%|████▍     | 63/144 [00:33<00:43,  1.86it/s]Computing embeddings:  44%|████▍     | 64/144 [00:33<00:42,  1.87it/s]Computing embeddings:  45%|████▌     | 65/144 [00:34<00:42,  1.87it/s]Computing embeddings:  46%|████▌     | 66/144 [00:34<00:41,  1.88it/s]Computing embeddings:  47%|████▋     | 67/144 [00:35<00:41,  1.87it/s]Computing embeddings:  47%|████▋     | 68/144 [00:35<00:40,  1.88it/s]Computing embeddings:  48%|████▊     | 69/144 [00:36<00:39,  1.88it/s]Computing embeddings:  49%|████▊     | 70/144 [00:37<00:39,  1.87it/s]Computing embeddings:  49%|████▉     | 71/144 [00:37<00:38,  1.88it/s]Computing embeddings:  50%|█████     | 72/144 [00:38<00:38,  1.88it/s]Computing embeddings:  51%|█████     | 73/144 [00:38<00:37,  1.87it/s]Computing embeddings:  51%|█████▏    | 74/144 [00:39<00:37,  1.88it/s]Computing embeddings:  52%|█████▏    | 75/144 [00:39<00:36,  1.87it/s]Computing embeddings:  53%|█████▎    | 76/144 [00:40<00:36,  1.87it/s]Computing embeddings:  53%|█████▎    | 77/144 [00:40<00:35,  1.88it/s]Computing embeddings:  54%|█████▍    | 78/144 [00:41<00:35,  1.88it/s]Computing embeddings:  55%|█████▍    | 79/144 [00:41<00:34,  1.86it/s]Computing embeddings:  56%|█████▌    | 80/144 [00:42<00:34,  1.84it/s]Computing embeddings:  56%|█████▋    | 81/144 [00:42<00:33,  1.86it/s]Computing embeddings:  57%|█████▋    | 82/144 [00:43<00:33,  1.85it/s]Computing embeddings:  58%|█████▊    | 83/144 [00:43<00:32,  1.85it/s]Computing embeddings:  58%|█████▊    | 84/144 [00:44<00:32,  1.86it/s]Computing embeddings:  59%|█████▉    | 85/144 [00:45<00:31,  1.86it/s]Computing embeddings:  60%|█████▉    | 86/144 [00:45<00:31,  1.86it/s]Computing embeddings:  60%|██████    | 87/144 [00:46<00:30,  1.87it/s]Computing embeddings:  61%|██████    | 88/144 [00:46<00:29,  1.87it/s]Computing embeddings:  62%|██████▏   | 89/144 [00:47<00:29,  1.84it/s]Computing embeddings:  62%|██████▎   | 90/144 [00:47<00:28,  1.86it/s]Computing embeddings:  63%|██████▎   | 91/144 [00:48<00:28,  1.88it/s]Computing embeddings:  64%|██████▍   | 92/144 [00:48<00:27,  1.87it/s]Computing embeddings:  65%|██████▍   | 93/144 [00:49<00:27,  1.88it/s]Computing embeddings:  65%|██████▌   | 94/144 [00:49<00:26,  1.86it/s]Computing embeddings:  66%|██████▌   | 95/144 [00:50<00:26,  1.87it/s]Computing embeddings:  67%|██████▋   | 96/144 [00:50<00:25,  1.85it/s]Computing embeddings:  67%|██████▋   | 97/144 [00:51<00:25,  1.85it/s]Computing embeddings:  68%|██████▊   | 98/144 [00:51<00:23,  1.96it/s]Computing embeddings:  69%|██████▉   | 99/144 [00:52<00:22,  2.04it/s]Computing embeddings:  69%|██████▉   | 100/144 [00:52<00:22,  1.98it/s]Computing embeddings:  70%|███████   | 101/144 [00:53<00:20,  2.09it/s]Computing embeddings:  71%|███████   | 102/144 [00:53<00:20,  2.09it/s]Computing embeddings:  72%|███████▏  | 103/144 [00:54<00:21,  1.93it/s]Computing embeddings:  72%|███████▏  | 104/144 [00:55<00:22,  1.81it/s]Computing embeddings:  73%|███████▎  | 105/144 [00:55<00:22,  1.75it/s]Computing embeddings:  74%|███████▎  | 106/144 [00:56<00:22,  1.71it/s]Computing embeddings:  74%|███████▍  | 107/144 [00:56<00:21,  1.69it/s]Computing embeddings:  75%|███████▌  | 108/144 [00:57<00:21,  1.67it/s]Computing embeddings:  76%|███████▌  | 109/144 [00:58<00:21,  1.66it/s]Computing embeddings:  76%|███████▋  | 110/144 [00:58<00:20,  1.65it/s]Computing embeddings:  77%|███████▋  | 111/144 [00:59<00:20,  1.64it/s]Computing embeddings:  78%|███████▊  | 112/144 [00:59<00:19,  1.64it/s]Computing embeddings:  78%|███████▊  | 113/144 [01:00<00:18,  1.64it/s]Computing embeddings:  79%|███████▉  | 114/144 [01:01<00:18,  1.64it/s]Computing embeddings:  80%|███████▉  | 115/144 [01:01<00:17,  1.64it/s]Computing embeddings:  81%|████████  | 116/144 [01:02<00:17,  1.64it/s]Computing embeddings:  81%|████████▏ | 117/144 [01:03<00:16,  1.65it/s]Computing embeddings:  82%|████████▏ | 118/144 [01:03<00:15,  1.64it/s]Computing embeddings:  83%|████████▎ | 119/144 [01:04<00:15,  1.65it/s]Computing embeddings:  83%|████████▎ | 120/144 [01:04<00:14,  1.64it/s]Computing embeddings:  84%|████████▍ | 121/144 [01:05<00:14,  1.64it/s]Computing embeddings:  85%|████████▍ | 122/144 [01:06<00:13,  1.63it/s]Computing embeddings:  85%|████████▌ | 123/144 [01:06<00:12,  1.64it/s]Computing embeddings:  86%|████████▌ | 124/144 [01:07<00:12,  1.64it/s]Computing embeddings:  87%|████████▋ | 125/144 [01:07<00:11,  1.64it/s]Computing embeddings:  88%|████████▊ | 126/144 [01:08<00:10,  1.64it/s]Computing embeddings:  88%|████████▊ | 127/144 [01:09<00:10,  1.64it/s]Computing embeddings:  89%|████████▉ | 128/144 [01:09<00:09,  1.64it/s]Computing embeddings:  90%|████████▉ | 129/144 [01:10<00:09,  1.65it/s]Computing embeddings:  90%|█████████ | 130/144 [01:10<00:08,  1.65it/s]Computing embeddings:  91%|█████████ | 131/144 [01:11<00:07,  1.65it/s]Computing embeddings:  92%|█████████▏| 132/144 [01:12<00:07,  1.65it/s]Computing embeddings:  92%|█████████▏| 133/144 [01:12<00:06,  1.65it/s]Computing embeddings:  93%|█████████▎| 134/144 [01:13<00:06,  1.65it/s]Computing embeddings:  94%|█████████▍| 135/144 [01:13<00:05,  1.65it/s]Computing embeddings:  94%|█████████▍| 136/144 [01:14<00:04,  1.65it/s]Computing embeddings:  95%|█████████▌| 137/144 [01:15<00:04,  1.65it/s]Computing embeddings:  96%|█████████▌| 138/144 [01:15<00:03,  1.65it/s]Computing embeddings:  97%|█████████▋| 139/144 [01:16<00:03,  1.65it/s]Computing embeddings:  97%|█████████▋| 140/144 [01:17<00:02,  1.64it/s]Computing embeddings:  98%|█████████▊| 141/144 [01:17<00:01,  1.65it/s]Computing embeddings:  99%|█████████▊| 142/144 [01:18<00:01,  1.65it/s]Computing embeddings:  99%|█████████▉| 143/144 [01:18<00:00,  1.65it/s]Computing embeddings: 100%|██████████| 144/144 [01:18<00:00,  2.12it/s]Computing embeddings: 100%|██████████| 144/144 [01:18<00:00,  1.82it/s]

Computing embeddings for 168 images from data/histomorfologico/cptac/pam50/label_basal_pred_2...
Computing embeddings:   0%|          | 0/21 [00:00<?, ?it/s]Computing embeddings:   5%|▍         | 1/21 [00:00<00:12,  1.64it/s]Computing embeddings:  10%|▉         | 2/21 [00:01<00:11,  1.66it/s]Computing embeddings:  14%|█▍        | 3/21 [00:01<00:10,  1.66it/s]Computing embeddings:  19%|█▉        | 4/21 [00:02<00:10,  1.67it/s]Computing embeddings:  24%|██▍       | 5/21 [00:03<00:09,  1.67it/s]Computing embeddings:  29%|██▊       | 6/21 [00:03<00:08,  1.67it/s]Computing embeddings:  33%|███▎      | 7/21 [00:04<00:08,  1.68it/s]Computing embeddings:  38%|███▊      | 8/21 [00:04<00:07,  1.67it/s]Computing embeddings:  43%|████▎     | 9/21 [00:05<00:07,  1.68it/s]Computing embeddings:  48%|████▊     | 10/21 [00:05<00:06,  1.83it/s]Computing embeddings:  52%|█████▏    | 11/21 [00:06<00:05,  1.95it/s]Computing embeddings:  57%|█████▋    | 12/21 [00:06<00:04,  2.04it/s]Computing embeddings:  62%|██████▏   | 13/21 [00:07<00:03,  2.13it/s]Computing embeddings:  67%|██████▋   | 14/21 [00:07<00:03,  2.17it/s]Computing embeddings:  71%|███████▏  | 15/21 [00:07<00:02,  2.27it/s]Computing embeddings:  76%|███████▌  | 16/21 [00:08<00:02,  2.10it/s]Computing embeddings:  81%|████████  | 17/21 [00:09<00:02,  1.95it/s]Computing embeddings:  86%|████████▌ | 18/21 [00:09<00:01,  1.85it/s]Computing embeddings:  90%|█████████ | 19/21 [00:10<00:01,  1.79it/s]Computing embeddings:  95%|█████████▌| 20/21 [00:10<00:00,  1.75it/s]Computing embeddings: 100%|██████████| 21/21 [00:11<00:00,  1.73it/s]Computing embeddings: 100%|██████████| 21/21 [00:11<00:00,  1.83it/s]

Selecting 25 representative images...

Results for label 'basal':
  Selected 25 images
  Distance range: 22.6562 - 23.6719
  Saved to: selected_gt_cptac_pam50_basal.txt
  Saved to: selected_gt_cptac_pam50_basal_with_distances.json

============================================================
Processing label: her2
Total images: 312
============================================================

Computing embeddings for 208 images from data/histomorfologico/cptac/pam50/label_her2_pred_2...
Computing embeddings:   0%|          | 0/26 [00:00<?, ?it/s]Computing embeddings:   4%|▍         | 1/26 [00:00<00:11,  2.26it/s]Computing embeddings:   8%|▊         | 2/26 [00:00<00:10,  2.24it/s]Computing embeddings:  12%|█▏        | 3/26 [00:01<00:10,  2.24it/s]Computing embeddings:  15%|█▌        | 4/26 [00:01<00:09,  2.22it/s]Computing embeddings:  19%|█▉        | 5/26 [00:02<00:09,  2.21it/s]Computing embeddings:  23%|██▎       | 6/26 [00:02<00:09,  2.22it/s]Computing embeddings:  27%|██▋       | 7/26 [00:03<00:08,  2.22it/s]Computing embeddings:  31%|███       | 8/26 [00:03<00:08,  2.24it/s]Computing embeddings:  35%|███▍      | 9/26 [00:04<00:08,  2.09it/s]Computing embeddings:  38%|███▊      | 10/26 [00:04<00:08,  1.91it/s]Computing embeddings:  42%|████▏     | 11/26 [00:05<00:08,  1.81it/s]Computing embeddings:  46%|████▌     | 12/26 [00:05<00:08,  1.75it/s]Computing embeddings:  50%|█████     | 13/26 [00:06<00:07,  1.71it/s]Computing embeddings:  54%|█████▍    | 14/26 [00:07<00:07,  1.69it/s]Computing embeddings:  58%|█████▊    | 15/26 [00:07<00:06,  1.68it/s]Computing embeddings:  62%|██████▏   | 16/26 [00:08<00:05,  1.67it/s]Computing embeddings:  65%|██████▌   | 17/26 [00:09<00:05,  1.66it/s]Computing embeddings:  69%|██████▉   | 18/26 [00:09<00:04,  1.66it/s]Computing embeddings:  73%|███████▎  | 19/26 [00:10<00:04,  1.65it/s]Computing embeddings:  77%|███████▋  | 20/26 [00:10<00:03,  1.65it/s]Computing embeddings:  81%|████████  | 21/26 [00:11<00:03,  1.64it/s]Computing embeddings:  85%|████████▍ | 22/26 [00:12<00:02,  1.64it/s]Computing embeddings:  88%|████████▊ | 23/26 [00:12<00:01,  1.64it/s]Computing embeddings:  92%|█████████▏| 24/26 [00:13<00:01,  1.65it/s]Computing embeddings:  96%|█████████▌| 25/26 [00:13<00:00,  1.66it/s]Computing embeddings: 100%|██████████| 26/26 [00:14<00:00,  1.66it/s]Computing embeddings: 100%|██████████| 26/26 [00:14<00:00,  1.79it/s]

Computing embeddings for 16 images from data/histomorfologico/cptac/pam50/label_her2_pred_3...
Computing embeddings:   0%|          | 0/2 [00:00<?, ?it/s]Computing embeddings:  50%|█████     | 1/2 [00:00<00:00,  1.68it/s]Computing embeddings: 100%|██████████| 2/2 [00:01<00:00,  1.67it/s]Computing embeddings: 100%|██████████| 2/2 [00:01<00:00,  1.67it/s]

Computing embeddings for 88 images from data/histomorfologico/cptac/pam50/label_her2_pred_0...
Computing embeddings:   0%|          | 0/11 [00:00<?, ?it/s]Computing embeddings:   9%|▉         | 1/11 [00:00<00:05,  1.68it/s]Computing embeddings:  18%|█▊        | 2/11 [00:01<00:05,  1.65it/s]Computing embeddings:  27%|██▋       | 3/11 [00:01<00:04,  1.67it/s]Computing embeddings:  36%|███▋      | 4/11 [00:02<00:04,  1.67it/s]Computing embeddings:  45%|████▌     | 5/11 [00:02<00:03,  1.67it/s]Computing embeddings:  55%|█████▍    | 6/11 [00:03<00:02,  1.67it/s]Computing embeddings:  64%|██████▎   | 7/11 [00:04<00:02,  1.68it/s]Computing embeddings:  73%|███████▎  | 8/11 [00:04<00:01,  1.68it/s]Computing embeddings:  82%|████████▏ | 9/11 [00:05<00:01,  1.68it/s]Computing embeddings:  91%|█████████ | 10/11 [00:05<00:00,  1.68it/s]Computing embeddings: 100%|██████████| 11/11 [00:06<00:00,  1.68it/s]Computing embeddings: 100%|██████████| 11/11 [00:06<00:00,  1.68it/s]

Selecting 25 representative images...

Results for label 'her2':
  Selected 25 images
  Distance range: 23.6406 - 26.7656
  Saved to: selected_gt_cptac_pam50_her2.txt
  Saved to: selected_gt_cptac_pam50_her2_with_distances.json

============================================================
Processing label: luma
Total images: 2483
============================================================

Computing embeddings for 40 images from data/histomorfologico/cptac/pam50/label_luma_pred_0...
Computing embeddings:   0%|          | 0/5 [00:00<?, ?it/s]Computing embeddings:  20%|██        | 1/5 [00:00<00:02,  1.68it/s]Computing embeddings:  40%|████      | 2/5 [00:01<00:01,  1.68it/s]Computing embeddings:  60%|██████    | 3/5 [00:01<00:01,  1.66it/s]Computing embeddings:  80%|████████  | 4/5 [00:02<00:00,  1.67it/s]Computing embeddings: 100%|██████████| 5/5 [00:02<00:00,  1.67it/s]Computing embeddings: 100%|██████████| 5/5 [00:02<00:00,  1.67it/s]

Computing embeddings for 8 images from data/histomorfologico/cptac/pam50/label_luma_pred_4...
Computing embeddings:   0%|          | 0/1 [00:00<?, ?it/s]Computing embeddings: 100%|██████████| 1/1 [00:00<00:00,  1.67it/s]Computing embeddings: 100%|██████████| 1/1 [00:00<00:00,  1.67it/s]

Computing embeddings for 2395 images from data/histomorfologico/cptac/pam50/label_luma_pred_2...
Computing embeddings:   0%|          | 0/300 [00:00<?, ?it/s]Computing embeddings:   0%|          | 1/300 [00:00<02:58,  1.68it/s]Computing embeddings:   1%|          | 2/300 [00:01<02:33,  1.95it/s]Computing embeddings:   1%|          | 3/300 [00:01<02:23,  2.06it/s]Computing embeddings:   1%|▏         | 4/300 [00:01<02:19,  2.12it/s]Computing embeddings:   2%|▏         | 5/300 [00:02<02:07,  2.31it/s]Computing embeddings:   2%|▏         | 6/300 [00:02<02:05,  2.34it/s]Computing embeddings:   2%|▏         | 7/300 [00:03<02:20,  2.08it/s]Computing embeddings:   3%|▎         | 8/300 [00:03<02:30,  1.94it/s]Computing embeddings:   3%|▎         | 9/300 [00:04<02:37,  1.85it/s]Computing embeddings:   3%|▎         | 10/300 [00:05<02:40,  1.81it/s]Computing embeddings:   4%|▎         | 11/300 [00:05<02:43,  1.77it/s]Computing embeddings:   4%|▍         | 12/300 [00:06<02:45,  1.74it/s]Computing embeddings:   4%|▍         | 13/300 [00:06<02:47,  1.71it/s]Computing embeddings:   5%|▍         | 14/300 [00:07<02:48,  1.70it/s]Computing embeddings:   5%|▌         | 15/300 [00:08<02:48,  1.69it/s]Computing embeddings:   5%|▌         | 16/300 [00:08<02:49,  1.68it/s]Computing embeddings:   6%|▌         | 17/300 [00:09<02:48,  1.68it/s]Computing embeddings:   6%|▌         | 18/300 [00:09<02:48,  1.67it/s]Computing embeddings:   6%|▋         | 19/300 [00:10<02:48,  1.66it/s]Computing embeddings:   7%|▋         | 20/300 [00:11<02:47,  1.67it/s]Computing embeddings:   7%|▋         | 21/300 [00:11<02:46,  1.67it/s]Computing embeddings:   7%|▋         | 22/300 [00:12<02:45,  1.68it/s]Computing embeddings:   8%|▊         | 23/300 [00:12<02:46,  1.67it/s]Computing embeddings:   8%|▊         | 24/300 [00:13<02:46,  1.66it/s]Computing embeddings:   8%|▊         | 25/300 [00:14<02:44,  1.67it/s]Computing embeddings:   9%|▊         | 26/300 [00:14<02:44,  1.67it/s]Computing embeddings:   9%|▉         | 27/300 [00:15<02:43,  1.67it/s]Computing embeddings:   9%|▉         | 28/300 [00:15<02:42,  1.67it/s]Computing embeddings:  10%|▉         | 29/300 [00:16<02:41,  1.68it/s]Computing embeddings:  10%|█         | 30/300 [00:17<02:40,  1.68it/s]Computing embeddings:  10%|█         | 31/300 [00:17<02:40,  1.68it/s]Computing embeddings:  11%|█         | 32/300 [00:18<02:41,  1.66it/s]Computing embeddings:  11%|█         | 33/300 [00:18<02:41,  1.66it/s]Computing embeddings:  11%|█▏        | 34/300 [00:19<02:39,  1.67it/s]Computing embeddings:  12%|█▏        | 35/300 [00:20<02:39,  1.67it/s]Computing embeddings:  12%|█▏        | 36/300 [00:20<02:38,  1.66it/s]Computing embeddings:  12%|█▏        | 37/300 [00:21<02:38,  1.66it/s]Computing embeddings:  13%|█▎        | 38/300 [00:21<02:37,  1.67it/s]Computing embeddings:  13%|█▎        | 39/300 [00:22<02:24,  1.81it/s]Computing embeddings:  13%|█▎        | 40/300 [00:22<02:15,  1.92it/s]Computing embeddings:  14%|█▎        | 41/300 [00:23<02:09,  2.00it/s]Computing embeddings:  14%|█▍        | 42/300 [00:23<02:02,  2.10it/s]Computing embeddings:  14%|█▍        | 43/300 [00:24<02:10,  1.97it/s]Computing embeddings:  15%|█▍        | 44/300 [00:24<02:17,  1.86it/s]Computing embeddings:  15%|█▌        | 45/300 [00:25<02:23,  1.78it/s]Computing embeddings:  15%|█▌        | 46/300 [00:26<02:27,  1.72it/s]Computing embeddings:  16%|█▌        | 47/300 [00:26<02:30,  1.68it/s]Computing embeddings:  16%|█▌        | 48/300 [00:27<02:31,  1.66it/s]Computing embeddings:  16%|█▋        | 49/300 [00:27<02:31,  1.66it/s]Computing embeddings:  17%|█▋        | 50/300 [00:28<02:32,  1.64it/s]Computing embeddings:  17%|█▋        | 51/300 [00:29<02:31,  1.64it/s]Computing embeddings:  17%|█▋        | 52/300 [00:29<02:30,  1.65it/s]Computing embeddings:  18%|█▊        | 53/300 [00:30<02:29,  1.65it/s]Computing embeddings:  18%|█▊        | 54/300 [00:30<02:29,  1.65it/s]Computing embeddings:  18%|█▊        | 55/300 [00:31<02:28,  1.65it/s]Computing embeddings:  19%|█▊        | 56/300 [00:32<02:28,  1.64it/s]Computing embeddings:  19%|█▉        | 57/300 [00:32<02:28,  1.64it/s]Computing embeddings:  19%|█▉        | 58/300 [00:33<02:27,  1.64it/s]Computing embeddings:  20%|█▉        | 59/300 [00:34<02:26,  1.65it/s]Computing embeddings:  20%|██        | 60/300 [00:34<02:25,  1.65it/s]Computing embeddings:  20%|██        | 61/300 [00:35<02:25,  1.64it/s]Computing embeddings:  21%|██        | 62/300 [00:35<02:24,  1.65it/s]Computing embeddings:  21%|██        | 63/300 [00:36<02:23,  1.65it/s]Computing embeddings:  21%|██▏       | 64/300 [00:37<02:23,  1.65it/s]Computing embeddings:  22%|██▏       | 65/300 [00:37<02:11,  1.79it/s]Computing embeddings:  22%|██▏       | 66/300 [00:37<02:02,  1.91it/s]Computing embeddings:  22%|██▏       | 67/300 [00:38<01:56,  2.01it/s]Computing embeddings:  23%|██▎       | 68/300 [00:38<01:54,  2.02it/s]Computing embeddings:  23%|██▎       | 69/300 [00:39<01:55,  2.00it/s]Computing embeddings:  23%|██▎       | 70/300 [00:39<01:55,  1.99it/s]Computing embeddings:  24%|██▎       | 71/300 [00:40<01:55,  1.98it/s]Computing embeddings:  24%|██▍       | 72/300 [00:40<01:54,  1.99it/s]Computing embeddings:  24%|██▍       | 73/300 [00:41<01:54,  1.98it/s]Computing embeddings:  25%|██▍       | 74/300 [00:41<01:53,  1.99it/s]Computing embeddings:  25%|██▌       | 75/300 [00:42<01:53,  1.98it/s]Computing embeddings:  25%|██▌       | 76/300 [00:42<01:52,  1.99it/s]Computing embeddings:  26%|██▌       | 77/300 [00:43<01:47,  2.08it/s]Computing embeddings:  26%|██▌       | 78/300 [00:43<01:47,  2.07it/s]Computing embeddings:  26%|██▋       | 79/300 [00:44<01:47,  2.05it/s]Computing embeddings:  27%|██▋       | 80/300 [00:44<01:42,  2.15it/s]Computing embeddings:  27%|██▋       | 81/300 [00:45<01:45,  2.08it/s]Computing embeddings:  27%|██▋       | 82/300 [00:45<01:49,  1.98it/s]Computing embeddings:  28%|██▊       | 83/300 [00:46<01:51,  1.95it/s]Computing embeddings:  28%|██▊       | 84/300 [00:46<01:53,  1.90it/s]Computing embeddings:  28%|██▊       | 85/300 [00:47<01:54,  1.88it/s]Computing embeddings:  29%|██▊       | 86/300 [00:48<01:54,  1.86it/s]Computing embeddings:  29%|██▉       | 87/300 [00:48<01:54,  1.86it/s]Computing embeddings:  29%|██▉       | 88/300 [00:49<01:54,  1.85it/s]Computing embeddings:  30%|██▉       | 89/300 [00:49<01:53,  1.85it/s]Computing embeddings:  30%|███       | 90/300 [00:50<01:53,  1.85it/s]Computing embeddings:  30%|███       | 91/300 [00:50<01:53,  1.83it/s]Computing embeddings:  31%|███       | 92/300 [00:51<01:53,  1.83it/s]Computing embeddings:  31%|███       | 93/300 [00:51<01:53,  1.82it/s]Computing embeddings:  31%|███▏      | 94/300 [00:52<01:52,  1.83it/s]Computing embeddings:  32%|███▏      | 95/300 [00:52<01:51,  1.84it/s]Computing embeddings:  32%|███▏      | 96/300 [00:53<01:51,  1.83it/s]Computing embeddings:  32%|███▏      | 97/300 [00:54<01:51,  1.82it/s]Computing embeddings:  33%|███▎      | 98/300 [00:54<01:50,  1.83it/s]Computing embeddings:  33%|███▎      | 99/300 [00:55<01:49,  1.84it/s]Computing embeddings:  33%|███▎      | 100/300 [00:55<01:48,  1.84it/s]Computing embeddings:  34%|███▎      | 101/300 [00:56<01:47,  1.84it/s]Computing embeddings:  34%|███▍      | 102/300 [00:56<01:47,  1.84it/s]Computing embeddings:  34%|███▍      | 103/300 [00:57<01:46,  1.84it/s]Computing embeddings:  35%|███▍      | 104/300 [00:57<01:46,  1.84it/s]Computing embeddings:  35%|███▌      | 105/300 [00:58<01:45,  1.84it/s]Computing embeddings:  35%|███▌      | 106/300 [00:58<01:45,  1.83it/s]Computing embeddings:  36%|███▌      | 107/300 [00:59<01:45,  1.83it/s]Computing embeddings:  36%|███▌      | 108/300 [01:00<01:45,  1.81it/s]Computing embeddings:  36%|███▋      | 109/300 [01:00<01:45,  1.82it/s]Computing embeddings:  37%|███▋      | 110/300 [01:01<01:44,  1.82it/s]Computing embeddings:  37%|███▋      | 111/300 [01:01<01:44,  1.81it/s]Computing embeddings:  37%|███▋      | 112/300 [01:02<01:43,  1.82it/s]Computing embeddings:  38%|███▊      | 113/300 [01:02<01:42,  1.82it/s]Computing embeddings:  38%|███▊      | 114/300 [01:03<01:34,  1.97it/s]Computing embeddings:  38%|███▊      | 115/300 [01:03<01:29,  2.06it/s]Computing embeddings:  39%|███▊      | 116/300 [01:03<01:22,  2.24it/s]Computing embeddings:  39%|███▉      | 117/300 [01:04<01:27,  2.09it/s]Computing embeddings:  39%|███▉      | 118/300 [01:05<01:33,  1.95it/s]Computing embeddings:  40%|███▉      | 119/300 [01:05<01:37,  1.86it/s]Computing embeddings:  40%|████      | 120/300 [01:06<01:40,  1.79it/s]Computing embeddings:  40%|████      | 121/300 [01:06<01:42,  1.75it/s]Computing embeddings:  41%|████      | 122/300 [01:07<01:42,  1.73it/s]Computing embeddings:  41%|████      | 123/300 [01:08<01:43,  1.71it/s]Computing embeddings:  41%|████▏     | 124/300 [01:08<01:43,  1.70it/s]Computing embeddings:  42%|████▏     | 125/300 [01:09<01:42,  1.71it/s]Computing embeddings:  42%|████▏     | 126/300 [01:09<01:42,  1.69it/s]Computing embeddings:  42%|████▏     | 127/300 [01:10<01:42,  1.69it/s]Computing embeddings:  43%|████▎     | 128/300 [01:11<01:41,  1.69it/s]Computing embeddings:  43%|████▎     | 129/300 [01:11<01:41,  1.68it/s]Computing embeddings:  43%|████▎     | 130/300 [01:12<01:41,  1.68it/s]Computing embeddings:  44%|████▎     | 131/300 [01:12<01:41,  1.67it/s]Computing embeddings:  44%|████▍     | 132/300 [01:13<01:40,  1.66it/s]Computing embeddings:  44%|████▍     | 133/300 [01:14<01:40,  1.66it/s]Computing embeddings:  45%|████▍     | 134/300 [01:14<01:39,  1.68it/s]Computing embeddings:  45%|████▌     | 135/300 [01:15<01:38,  1.67it/s]Computing embeddings:  45%|████▌     | 136/300 [01:15<01:38,  1.66it/s]Computing embeddings:  46%|████▌     | 137/300 [01:16<01:38,  1.66it/s]Computing embeddings:  46%|████▌     | 138/300 [01:17<01:37,  1.66it/s]Computing embeddings:  46%|████▋     | 139/300 [01:17<01:36,  1.67it/s]Computing embeddings:  47%|████▋     | 140/300 [01:18<01:36,  1.67it/s]Computing embeddings:  47%|████▋     | 141/300 [01:18<01:35,  1.66it/s]Computing embeddings:  47%|████▋     | 142/300 [01:19<01:35,  1.66it/s]Computing embeddings:  48%|████▊     | 143/300 [01:20<01:34,  1.67it/s]Computing embeddings:  48%|████▊     | 144/300 [01:20<01:32,  1.69it/s]Computing embeddings:  48%|████▊     | 145/300 [01:21<01:32,  1.68it/s]Computing embeddings:  49%|████▊     | 146/300 [01:21<01:31,  1.67it/s]Computing embeddings:  49%|████▉     | 147/300 [01:22<01:31,  1.68it/s]Computing embeddings:  49%|████▉     | 148/300 [01:23<01:29,  1.69it/s]Computing embeddings:  50%|████▉     | 149/300 [01:23<01:29,  1.68it/s]Computing embeddings:  50%|█████     | 150/300 [01:24<01:29,  1.68it/s]Computing embeddings:  50%|█████     | 151/300 [01:24<01:28,  1.68it/s]Computing embeddings:  51%|█████     | 152/300 [01:25<01:27,  1.70it/s]Computing embeddings:  51%|█████     | 153/300 [01:25<01:26,  1.70it/s]Computing embeddings:  51%|█████▏    | 154/300 [01:26<01:25,  1.71it/s]Computing embeddings:  52%|█████▏    | 155/300 [01:27<01:24,  1.71it/s]Computing embeddings:  52%|█████▏    | 156/300 [01:27<01:24,  1.71it/s]Computing embeddings:  52%|█████▏    | 157/300 [01:28<01:23,  1.71it/s]Computing embeddings:  53%|█████▎    | 158/300 [01:28<01:23,  1.70it/s]Computing embeddings:  53%|█████▎    | 159/300 [01:29<01:22,  1.71it/s]Computing embeddings:  53%|█████▎    | 160/300 [01:30<01:22,  1.69it/s]Computing embeddings:  54%|█████▎    | 161/300 [01:30<01:22,  1.69it/s]Computing embeddings:  54%|█████▍    | 162/300 [01:31<01:21,  1.69it/s]Computing embeddings:  54%|█████▍    | 163/300 [01:31<01:21,  1.69it/s]Computing embeddings:  55%|█████▍    | 164/300 [01:32<01:20,  1.68it/s]Computing embeddings:  55%|█████▌    | 165/300 [01:33<01:20,  1.68it/s]Computing embeddings:  55%|█████▌    | 166/300 [01:33<01:20,  1.67it/s]Computing embeddings:  56%|█████▌    | 167/300 [01:34<01:19,  1.67it/s]Computing embeddings:  56%|█████▌    | 168/300 [01:34<01:18,  1.68it/s]Computing embeddings:  56%|█████▋    | 169/300 [01:35<01:17,  1.68it/s]Computing embeddings:  57%|█████▋    | 170/300 [01:36<01:16,  1.69it/s]Computing embeddings:  57%|█████▋    | 171/300 [01:36<01:16,  1.69it/s]Computing embeddings:  57%|█████▋    | 172/300 [01:37<01:15,  1.70it/s]Computing embeddings:  58%|█████▊    | 173/300 [01:37<01:14,  1.70it/s]Computing embeddings:  58%|█████▊    | 174/300 [01:38<01:13,  1.71it/s]Computing embeddings:  58%|█████▊    | 175/300 [01:38<01:13,  1.70it/s]Computing embeddings:  59%|█████▊    | 176/300 [01:39<01:13,  1.69it/s]Computing embeddings:  59%|█████▉    | 177/300 [01:40<01:12,  1.69it/s]Computing embeddings:  59%|█████▉    | 178/300 [01:40<01:12,  1.69it/s]Computing embeddings:  60%|█████▉    | 179/300 [01:41<01:11,  1.69it/s]Computing embeddings:  60%|██████    | 180/300 [01:41<01:11,  1.69it/s]Computing embeddings:  60%|██████    | 181/300 [01:42<01:10,  1.69it/s]Computing embeddings:  61%|██████    | 182/300 [01:43<01:09,  1.69it/s]Computing embeddings:  61%|██████    | 183/300 [01:43<01:09,  1.69it/s]Computing embeddings:  61%|██████▏   | 184/300 [01:44<01:08,  1.69it/s]Computing embeddings:  62%|██████▏   | 185/300 [01:44<01:07,  1.70it/s]Computing embeddings:  62%|██████▏   | 186/300 [01:45<01:06,  1.70it/s]Computing embeddings:  62%|██████▏   | 187/300 [01:46<01:06,  1.70it/s]Computing embeddings:  63%|██████▎   | 188/300 [01:46<01:06,  1.69it/s]Computing embeddings:  63%|██████▎   | 189/300 [01:47<01:06,  1.68it/s]Computing embeddings:  63%|██████▎   | 190/300 [01:47<01:05,  1.69it/s]Computing embeddings:  64%|██████▎   | 191/300 [01:48<01:04,  1.68it/s]Computing embeddings:  64%|██████▍   | 192/300 [01:49<01:04,  1.68it/s]Computing embeddings:  64%|██████▍   | 193/300 [01:49<01:03,  1.68it/s]Computing embeddings:  65%|██████▍   | 194/300 [01:50<01:03,  1.67it/s]Computing embeddings:  65%|██████▌   | 195/300 [01:50<01:02,  1.67it/s]Computing embeddings:  65%|██████▌   | 196/300 [01:51<01:02,  1.67it/s]Computing embeddings:  66%|██████▌   | 197/300 [01:52<01:01,  1.67it/s]Computing embeddings:  66%|██████▌   | 198/300 [01:52<01:01,  1.67it/s]Computing embeddings:  66%|██████▋   | 199/300 [01:53<01:00,  1.67it/s]Computing embeddings:  67%|██████▋   | 200/300 [01:53<01:00,  1.67it/s]Computing embeddings:  67%|██████▋   | 201/300 [01:54<00:59,  1.67it/s]Computing embeddings:  67%|██████▋   | 202/300 [01:55<00:58,  1.66it/s]Computing embeddings:  68%|██████▊   | 203/300 [01:55<00:58,  1.67it/s]Computing embeddings:  68%|██████▊   | 204/300 [01:56<00:57,  1.67it/s]Computing embeddings:  68%|██████▊   | 205/300 [01:56<00:56,  1.67it/s]Computing embeddings:  69%|██████▊   | 206/300 [01:57<00:56,  1.67it/s]Computing embeddings:  69%|██████▉   | 207/300 [01:58<00:55,  1.66it/s]Computing embeddings:  69%|██████▉   | 208/300 [01:58<00:55,  1.66it/s]Computing embeddings:  70%|██████▉   | 209/300 [01:59<00:54,  1.67it/s]Computing embeddings:  70%|███████   | 210/300 [01:59<00:53,  1.67it/s]Computing embeddings:  70%|███████   | 211/300 [02:00<00:52,  1.69it/s]Computing embeddings:  71%|███████   | 212/300 [02:01<00:51,  1.69it/s]Computing embeddings:  71%|███████   | 213/300 [02:01<00:50,  1.71it/s]Computing embeddings:  71%|███████▏  | 214/300 [02:02<00:50,  1.71it/s]Computing embeddings:  72%|███████▏  | 215/300 [02:02<00:49,  1.72it/s]Computing embeddings:  72%|███████▏  | 216/300 [02:03<00:48,  1.72it/s]Computing embeddings:  72%|███████▏  | 217/300 [02:03<00:48,  1.72it/s]Computing embeddings:  73%|███████▎  | 218/300 [02:04<00:48,  1.71it/s]Computing embeddings:  73%|███████▎  | 219/300 [02:05<00:47,  1.70it/s]Computing embeddings:  73%|███████▎  | 220/300 [02:05<00:47,  1.70it/s]Computing embeddings:  74%|███████▎  | 221/300 [02:06<00:46,  1.71it/s]Computing embeddings:  74%|███████▍  | 222/300 [02:06<00:45,  1.70it/s]Computing embeddings:  74%|███████▍  | 223/300 [02:07<00:45,  1.70it/s]Computing embeddings:  75%|███████▍  | 224/300 [02:08<00:44,  1.70it/s]Computing embeddings:  75%|███████▌  | 225/300 [02:08<00:43,  1.71it/s]Computing embeddings:  75%|███████▌  | 226/300 [02:09<00:43,  1.71it/s]Computing embeddings:  76%|███████▌  | 227/300 [02:09<00:42,  1.70it/s]Computing embeddings:  76%|███████▌  | 228/300 [02:10<00:42,  1.69it/s]Computing embeddings:  76%|███████▋  | 229/300 [02:10<00:42,  1.68it/s]Computing embeddings:  77%|███████▋  | 230/300 [02:11<00:41,  1.69it/s]Computing embeddings:  77%|███████▋  | 231/300 [02:12<00:40,  1.70it/s]Computing embeddings:  77%|███████▋  | 232/300 [02:12<00:40,  1.70it/s]Computing embeddings:  78%|███████▊  | 233/300 [02:13<00:39,  1.69it/s]Computing embeddings:  78%|███████▊  | 234/300 [02:13<00:39,  1.68it/s]Computing embeddings:  78%|███████▊  | 235/300 [02:14<00:38,  1.69it/s]Computing embeddings:  79%|███████▊  | 236/300 [02:15<00:37,  1.70it/s]Computing embeddings:  79%|███████▉  | 237/300 [02:15<00:36,  1.70it/s]Computing embeddings:  79%|███████▉  | 238/300 [02:16<00:36,  1.69it/s]Computing embeddings:  80%|███████▉  | 239/300 [02:16<00:35,  1.70it/s]Computing embeddings:  80%|████████  | 240/300 [02:17<00:35,  1.70it/s]Computing embeddings:  80%|████████  | 241/300 [02:18<00:35,  1.68it/s]Computing embeddings:  81%|████████  | 242/300 [02:18<00:34,  1.69it/s]Computing embeddings:  81%|████████  | 243/300 [02:19<00:33,  1.69it/s]Computing embeddings:  81%|████████▏ | 244/300 [02:19<00:33,  1.68it/s]Computing embeddings:  82%|████████▏ | 245/300 [02:20<00:32,  1.68it/s]Computing embeddings:  82%|████████▏ | 246/300 [02:21<00:31,  1.70it/s]Computing embeddings:  82%|████████▏ | 247/300 [02:21<00:31,  1.68it/s]Computing embeddings:  83%|████████▎ | 248/300 [02:22<00:30,  1.69it/s]Computing embeddings:  83%|████████▎ | 249/300 [02:22<00:30,  1.69it/s]Computing embeddings:  83%|████████▎ | 250/300 [02:23<00:29,  1.70it/s]Computing embeddings:  84%|████████▎ | 251/300 [02:23<00:28,  1.70it/s]Computing embeddings:  84%|████████▍ | 252/300 [02:24<00:27,  1.72it/s]Computing embeddings:  84%|████████▍ | 253/300 [02:25<00:27,  1.72it/s]Computing embeddings:  85%|████████▍ | 254/300 [02:25<00:26,  1.72it/s]Computing embeddings:  85%|████████▌ | 255/300 [02:26<00:26,  1.72it/s]Computing embeddings:  85%|████████▌ | 256/300 [02:26<00:25,  1.72it/s]Computing embeddings:  86%|████████▌ | 257/300 [02:27<00:25,  1.71it/s]Computing embeddings:  86%|████████▌ | 258/300 [02:28<00:24,  1.71it/s]Computing embeddings:  86%|████████▋ | 259/300 [02:28<00:24,  1.71it/s]Computing embeddings:  87%|████████▋ | 260/300 [02:29<00:23,  1.71it/s]Computing embeddings:  87%|████████▋ | 261/300 [02:29<00:22,  1.72it/s]Computing embeddings:  87%|████████▋ | 262/300 [02:30<00:22,  1.72it/s]Computing embeddings:  88%|████████▊ | 263/300 [02:30<00:21,  1.70it/s]Computing embeddings:  88%|████████▊ | 264/300 [02:31<00:21,  1.69it/s]Computing embeddings:  88%|████████▊ | 265/300 [02:32<00:20,  1.69it/s]Computing embeddings:  89%|████████▊ | 266/300 [02:32<00:20,  1.69it/s]Computing embeddings:  89%|████████▉ | 267/300 [02:33<00:19,  1.70it/s]Computing embeddings:  89%|████████▉ | 268/300 [02:33<00:18,  1.72it/s]Computing embeddings:  90%|████████▉ | 269/300 [02:34<00:18,  1.71it/s]Computing embeddings:  90%|█████████ | 270/300 [02:35<00:17,  1.71it/s]Computing embeddings:  90%|█████████ | 271/300 [02:35<00:16,  1.71it/s]Computing embeddings:  91%|█████████ | 272/300 [02:36<00:16,  1.69it/s]Computing embeddings:  91%|█████████ | 273/300 [02:36<00:16,  1.68it/s]Computing embeddings:  91%|█████████▏| 274/300 [02:37<00:15,  1.68it/s]Computing embeddings:  92%|█████████▏| 275/300 [02:38<00:14,  1.68it/s]Computing embeddings:  92%|█████████▏| 276/300 [02:38<00:14,  1.69it/s]Computing embeddings:  92%|█████████▏| 277/300 [02:39<00:13,  1.70it/s]Computing embeddings:  93%|█████████▎| 278/300 [02:39<00:13,  1.69it/s]Computing embeddings:  93%|█████████▎| 279/300 [02:40<00:12,  1.68it/s]Computing embeddings:  93%|█████████▎| 280/300 [02:40<00:11,  1.70it/s]Computing embeddings:  94%|█████████▎| 281/300 [02:41<00:11,  1.70it/s]Computing embeddings:  94%|█████████▍| 282/300 [02:42<00:10,  1.71it/s]Computing embeddings:  94%|█████████▍| 283/300 [02:42<00:09,  1.71it/s]Computing embeddings:  95%|█████████▍| 284/300 [02:43<00:09,  1.70it/s]Computing embeddings:  95%|█████████▌| 285/300 [02:43<00:08,  1.71it/s]Computing embeddings:  95%|█████████▌| 286/300 [02:44<00:08,  1.71it/s]Computing embeddings:  96%|█████████▌| 287/300 [02:45<00:07,  1.71it/s]Computing embeddings:  96%|█████████▌| 288/300 [02:45<00:07,  1.71it/s]Computing embeddings:  96%|█████████▋| 289/300 [02:46<00:06,  1.70it/s]Computing embeddings:  97%|█████████▋| 290/300 [02:46<00:05,  1.71it/s]Computing embeddings:  97%|█████████▋| 291/300 [02:47<00:05,  1.70it/s]Computing embeddings:  97%|█████████▋| 292/300 [02:48<00:04,  1.69it/s]Computing embeddings:  98%|█████████▊| 293/300 [02:48<00:04,  1.67it/s]Computing embeddings:  98%|█████████▊| 294/300 [02:49<00:03,  1.68it/s]Computing embeddings:  98%|█████████▊| 295/300 [02:49<00:02,  1.68it/s]Computing embeddings:  99%|█████████▊| 296/300 [02:50<00:02,  1.69it/s]Computing embeddings:  99%|█████████▉| 297/300 [02:50<00:01,  1.69it/s]Computing embeddings:  99%|█████████▉| 298/300 [02:51<00:01,  1.70it/s]Computing embeddings: 100%|█████████▉| 299/300 [02:52<00:00,  1.70it/s]Computing embeddings: 100%|██████████| 300/300 [02:52<00:00,  2.09it/s]Computing embeddings: 100%|██████████| 300/300 [02:52<00:00,  1.74it/s]

Computing embeddings for 40 images from data/histomorfologico/cptac/pam50/label_luma_pred_3...
Computing embeddings:   0%|          | 0/5 [00:00<?, ?it/s]Computing embeddings:  20%|██        | 1/5 [00:00<00:02,  1.75it/s]Computing embeddings:  40%|████      | 2/5 [00:01<00:01,  1.77it/s]Computing embeddings:  60%|██████    | 3/5 [00:01<00:01,  1.77it/s]Computing embeddings:  80%|████████  | 4/5 [00:02<00:00,  1.78it/s]Computing embeddings: 100%|██████████| 5/5 [00:02<00:00,  1.78it/s]Computing embeddings: 100%|██████████| 5/5 [00:02<00:00,  1.77it/s]

Selecting 25 representative images...

Results for label 'luma':
  Selected 25 images
  Distance range: 22.7812 - 24.3125
  Saved to: selected_gt_cptac_pam50_luma.txt
  Saved to: selected_gt_cptac_pam50_luma_with_distances.json

============================================================
Processing label: lumb
Total images: 498
============================================================

Computing embeddings for 272 images from data/histomorfologico/cptac/pam50/label_lumb_pred_2...
Computing embeddings:   0%|          | 0/34 [00:00<?, ?it/s]Computing embeddings:   3%|▎         | 1/34 [00:00<00:18,  1.76it/s]Computing embeddings:   6%|▌         | 2/34 [00:01<00:18,  1.77it/s]Computing embeddings:   9%|▉         | 3/34 [00:01<00:17,  1.75it/s]Computing embeddings:  12%|█▏        | 4/34 [00:02<00:17,  1.76it/s]Computing embeddings:  15%|█▍        | 5/34 [00:02<00:16,  1.76it/s]Computing embeddings:  18%|█▊        | 6/34 [00:03<00:15,  1.75it/s]Computing embeddings:  21%|██        | 7/34 [00:03<00:15,  1.75it/s]Computing embeddings:  24%|██▎       | 8/34 [00:04<00:14,  1.75it/s]Computing embeddings:  26%|██▋       | 9/34 [00:05<00:14,  1.75it/s]Computing embeddings:  29%|██▉       | 10/34 [00:05<00:13,  1.76it/s]Computing embeddings:  32%|███▏      | 11/34 [00:06<00:13,  1.76it/s]Computing embeddings:  35%|███▌      | 12/34 [00:06<00:12,  1.76it/s]Computing embeddings:  38%|███▊      | 13/34 [00:07<00:11,  1.76it/s]Computing embeddings:  41%|████      | 14/34 [00:07<00:11,  1.76it/s]Computing embeddings:  44%|████▍     | 15/34 [00:08<00:10,  1.76it/s]Computing embeddings:  47%|████▋     | 16/34 [00:09<00:10,  1.76it/s]Computing embeddings:  50%|█████     | 17/34 [00:09<00:09,  1.76it/s]Computing embeddings:  53%|█████▎    | 18/34 [00:10<00:09,  1.75it/s]Computing embeddings:  56%|█████▌    | 19/34 [00:10<00:08,  1.75it/s]Computing embeddings:  59%|█████▉    | 20/34 [00:11<00:07,  1.75it/s]Computing embeddings:  62%|██████▏   | 21/34 [00:11<00:07,  1.75it/s]Computing embeddings:  65%|██████▍   | 22/34 [00:12<00:06,  1.75it/s]Computing embeddings:  68%|██████▊   | 23/34 [00:13<00:06,  1.75it/s]Computing embeddings:  71%|███████   | 24/34 [00:13<00:05,  1.76it/s]Computing embeddings:  74%|███████▎  | 25/34 [00:14<00:05,  1.76it/s]Computing embeddings:  76%|███████▋  | 26/34 [00:14<00:04,  1.75it/s]Computing embeddings:  79%|███████▉  | 27/34 [00:15<00:03,  1.75it/s]Computing embeddings:  82%|████████▏ | 28/34 [00:15<00:03,  1.76it/s]Computing embeddings:  85%|████████▌ | 29/34 [00:16<00:02,  1.75it/s]Computing embeddings:  88%|████████▊ | 30/34 [00:17<00:02,  1.76it/s]Computing embeddings:  91%|█████████ | 31/34 [00:17<00:01,  1.76it/s]Computing embeddings:  94%|█████████▍| 32/34 [00:18<00:01,  1.75it/s]Computing embeddings:  97%|█████████▋| 33/34 [00:18<00:00,  1.74it/s]Computing embeddings: 100%|██████████| 34/34 [00:19<00:00,  1.74it/s]Computing embeddings: 100%|██████████| 34/34 [00:19<00:00,  1.75it/s]

Computing embeddings for 226 images from data/histomorfologico/cptac/pam50/label_lumb_pred_3...
Computing embeddings:   0%|          | 0/29 [00:00<?, ?it/s]Computing embeddings:   3%|▎         | 1/29 [00:00<00:16,  1.74it/s]Computing embeddings:   7%|▋         | 2/29 [00:01<00:15,  1.74it/s]Computing embeddings:  10%|█         | 3/29 [00:01<00:14,  1.74it/s]Computing embeddings:  14%|█▍        | 4/29 [00:02<00:14,  1.74it/s]Computing embeddings:  17%|█▋        | 5/29 [00:02<00:13,  1.73it/s]Computing embeddings:  21%|██        | 6/29 [00:03<00:13,  1.73it/s]Computing embeddings:  24%|██▍       | 7/29 [00:04<00:12,  1.73it/s]Computing embeddings:  28%|██▊       | 8/29 [00:04<00:12,  1.72it/s]Computing embeddings:  31%|███       | 9/29 [00:05<00:11,  1.70it/s]Computing embeddings:  34%|███▍      | 10/29 [00:05<00:11,  1.70it/s]Computing embeddings:  38%|███▊      | 11/29 [00:06<00:10,  1.71it/s]Computing embeddings:  41%|████▏     | 12/29 [00:07<00:10,  1.69it/s]Computing embeddings:  45%|████▍     | 13/29 [00:07<00:09,  1.69it/s]Computing embeddings:  48%|████▊     | 14/29 [00:08<00:08,  1.71it/s]Computing embeddings:  52%|█████▏    | 15/29 [00:08<00:08,  1.71it/s]Computing embeddings:  55%|█████▌    | 16/29 [00:09<00:07,  1.70it/s]Computing embeddings:  59%|█████▊    | 17/29 [00:09<00:07,  1.71it/s]Computing embeddings:  62%|██████▏   | 18/29 [00:10<00:06,  1.71it/s]Computing embeddings:  66%|██████▌   | 19/29 [00:11<00:05,  1.71it/s]Computing embeddings:  69%|██████▉   | 20/29 [00:11<00:05,  1.71it/s]Computing embeddings:  72%|███████▏  | 21/29 [00:12<00:04,  1.70it/s]Computing embeddings:  76%|███████▌  | 22/29 [00:12<00:04,  1.69it/s]Computing embeddings:  79%|███████▉  | 23/29 [00:13<00:03,  1.69it/s]Computing embeddings:  83%|████████▎ | 24/29 [00:14<00:02,  1.68it/s]Computing embeddings:  86%|████████▌ | 25/29 [00:14<00:02,  1.69it/s]Computing embeddings:  90%|████████▉ | 26/29 [00:15<00:01,  1.70it/s]Computing embeddings:  93%|█████████▎| 27/29 [00:15<00:01,  1.71it/s]Computing embeddings:  97%|█████████▋| 28/29 [00:16<00:00,  1.69it/s]Computing embeddings: 100%|██████████| 29/29 [00:16<00:00,  2.17it/s]Computing embeddings: 100%|██████████| 29/29 [00:16<00:00,  1.75it/s]

Selecting 25 representative images...

Results for label 'lumb':
  Selected 25 images
  Distance range: 23.8438 - 26.6250
  Saved to: selected_gt_cptac_pam50_lumb.txt
  Saved to: selected_gt_cptac_pam50_lumb_with_distances.json

============================================================
Processing label: normal
Total images: 112
============================================================

Computing embeddings for 8 images from data/histomorfologico/cptac/pam50/label_normal_pred_3...
Computing embeddings:   0%|          | 0/1 [00:00<?, ?it/s]Computing embeddings: 100%|██████████| 1/1 [00:00<00:00,  1.70it/s]Computing embeddings: 100%|██████████| 1/1 [00:00<00:00,  1.69it/s]

Computing embeddings for 8 images from data/histomorfologico/cptac/pam50/label_normal_pred_4...
Computing embeddings:   0%|          | 0/1 [00:00<?, ?it/s]Computing embeddings: 100%|██████████| 1/1 [00:00<00:00,  1.71it/s]Computing embeddings: 100%|██████████| 1/1 [00:00<00:00,  1.71it/s]

Computing embeddings for 72 images from data/histomorfologico/cptac/pam50/label_normal_pred_2...
Computing embeddings:   0%|          | 0/9 [00:00<?, ?it/s]Computing embeddings:  11%|█         | 1/9 [00:00<00:04,  1.77it/s]Computing embeddings:  22%|██▏       | 2/9 [00:01<00:03,  1.77it/s]Computing embeddings:  33%|███▎      | 3/9 [00:01<00:03,  1.76it/s]Computing embeddings:  44%|████▍     | 4/9 [00:02<00:02,  1.75it/s]Computing embeddings:  56%|█████▌    | 5/9 [00:02<00:02,  1.75it/s]Computing embeddings:  67%|██████▋   | 6/9 [00:03<00:01,  1.75it/s]Computing embeddings:  78%|███████▊  | 7/9 [00:03<00:01,  1.75it/s]Computing embeddings:  89%|████████▉ | 8/9 [00:04<00:00,  1.76it/s]Computing embeddings: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s]Computing embeddings: 100%|██████████| 9/9 [00:05<00:00,  1.76it/s]

Computing embeddings for 24 images from data/histomorfologico/cptac/pam50/label_normal_pred_0...
Computing embeddings:   0%|          | 0/3 [00:00<?, ?it/s]Computing embeddings:  33%|███▎      | 1/3 [00:00<00:01,  1.74it/s]Computing embeddings:  67%|██████▋   | 2/3 [00:01<00:00,  1.75it/s]Computing embeddings: 100%|██████████| 3/3 [00:01<00:00,  1.75it/s]Computing embeddings: 100%|██████████| 3/3 [00:01<00:00,  1.75it/s]

Selecting 25 representative images...

Results for label 'normal':
  Selected 25 images
  Distance range: 24.8438 - 29.2969
  Saved to: selected_gt_cptac_pam50_normal.txt
  Saved to: selected_gt_cptac_pam50_normal_with_distances.json

============================================================
Done!
============================================================

===================================
All datasets processed for cptac!
===================================
